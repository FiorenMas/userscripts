// ==UserScript==
// @name               Pixiv Downloader
// @namespace          https://greasyfork.org/zh-CN/scripts/432150
// @version            1.5.0
// @author             ruaruarua
// @description        Pixiv | Danbooru | Rule34 | Yande. 一键下载各页面原图。批量下载画师作品，按作品标签下载。转换动图格式：Gif | Apng | Webp | Webm | MP4。自定义图片文件名，保存路径。保留 / 导出下载历史。
// @license            MIT
// @icon               https://www.pixiv.net/favicon.ico
// @supportURL         https://github.com/drunkg00se/Pixiv-Downloader/issues
// @match              https://www.pixiv.net/*
// @match              https://rule34.xxx/*
// @match              https://danbooru.donmai.us/*
// @match              https://yande.re/*
// @match              https://booru.allthefallen.moe/*
// @require            https://unpkg.com/dexie@3.2.7/dist/dexie.min.js
// @require            https://unpkg.com/jszip@3.9.1/dist/jszip.min.js
// @require            https://unpkg.com/gif.js@0.2.0/dist/gif.js
// @require            https://unpkg.com/dayjs@1.11.11/dayjs.min.js
// @resource           ../wasm/toWebpWorker?raw    https://update.greasyfork.org/scripts/500281/1409041/libwebp_wasm.js
// @resource           gif.js/dist/gif.worker?raw  https://unpkg.com/gif.js@0.2.0/dist/gif.worker.js
// @resource           pako/dist/pako.js?raw       https://unpkg.com/pako@2.1.0/dist/pako.min.js
// @resource           upng-js?raw                 https://unpkg.com/upng-js@2.1.0/UPNG.js
// @connect            i.pximg.net
// @connect            source.pixiv.net
// @connect            rule34.xxx
// @connect            donmai.us
// @connect            yande.re
// @connect            allthefallen.moe
// @grant              GM_download
// @grant              GM_getResourceText
// @grant              GM_info
// @grant              GM_registerMenuCommand
// @grant              GM_xmlhttpRequest
// @grant              unsafeWindow
// @noframes
// @downloadURL https://raw.githubusercontent.com/FiorenMas/Userscripts/release/release/Pixiv20Downloader.user.js
// @updateURL https://raw.githubusercontent.com/FiorenMas/Userscripts/release/release/Pixiv20Downloader.meta.js
// ==/UserScript==
(()=>{const t=new CSSStyleSheet;t.replaceSync(" .anim-indeterminate.svelte-12wvf64{transform-origin:0% 50%;animation:svelte-12wvf64-anim-indeterminate 2s infinite linear}@keyframes svelte-12wvf64-anim-indeterminate{0%{transform:translate(0) scaleX(0)}40%{transform:translate(0) scaleX(.4)}to{transform:translate(100%) scaleX(.5)}}*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: \"\"}:host [data-theme=skeleton],:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\",Segoe UI Symbol,\"Noto Color Emoji\";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}:host [data-theme=skeleton]{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h3{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}dl,dd,h1,h3,hr,figure,p{margin:0}fieldset{margin:0;padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}[type=text],input:where(:not([type])),[type=email],[type=url],[type=password],[type=number],[type=date],[type=datetime-local],[type=month],[type=search],[type=tel],[type=time],[type=week],[multiple],textarea,select{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#fff;border-color:#6b7280;border-width:1px;border-radius:0;padding:8px 12px;font-size:16px;line-height:24px;--tw-shadow: 0 0 #0000}[type=text]:focus,input:where(:not([type])):focus,[type=email]:focus,[type=url]:focus,[type=password]:focus,[type=number]:focus,[type=date]:focus,[type=datetime-local]:focus,[type=month]:focus,[type=search]:focus,[type=tel]:focus,[type=time]:focus,[type=week]:focus,[multiple]:focus,textarea:focus,select:focus{outline:2px solid transparent;outline-offset:2px;--tw-ring-inset: var(--tw-empty, );--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: #2563eb;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow);border-color:#2563eb}input::-moz-placeholder,textarea::-moz-placeholder{color:#6b7280;opacity:1}input::placeholder,textarea::placeholder{color:#6b7280;opacity:1}::-webkit-datetime-edit-fields-wrapper{padding:0}::-webkit-date-and-time-value{min-height:1.5em;text-align:inherit}::-webkit-datetime-edit{display:inline-flex}::-webkit-datetime-edit,::-webkit-datetime-edit-year-field,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute-field,::-webkit-datetime-edit-second-field,::-webkit-datetime-edit-millisecond-field,::-webkit-datetime-edit-meridiem-field{padding-top:0;padding-bottom:0}select{background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e\");background-position:right 8px center;background-repeat:no-repeat;background-size:1.5em 1.5em;padding-right:40px;-webkit-print-color-adjust:exact;print-color-adjust:exact}[multiple],[size]:where(select:not([size=\"1\"])){background-image:initial;background-position:initial;background-repeat:unset;background-size:initial;padding-right:12px;-webkit-print-color-adjust:unset;print-color-adjust:unset}[type=checkbox],[type=radio]{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:0;-webkit-print-color-adjust:exact;print-color-adjust:exact;display:inline-block;vertical-align:middle;background-origin:border-box;-webkit-user-select:none;-moz-user-select:none;user-select:none;flex-shrink:0;height:16px;width:16px;color:#2563eb;background-color:#fff;border-color:#6b7280;border-width:1px;--tw-shadow: 0 0 #0000}[type=checkbox]{border-radius:0}[type=radio]{border-radius:100%}[type=checkbox]:focus,[type=radio]:focus{outline:2px solid transparent;outline-offset:2px;--tw-ring-inset: var(--tw-empty, );--tw-ring-offset-width: 2px;--tw-ring-offset-color: #fff;--tw-ring-color: #2563eb;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}[type=checkbox]:checked,[type=radio]:checked{border-color:transparent;background-color:currentColor;background-size:100% 100%;background-position:center;background-repeat:no-repeat}[type=checkbox]:checked{background-image:url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e\")}@media (forced-colors: active){[type=checkbox]:checked{-webkit-appearance:auto;-moz-appearance:auto;appearance:auto}}[type=radio]:checked{background-image:url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3ccircle cx='8' cy='8' r='3'/%3e%3c/svg%3e\")}@media (forced-colors: active){[type=radio]:checked{-webkit-appearance:auto;-moz-appearance:auto;appearance:auto}}[type=checkbox]:checked:hover,[type=checkbox]:checked:focus,[type=radio]:checked:hover,[type=radio]:checked:focus{border-color:transparent;background-color:currentColor}[type=checkbox]:indeterminate{background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 16 16'%3e%3cpath stroke='white' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M4 8h8'/%3e%3c/svg%3e\");border-color:transparent;background-color:currentColor;background-size:100% 100%;background-position:center;background-repeat:no-repeat}@media (forced-colors: active){[type=checkbox]:indeterminate{-webkit-appearance:auto;-moz-appearance:auto;appearance:auto}}[type=checkbox]:indeterminate:hover,[type=checkbox]:indeterminate:focus{border-color:transparent;background-color:currentColor}[type=file]{background:unset;border-color:inherit;border-width:0;border-radius:0;padding:0;font-size:unset;line-height:inherit}[type=file]:focus{outline:1px solid ButtonText;outline:1px auto -webkit-focus-ring-color}:host [data-theme=skeleton]{background-color:rgb(var(--color-surface-50));font-size:16px;line-height:24px;font-family:var(--theme-font-family-base);color:rgba(var(--theme-font-color-base))}:host .dark [data-theme=skeleton]{background-color:rgb(var(--color-surface-900));color:rgba(var(--theme-font-color-dark))}::-moz-selection{background-color:rgb(var(--color-primary-500) / .3)}::selection{background-color:rgb(var(--color-primary-500) / .3)}:host [data-theme=skeleton]{-webkit-tap-highlight-color:rgba(128,128,128,.5);scrollbar-color:rgba(0,0,0,.2) rgba(255,255,255,.05)}:host [data-theme=skeleton]{scrollbar-color:rgba(128,128,128,.5) rgba(0,0,0,.1);scrollbar-width:thin}:host.dark{scrollbar-color:rgba(255,255,255,.1) rgba(0,0,0,.05)}hr:not(.divider){display:block;border-top-width:1px;border-style:solid;border-color:rgb(var(--color-surface-300))}.dark hr:not(.divider){border-color:rgb(var(--color-surface-600))}fieldset,label{display:block}::-moz-placeholder{color:rgb(var(--color-surface-500))}::placeholder{color:rgb(var(--color-surface-500))}.dark ::-moz-placeholder{color:rgb(var(--color-surface-400))}.dark ::placeholder{color:rgb(var(--color-surface-400))}:is(.dark input::-webkit-calendar-picker-indicator){--tw-invert: invert(100%);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}input[type=search]::-webkit-search-cancel-button{-webkit-appearance:none;background:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cpath d='M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z'/%3E%3C/svg%3E\") no-repeat 50% 50%;pointer-events:none;height:16px;width:16px;border-radius:9999px;background-size:contain;opacity:0}input[type=search]:focus::-webkit-search-cancel-button{pointer-events:auto;opacity:1}:is(.dark input[type=search]::-webkit-search-cancel-button){--tw-invert: invert(100%);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}progress{webkit-appearance:none;-moz-appearance:none;-webkit-appearance:none;appearance:none;height:8px;width:100%;overflow:hidden;border-radius:var(--theme-rounded-base);background-color:rgb(var(--color-surface-400))}.dark progress{background-color:rgb(var(--color-surface-500))}progress::-webkit-progress-bar{background-color:rgb(var(--color-surface-400))}.dark progress::-webkit-progress-bar{background-color:rgb(var(--color-surface-500))}progress::-webkit-progress-value{background-color:rgb(var(--color-surface-900))}.dark progress::-webkit-progress-value{background-color:rgb(var(--color-surface-50))}::-moz-progress-bar{background-color:rgb(var(--color-surface-900))}.dark ::-moz-progress-bar{background-color:rgb(var(--color-surface-50))}:indeterminate::-moz-progress-bar{width:0}input[type=file]:not(.file-dropzone-input)::file-selector-button:disabled{cursor:not-allowed;opacity:.5}input[type=file]:not(.file-dropzone-input)::file-selector-button:disabled:hover{--tw-brightness: brightness(1);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}input[type=file]:not(.file-dropzone-input)::file-selector-button:disabled:active{--tw-scale-x: 1;--tw-scale-y: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}input[type=file]:not(.file-dropzone-input)::file-selector-button{font-size:14px;line-height:20px;padding:6px 12px;white-space:nowrap;text-align:center;display:inline-flex;align-items:center;justify-content:center;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s;border-radius:var(--theme-rounded-base);background-color:rgb(var(--color-surface-900));color:rgb(var(--color-surface-50));margin-right:8px;border-width:0px}input[type=file]:not(.file-dropzone-input)::file-selector-button>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(8px * var(--tw-space-x-reverse));margin-left:calc(8px * calc(1 - var(--tw-space-x-reverse)))}input[type=file]:not(.file-dropzone-input)::file-selector-button:hover{--tw-brightness: brightness(1.15);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}input[type=file]:not(.file-dropzone-input)::file-selector-button:active{--tw-scale-x: 95%;--tw-scale-y: 95%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));--tw-brightness: brightness(.9);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.dark input[type=file]:not(.file-dropzone-input)::file-selector-button{background-color:rgb(var(--color-surface-50));color:rgb(var(--color-surface-900))}[type=range]{width:100%;accent-color:rgb(var(--color-surface-900) / 1)}:is(.dark [type=range]){accent-color:rgb(var(--color-surface-50) / 1)}[data-sort]{cursor:pointer}[data-sort]:hover:hover,.dark [data-sort]:hover:hover{background-color:rgb(var(--color-primary-500) / .1)}[data-sort]:after{margin-left:8px!important;opacity:0;--tw-content: \"↓\" !important;content:var(--tw-content)!important}[data-popup]{position:absolute;top:0;left:0;display:none;transition-property:opacity;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}:host [data-theme=skeleton]{--theme-font-family-base: system-ui;--theme-font-family-heading: system-ui;--theme-font-color-base: 0 0 0;--theme-font-color-dark: 255 255 255;--theme-rounded-base: 9999px;--theme-rounded-container: 8px;--theme-border-base: 1px;--on-primary: 0 0 0;--on-secondary: 255 255 255;--on-tertiary: 0 0 0;--on-success: 0 0 0;--on-warning: 0 0 0;--on-error: 255 255 255;--on-surface: 255 255 255;--color-primary-50: 219 245 236;--color-primary-100: 207 241 230;--color-primary-200: 195 238 224;--color-primary-300: 159 227 205;--color-primary-400: 87 207 167;--color-primary-500: 15 186 129;--color-primary-600: 14 167 116;--color-primary-700: 11 140 97;--color-primary-800: 9 112 77;--color-primary-900: 7 91 63;--color-secondary-50: 229 227 251;--color-secondary-100: 220 218 250;--color-secondary-200: 211 209 249;--color-secondary-300: 185 181 245;--color-secondary-400: 132 126 237;--color-secondary-500: 79 70 229;--color-secondary-600: 71 63 206;--color-secondary-700: 59 53 172;--color-secondary-800: 47 42 137;--color-secondary-900: 39 34 112;--color-tertiary-50: 219 242 252;--color-tertiary-100: 207 237 251;--color-tertiary-200: 195 233 250;--color-tertiary-300: 159 219 246;--color-tertiary-400: 86 192 240;--color-tertiary-500: 14 165 233;--color-tertiary-600: 13 149 210;--color-tertiary-700: 11 124 175;--color-tertiary-800: 8 99 140;--color-tertiary-900: 7 81 114;--color-success-50: 237 247 220;--color-success-100: 230 245 208;--color-success-200: 224 242 197;--color-success-300: 206 235 162;--color-success-400: 169 219 92;--color-success-500: 132 204 22;--color-success-600: 119 184 20;--color-success-700: 99 153 17;--color-success-800: 79 122 13;--color-success-900: 65 100 11;--color-warning-50: 252 244 218;--color-warning-100: 251 240 206;--color-warning-200: 250 236 193;--color-warning-300: 247 225 156;--color-warning-400: 240 202 82;--color-warning-500: 234 179 8;--color-warning-600: 211 161 7;--color-warning-700: 176 134 6;--color-warning-800: 140 107 5;--color-warning-900: 115 88 4;--color-error-50: 249 221 234;--color-error-100: 246 209 228;--color-error-200: 244 198 221;--color-error-300: 238 163 200;--color-error-400: 225 94 159;--color-error-500: 212 25 118;--color-error-600: 191 23 106;--color-error-700: 159 19 89;--color-error-800: 127 15 71;--color-error-900: 104 12 58;--color-surface-50: 228 230 238;--color-surface-100: 219 222 233;--color-surface-200: 210 214 227;--color-surface-300: 182 189 210;--color-surface-400: 128 140 177;--color-surface-500: 73 90 143;--color-surface-600: 66 81 129;--color-surface-700: 55 68 107;--color-surface-800: 44 54 86;--color-surface-900: 36 44 70}[data-theme=skeleton] h1,[data-theme=skeleton] h3{font-weight:700}[data-theme=skeleton]{background-image:radial-gradient(at 0% 0%,rgba(var(--color-secondary-500) / .33) 0px,transparent 50%),radial-gradient(at 98% 1%,rgba(var(--color-error-500) / .33) 0px,transparent 50%);background-attachment:fixed;background-position:center;background-repeat:no-repeat;background-size:cover}*{scrollbar-color:initial;scrollbar-width:initial}*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.\\!container{width:100%!important}.container{width:100%}@media (min-width: 640px){.\\!container{max-width:640px!important}.container{max-width:640px}}@media (min-width: 768px){.\\!container{max-width:768px!important}.container{max-width:768px}}@media (min-width: 1024px){.\\!container{max-width:1024px!important}.container{max-width:1024px}}@media (min-width: 1280px){.\\!container{max-width:1280px!important}.container{max-width:1280px}}@media (min-width: 1536px){.\\!container{max-width:1536px!important}.container{max-width:1536px}}.hide-scrollbar::-webkit-scrollbar{display:none}.hide-scrollbar{-ms-overflow-style:none;scrollbar-width:none}.h3{font-size:20px;line-height:28px;font-family:var(--theme-font-family-heading)}.anchor{--tw-text-opacity: 1;color:rgb(var(--color-primary-700) / var(--tw-text-opacity));text-decoration-line:underline}.anchor:hover{--tw-brightness: brightness(1.1);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}:is(.dark .anchor){--tw-text-opacity: 1;color:rgb(var(--color-primary-500) / var(--tw-text-opacity))}.time{font-size:14px;line-height:20px;--tw-text-opacity: 1;color:rgb(var(--color-surface-500) / var(--tw-text-opacity))}:is(.dark .time){--tw-text-opacity: 1;color:rgb(var(--color-surface-400) / var(--tw-text-opacity))}.code{white-space:nowrap;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:12px;line-height:16px;--tw-text-opacity: 1;color:rgb(var(--color-primary-700) / var(--tw-text-opacity));background-color:rgb(var(--color-primary-500) / .3);border-radius:4px;padding:2px 4px}:is(.dark .code){--tw-text-opacity: 1;color:rgb(var(--color-primary-400) / var(--tw-text-opacity));background-color:rgb(var(--color-primary-500) / .2)}.del{position:relative;display:block;padding:2px 2px 2px 20px;text-decoration:none}.del:before{position:absolute;left:4px;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.del:before{content:\"−\"}.del{--tw-bg-opacity: 1;background-color:rgb(var(--color-error-500) / var(--tw-bg-opacity));font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;color:rgb(var(--on-error))}.alert{display:flex;flex-direction:column;align-items:flex-start;padding:16px;color:rgb(var(--color-surface-900));border-radius:var(--theme-rounded-container)}.alert>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(16px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(16px * var(--tw-space-y-reverse))}.dark .alert{color:rgb(var(--color-surface-50))}.\\!btn:disabled{cursor:not-allowed!important;opacity:.5!important}.btn:disabled,.btn-icon:disabled,.btn-group>*:disabled{cursor:not-allowed!important;opacity:.5!important}.\\!btn:disabled:hover{--tw-brightness: brightness(1) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.btn:disabled:hover,.btn-icon:disabled:hover,.btn-group>*:disabled:hover{--tw-brightness: brightness(1);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.\\!btn:disabled:active{--tw-scale-x: 1 !important;--tw-scale-y: 1 !important;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))!important}.btn:disabled:active,.btn-icon:disabled:active,.btn-group>*:disabled:active{--tw-scale-x: 1;--tw-scale-y: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.\\!btn{font-size:16px!important;line-height:24px!important;padding:9px 20px!important;white-space:nowrap!important;text-align:center!important;display:inline-flex!important;align-items:center!important;justify-content:center!important;transition-property:all!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important;transition-duration:.15s!important;border-radius:var(--theme-rounded-base)!important}.btn{font-size:16px;line-height:24px;padding:9px 20px;white-space:nowrap;text-align:center;display:inline-flex;align-items:center;justify-content:center;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s;border-radius:var(--theme-rounded-base)}.\\!btn>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0 !important;margin-right:calc(8px * var(--tw-space-x-reverse))!important;margin-left:calc(8px * calc(1 - var(--tw-space-x-reverse)))!important}.btn>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(8px * var(--tw-space-x-reverse));margin-left:calc(8px * calc(1 - var(--tw-space-x-reverse)))}.\\!btn:hover{--tw-brightness: brightness(1.15) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.btn:hover{--tw-brightness: brightness(1.15);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.\\!btn:active{--tw-scale-x: 95% !important;--tw-scale-y: 95% !important;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))!important;--tw-brightness: brightness(.9) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.btn:active{--tw-scale-x: 95%;--tw-scale-y: 95%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));--tw-brightness: brightness(.9);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.btn-sm{padding:6px 12px;font-size:14px;line-height:20px}.btn-icon{font-size:16px;line-height:24px;white-space:nowrap;text-align:center;display:inline-flex;align-items:center;justify-content:center;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s;padding:0;aspect-ratio:1 / 1;width:43px;border-radius:9999px}.btn-icon>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(8px * var(--tw-space-x-reverse));margin-left:calc(8px * calc(1 - var(--tw-space-x-reverse)))}.btn-icon:hover{--tw-brightness: brightness(1.15);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.btn-icon:active{--tw-scale-x: 95%;--tw-scale-y: 95%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));--tw-brightness: brightness(.9);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.btn-icon-sm{aspect-ratio:1 / 1;width:33px;font-size:14px;line-height:20px}.btn-group{display:inline-flex;flex-direction:row;overflow:hidden;border-radius:var(--theme-rounded-base);isolation:isolate}.btn-group>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(0px * var(--tw-space-x-reverse));margin-left:calc(0px * calc(1 - var(--tw-space-x-reverse)))}.btn-group button,.btn-group a{font-size:16px;line-height:24px;padding:9px 20px;white-space:nowrap;text-align:center;display:inline-flex;align-items:center;justify-content:center;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s;color:inherit!important;text-decoration-line:none!important}.btn-group button>:not([hidden])~:not([hidden]),.btn-group a>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(8px * var(--tw-space-x-reverse));margin-left:calc(8px * calc(1 - var(--tw-space-x-reverse)))}.btn-group button:hover,.btn-group a:hover{--tw-brightness: brightness(1.15);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);background-color:rgb(var(--color-surface-50) / 3%)}.btn-group button:active,.btn-group a:active{background-color:rgb(var(--color-surface-900) / 3%)}.btn-group>*+*{border-top-width:0px;border-left-width:1px;border-color:rgb(var(--color-surface-500) / .2)}.card{background-color:rgb(var(--color-surface-100));--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-inset: inset;--tw-ring-color: rgb(23 23 23 / .05);border-radius:var(--theme-rounded-container)}.dark .card{background-color:rgb(var(--color-surface-800));--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-inset: inset;--tw-ring-color: rgb(250 250 250 / .05)}a.card{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}a.card:hover{--tw-brightness: brightness(1.05);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.\\!chip{cursor:pointer!important;white-space:nowrap!important;padding:6px 12px!important;text-align:center!important;font-size:12px!important;line-height:16px!important;border-radius:4px!important;display:inline-flex!important;align-items:center!important;justify-content:center!important;transition-property:all!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important;transition-duration:.15s!important}.chip{cursor:pointer;white-space:nowrap;padding:6px 12px;text-align:center;font-size:12px;line-height:16px;border-radius:4px;display:inline-flex;align-items:center;justify-content:center;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.\\!chip>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0 !important;margin-right:calc(8px * var(--tw-space-x-reverse))!important;margin-left:calc(8px * calc(1 - var(--tw-space-x-reverse)))!important}.chip>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(8px * var(--tw-space-x-reverse));margin-left:calc(8px * calc(1 - var(--tw-space-x-reverse)))}a.chip:hover,button.chip:hover{--tw-brightness: brightness(1.15);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}a.\\!chip:hover,button.\\!chip:hover{--tw-brightness: brightness(1.15) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.\\!chip:disabled{cursor:not-allowed!important;opacity:.5!important}.chip:disabled{cursor:not-allowed!important;opacity:.5!important}.\\!chip:disabled:active{--tw-scale-x: 1 !important;--tw-scale-y: 1 !important;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))!important}.chip:disabled:active{--tw-scale-x: 1;--tw-scale-y: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.label>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(4px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(4px * var(--tw-space-y-reverse))}.\\!input{width:100%!important;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter!important;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter!important;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important;transition-duration:.2s!important;background-color:rgb(var(--color-surface-200))!important;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important;border-width:var(--theme-border-base)!important;border-color:rgb(var(--color-surface-400))!important}.input,.textarea,.select,.input-group{width:100%;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.2s;background-color:rgb(var(--color-surface-200));--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important;border-width:var(--theme-border-base);border-color:rgb(var(--color-surface-400))}.dark .input,.dark .textarea,.dark .select,.dark .input-group{background-color:rgb(var(--color-surface-700));border-color:rgb(var(--color-surface-500))}.dark .\\!input{background-color:rgb(var(--color-surface-700))!important;border-color:rgb(var(--color-surface-500))!important}.\\!input:hover{--tw-brightness: brightness(1.05) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.input:hover,.textarea:hover,.select:hover,.input-group:hover{--tw-brightness: brightness(1.05);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.\\!input:focus{--tw-brightness: brightness(1.05) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.input:focus,.textarea:focus,.select:focus,.input-group:focus{--tw-brightness: brightness(1.05);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.\\!input:focus-within{--tw-border-opacity: 1 !important;border-color:rgb(var(--color-primary-500) / var(--tw-border-opacity))!important}.input:focus-within,.textarea:focus-within,.select:focus-within,.input-group:focus-within{--tw-border-opacity: 1;border-color:rgb(var(--color-primary-500) / var(--tw-border-opacity))}.\\!input{border-radius:var(--theme-rounded-base)!important}.input,.input-group{border-radius:var(--theme-rounded-base)}.textarea,.select{border-radius:var(--theme-rounded-container)}.select>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(4px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(4px * var(--tw-space-y-reverse))}.select{padding:8px 32px 8px 8px}.select[size]{background-image:none}.select optgroup>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(4px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(4px * var(--tw-space-y-reverse))}.select optgroup{font-weight:700}.select optgroup option{margin-left:0;padding-left:0}.select optgroup option:first-of-type{margin-top:12px}.select optgroup option:last-child{margin-bottom:12px!important}.select option{cursor:pointer;padding:8px 16px;background-color:rgb(var(--color-surface-200));border-radius:var(--theme-rounded-base)}.dark .select option{background-color:rgb(var(--color-surface-700))}.select option:checked{background:rgb(var(--color-primary-500)) linear-gradient(0deg,rgb(var(--color-primary-500)),rgb(var(--color-primary-500)));color:rgb(var(--on-primary))}.checkbox,.radio{height:20px;width:20px;cursor:pointer;border-radius:4px;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important;background-color:rgb(var(--color-surface-200));border-width:var(--theme-border-base);border-color:rgb(var(--color-surface-400))}.dark .checkbox,.dark .radio{background-color:rgb(var(--color-surface-700));border-color:rgb(var(--color-surface-500))}.checkbox:hover,.radio:hover{--tw-brightness: brightness(1.05);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.checkbox:focus,.radio:focus{--tw-brightness: brightness(1.05);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);--tw-border-opacity: 1;border-color:rgb(var(--color-primary-500) / var(--tw-border-opacity))}.checkbox:checked,.checkbox:indeterminate,.radio:checked{--tw-bg-opacity: 1;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity))}.checkbox:checked:hover,.checkbox:indeterminate:hover,.radio:checked:hover{--tw-bg-opacity: 1;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity))}.checkbox:checked:focus,.checkbox:indeterminate:focus,.radio:checked:focus{--tw-bg-opacity: 1;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity));--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.radio{border-radius:var(--theme-rounded-base)}.\\!input[type=file]{padding:4px!important}.input[type=file]{padding:4px}.\\!input[type=color]{height:40px!important;width:40px!important;cursor:pointer!important;overflow:hidden!important;border-style:none!important;border-radius:var(--theme-rounded-base)!important;-webkit-appearance:none!important}.input[type=color]{height:40px;width:40px;cursor:pointer;overflow:hidden;border-style:none;border-radius:var(--theme-rounded-base);-webkit-appearance:none}.\\!input[type=color]::-webkit-color-swatch-wrapper{padding:0!important}.input[type=color]::-webkit-color-swatch-wrapper{padding:0}.\\!input[type=color]::-webkit-color-swatch{border-style:none!important}.input[type=color]::-webkit-color-swatch{border-style:none}.\\!input[type=color]::-webkit-color-swatch:hover{--tw-brightness: brightness(1.1) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.input[type=color]::-webkit-color-swatch:hover{--tw-brightness: brightness(1.1);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.\\!input[type=color]::-moz-color-swatch{border-style:none!important}.input[type=color]::-moz-color-swatch{border-style:none}.\\!input:disabled{cursor:not-allowed!important;opacity:.5!important}.input:disabled,.textarea:disabled,.select:disabled,.input-group>input:disabled,.input-group>textarea:disabled,.input-group>select:disabled{cursor:not-allowed!important;opacity:.5!important}.\\!input:disabled:hover{--tw-brightness: brightness(1) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.input:disabled:hover,.textarea:disabled:hover,.select:disabled:hover,.input-group>input:disabled:hover,.input-group>textarea:disabled:hover,.input-group>select:disabled:hover{--tw-brightness: brightness(1) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.\\!input[readonly],.input[readonly],.textarea[readonly],.select[readonly]{cursor:not-allowed!important;border-color:transparent!important}.\\!input[readonly]:hover,.input[readonly]:hover,.textarea[readonly]:hover,.select[readonly]:hover{--tw-brightness: brightness(1) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.input-group{display:grid;overflow:hidden}.input-group input,.input-group select{border-width:0px;background-color:transparent;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important}.input-group select option{background-color:rgb(var(--color-surface-200))}.dark .input-group select option{background-color:rgb(var(--color-surface-700))}.input-group div,.input-group a,.input-group button{display:flex;align-items:center;justify-content:space-between;padding-left:16px;padding-right:16px}.input-group-divider input,.input-group-divider select,.input-group-divider div,.input-group-divider a{border-left-width:1px;border-color:rgb(var(--color-surface-400));--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important;min-width:-moz-fit-content!important;min-width:fit-content!important}.dark .input-group-divider input,.dark .input-group-divider select,.dark .input-group-divider div,.dark .input-group-divider a{border-color:rgb(var(--color-surface-500))}.input-group-divider input:focus,.input-group-divider select:focus,.input-group-divider div:focus,.input-group-divider a:focus{border-color:rgb(var(--color-surface-400))}.dark .input-group-divider input:focus,.dark .input-group-divider select:focus,.dark .input-group-divider div:focus,.dark .input-group-divider a:focus{border-color:rgb(var(--color-surface-500))}.input-group-divider *:first-child{border-left-width:0px!important}.input-group-shim{background-color:rgb(var(--color-surface-400) / .1);color:rgb(var(--color-surface-600))}.dark .input-group-shim{color:rgb(var(--color-surface-300))}.input-error{--tw-border-opacity: 1;border-color:rgb(var(--color-error-500) / var(--tw-border-opacity));--tw-bg-opacity: 1;background-color:rgb(var(--color-error-200) / var(--tw-bg-opacity));--tw-text-opacity: 1;color:rgb(var(--color-error-500) / var(--tw-text-opacity))}:is(.dark .input-error){--tw-border-opacity: 1;border-color:rgb(var(--color-error-500) / var(--tw-border-opacity));--tw-bg-opacity: 1;background-color:rgb(var(--color-error-200) / var(--tw-bg-opacity));--tw-text-opacity: 1;color:rgb(var(--color-error-500) / var(--tw-text-opacity))}.input-error::-moz-placeholder{--tw-text-opacity: 1;color:rgb(var(--color-error-500) / var(--tw-text-opacity))}.input-error::placeholder{--tw-text-opacity: 1;color:rgb(var(--color-error-500) / var(--tw-text-opacity))}.list{list-style-type:none}.list>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(4px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(4px * var(--tw-space-y-reverse))}.list li{display:flex;align-items:center;border-radius:var(--theme-rounded-base)}.list li>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(16px * var(--tw-space-x-reverse));margin-left:calc(16px * calc(1 - var(--tw-space-x-reverse)))}.placeholder{height:20px;background-color:rgb(var(--color-surface-300));border-radius:var(--theme-rounded-base)}.dark .placeholder{background-color:rgb(var(--color-surface-600))}.w-modal{width:100%;max-width:640px}.modal *:focus:not([tabindex=\"-1\"]):not(.input):not(.textarea):not(.select):not(.input-group):not(.input-group input){outline-style:auto;outline-color:-webkit-focus-ring-color}.variant-filled{background-color:rgb(var(--color-surface-900));color:rgb(var(--color-surface-50))}.dark .variant-filled{background-color:rgb(var(--color-surface-50));color:rgb(var(--color-surface-900))}.\\!variant-filled-primary{--tw-bg-opacity: 1 !important;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity))!important;color:rgb(var(--on-primary))!important}.variant-filled-primary{--tw-bg-opacity: 1;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity));color:rgb(var(--on-primary))}:is(.dark .variant-filled-primary){--tw-bg-opacity: 1;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity));color:rgb(var(--on-primary))}:is(.dark .\\!variant-filled-primary){--tw-bg-opacity: 1 !important;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity))!important;color:rgb(var(--on-primary))!important}.variant-ghost-surface{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-inset: inset;--tw-ring-opacity: 1;--tw-ring-color: rgb(var(--color-surface-500) / var(--tw-ring-opacity));background-color:rgb(var(--color-surface-500) / .2)}:is(.dark .variant-ghost-surface){--tw-ring-opacity: 1;--tw-ring-color: rgb(var(--color-surface-500) / var(--tw-ring-opacity));background-color:rgb(var(--color-surface-500) / .2)}.variant-soft,.variant-soft-surface{background-color:rgb(var(--color-surface-400) / .2);--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important;color:rgb(var(--color-surface-700))}.dark .variant-soft,.dark .variant-soft-surface{color:rgb(var(--color-surface-200))}:is(.dark .variant-soft),:is(.dark .variant-soft-surface){background-color:rgb(var(--color-surface-500) / .2)}@media (min-width: 768px){.h3{font-size:24px;line-height:32px}}@media (min-width: 1024px){.alert{flex-direction:row;align-items:center}.alert>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(0px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0px * var(--tw-space-y-reverse));--tw-space-x-reverse: 0;margin-right:calc(16px * var(--tw-space-x-reverse));margin-left:calc(16px * calc(1 - var(--tw-space-x-reverse)))}}.modal *:focus:not([tabindex=\"-1\"]):not(.input):not(.textarea):not(.select):not(.input-group):not(.input-group input){outline-width:0px!important}.visible{visibility:visible}.static{position:static}.fixed{position:fixed}.\\!absolute{position:absolute!important}.absolute{position:absolute}.relative{position:relative}.bottom-0{bottom:0}.bottom-24{bottom:96px}.left-0{left:0}.left-1\\/2{left:50%}.right-0{right:0}.right-2{right:8px}.right-20{right:80px}.right-4{right:16px}.top-0{top:0}.top-1\\/2{top:50%}.top-2{top:8px}.top-36{top:144px}.-z-10{z-index:-10}.z-\\[999\\]{z-index:999}.row-span-2{grid-row:span 2 / span 2}.row-start-1{grid-row-start:1}.\\!m-0{margin:0!important}.m-auto{margin:auto}.mx-2{margin-left:8px;margin-right:8px}.my-4{margin-top:16px;margin-bottom:16px}.my-\\[1px\\]{margin-top:1px;margin-bottom:1px}.ml-1{margin-left:4px}.ml-3{margin-left:12px}.ml-4{margin-left:16px}.mr-2{margin-right:8px}.mr-6{margin-right:24px}.mt-2{margin-top:8px}.mt-4{margin-top:16px}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.inline-flex{display:inline-flex}.grid{display:grid}.contents{display:contents}.hidden{display:none}.size-14{width:56px;height:56px}.size-full{width:100%;height:100%}.h-0{height:0px}.h-10{height:40px}.h-2{height:8px}.h-4{height:16px}.h-48{height:192px}.h-6{height:24px}.h-8{height:32px}.h-\\[38px\\]{height:38px}.h-auto{height:auto}.h-fit{height:-moz-fit-content;height:fit-content}.h-full{height:100%}.h-screen{height:100vh}.max-h-\\[200px\\]{max-height:200px}.min-h-0{min-height:0px}.min-h-full{min-height:100%}.w-0{width:0px}.w-12{width:48px}.w-16{width:64px}.w-20{width:80px}.w-32{width:128px}.w-36{width:144px}.w-48{width:192px}.w-5{width:20px}.w-6{width:24px}.w-8{width:32px}.w-\\[140px\\]{width:140px}.w-\\[38px\\]{width:38px}.w-\\[50\\%\\]{width:50%}.w-\\[600px\\]{width:600px}.w-full{width:100%}.w-screen{width:100vw}.max-w-full{max-width:100%}.flex-1{flex:1 1 0%}.flex-auto{flex:1 1 auto}.flex-none{flex:none}.shrink-0{flex-shrink:0}.flex-grow{flex-grow:1}.basis-0{flex-basis:0px}.origin-\\[50\\%_50\\%\\]{transform-origin:50% 50%}.-translate-x-1\\/2{--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-x-full{--tw-translate-x: -100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-1\\/2{--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-0{--tw-translate-x: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-\\[calc\\(100\\%-44px\\)\\]{--tw-translate-x: calc(100% - 44px) ;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-full{--tw-translate-x: 100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-rotate-90{--tw-rotate: -90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-\\[0\\.8\\]{--tw-scale-x: .8;--tw-scale-y: .8;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.\\!transform-none{transform:none!important}@keyframes spin{to{transform:rotate(360deg)}}.animate-spin{animation:spin 1s linear infinite}.\\!cursor-default{cursor:default!important}.cursor-not-allowed{cursor:not-allowed}.cursor-pointer{cursor:pointer}.select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.list-inside{list-style-position:inside}.list-disc{list-style-type:disc}.grid-cols-\\[0px_1fr\\]{grid-template-columns:0px 1fr}.grid-cols-\\[140px_1fr\\]{grid-template-columns:140px 1fr}.grid-cols-\\[auto_1fr_auto\\]{grid-template-columns:auto 1fr auto}.grid-cols-\\[auto_1fr_auto_auto\\]{grid-template-columns:auto 1fr auto auto}.grid-rows-\\[0fr\\]{grid-template-rows:0fr}.grid-rows-\\[1fr\\]{grid-template-rows:1fr}.grid-rows-\\[auto_1fr\\]{grid-template-rows:auto 1fr}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.\\!items-start{align-items:flex-start!important}.items-center{align-items:center}.\\!items-stretch{align-items:stretch!important}.justify-start{justify-content:flex-start}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.justify-evenly{justify-content:space-evenly}.gap-1{gap:4px}.gap-14{gap:56px}.gap-2{gap:8px}.gap-3{gap:12px}.gap-4{gap:16px}.gap-6{gap:24px}.space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(8px * var(--tw-space-x-reverse));margin-left:calc(8px * calc(1 - var(--tw-space-x-reverse)))}.space-x-4>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(16px * var(--tw-space-x-reverse));margin-left:calc(16px * calc(1 - var(--tw-space-x-reverse)))}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(4px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(4px * var(--tw-space-y-reverse))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(8px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(8px * var(--tw-space-y-reverse))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(16px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(16px * var(--tw-space-y-reverse))}.divide-y-\\[1px\\]>:not([hidden])~:not([hidden]){--tw-divide-y-reverse: 0;border-top-width:calc(1px * calc(1 - var(--tw-divide-y-reverse)));border-bottom-width:calc(1px * var(--tw-divide-y-reverse))}.self-start{align-self:flex-start}.self-stretch{align-self:stretch}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.overflow-y-hidden{overflow-y:hidden}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.break-words{overflow-wrap:break-word}.rounded{border-radius:4px}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:8px}.rounded-md{border-radius:6px}.rounded-none{border-radius:0}.rounded-e-\\[4px\\]{border-start-end-radius:4px;border-end-end-radius:4px}.rounded-s-full{border-start-start-radius:9999px;border-end-start-radius:9999px}.border{border-width:1px}.border-0{border-width:0px}.\\!border-t-0{border-top-width:0px!important}.border-b{border-bottom-width:1px}.border-b-2{border-bottom-width:2px}.border-l{border-left-width:1px}.\\!border-surface-700{--tw-border-opacity: 1 !important;border-color:rgb(var(--color-surface-700) / var(--tw-border-opacity))!important}.border-surface-400\\/20{border-color:rgb(var(--color-surface-400) / .2)}.bg-primary-500{--tw-bg-opacity: 1;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity))}.bg-primary-500\\/30{background-color:rgb(var(--color-primary-500) / .3)}.bg-surface-400{--tw-bg-opacity: 1;background-color:rgb(var(--color-surface-400) / var(--tw-bg-opacity))}.bg-surface-400\\/20{background-color:rgb(var(--color-surface-400) / .2)}.bg-surface-900{--tw-bg-opacity: 1;background-color:rgb(var(--color-surface-900) / var(--tw-bg-opacity))}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity))}.bg-white\\/30{background-color:#ffffff4d}.bg-white\\/75{background-color:#ffffffbf}.bg-scroll{background-attachment:scroll}.fill-current{fill:currentColor}.fill-primary-500{fill:rgb(var(--color-primary-500) / 1)}.fill-slate-700{fill:#334155}.fill-transparent{fill:transparent}.stroke-primary-500{stroke:rgb(var(--color-primary-500) / 1)}.stroke-primary-500\\/30{stroke:rgb(var(--color-primary-500) / .3)}.stroke-surface-500\\/30{stroke:rgb(var(--color-surface-500) / .3)}.stroke-surface-900{stroke:rgb(var(--color-surface-900) / 1)}.object-cover{-o-object-fit:cover;object-fit:cover}.object-center{-o-object-position:center;object-position:center}.\\!p-0{padding:0!important}.p-0{padding:0}.p-1{padding:4px}.p-2{padding:8px}.p-4{padding:16px}.\\!px-1{padding-left:4px!important;padding-right:4px!important}.\\!py-2{padding-top:8px!important;padding-bottom:8px!important}.\\!py-\\[7px\\]{padding-top:7px!important;padding-bottom:7px!important}.px-3{padding-left:12px;padding-right:12px}.px-4{padding-left:16px;padding-right:16px}.px-8{padding-left:32px;padding-right:32px}.py-1{padding-top:4px;padding-bottom:4px}.py-2{padding-top:8px;padding-bottom:8px}.py-6{padding-top:24px;padding-bottom:24px}.pb-6{padding-bottom:24px}.pl-6{padding-left:24px}.pr-0{padding-right:0}.pr-2{padding-right:8px}.pr-4{padding-right:16px}.pr-6{padding-right:24px}.pt-4{padding-top:16px}.text-center{text-align:center}.text-2xl{font-size:24px;line-height:32px}.text-\\[12px\\]{font-size:12px}.text-base{font-size:16px;line-height:24px}.text-sm{font-size:14px;line-height:20px}.text-xs{font-size:12px;line-height:16px}.font-bold{font-weight:700}.italic{font-style:italic}.leading-\\[14px\\]{line-height:14px}.leading-loose{line-height:2}.\\!text-error-500{--tw-text-opacity: 1 !important;color:rgb(var(--color-error-500) / var(--tw-text-opacity))!important}.text-error-500{--tw-text-opacity: 1;color:rgb(var(--color-error-500) / var(--tw-text-opacity))}.text-surface-400{--tw-text-opacity: 1;color:rgb(var(--color-surface-400) / var(--tw-text-opacity))}.underline-offset-2{text-underline-offset:2px}.accent-surface-900{accent-color:rgb(var(--color-surface-900) / 1)}.opacity-40{opacity:.4}.opacity-50{opacity:.5}.opacity-70{opacity:.7}.mix-blend-hard-light{mix-blend-mode:hard-light}.shadow{--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow: 0 20px 25px -5px rgb(0 0 0 / .1), 0 8px 10px -6px rgb(0 0 0 / .1);--tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.-outline-offset-\\[3px\\]{outline-offset:-3px}.\\!ring-0{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important}.blur{--tw-blur: blur(8px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.blur-\\[1px\\]{--tw-blur: blur(1px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-xl{--tw-drop-shadow: drop-shadow(0 20px 13px rgb(0 0 0 / .03)) drop-shadow(0 8px 5px rgb(0 0 0 / .08));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur-sm{--tw-backdrop-blur: blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[grid-template-columns\\]{transition-property:grid-template-columns;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[grid-template-rows\\]{transition-property:grid-template-rows;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[stroke-dashoffset\\]{transition-property:stroke-dashoffset;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[transform\\]{transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[width\\]{transition-property:width;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-opacity{transition-property:opacity;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.delay-100{transition-delay:.1s}.duration-100{transition-duration:.1s}.duration-\\[200ms\\]{transition-duration:.2s}.duration-\\[250ms\\]{transition-duration:.25s}.duration-\\[400ms\\]{transition-duration:.4s}.bg-surface-backdrop-token{background-color:rgb(var(--color-surface-400) / .7)}.dark .bg-surface-backdrop-token{background-color:rgb(var(--color-surface-900) / .7)}.bg-surface-100-800-token{background-color:rgb(var(--color-surface-100))}.dark .bg-surface-100-800-token{background-color:rgb(var(--color-surface-800))}.bg-surface-200-700-token{background-color:rgb(var(--color-surface-200))}.dark .bg-surface-200-700-token{background-color:rgb(var(--color-surface-700))}.bg-surface-900-50-token{background-color:rgb(var(--color-surface-900))}.dark .bg-surface-900-50-token{background-color:rgb(var(--color-surface-50))}.border-token{border-width:var(--theme-border-base)}.border-surface-400-500-token{border-color:rgb(var(--color-surface-400))}.dark .border-surface-400-500-token{border-color:rgb(var(--color-surface-500))}.border-surface-900-50-token{border-color:rgb(var(--color-surface-900))}.dark .border-surface-900-50-token{border-color:rgb(var(--color-surface-50))}.border-surface-800-100-token{border-color:rgb(var(--color-surface-800))}.dark .border-surface-800-100-token{border-color:rgb(var(--color-surface-100))}.rounded-token{border-radius:var(--theme-rounded-base)}.rounded-container-token{border-radius:var(--theme-rounded-container)}.rounded-tl-container-token{border-top-left-radius:var(--theme-rounded-container)}.rounded-tr-container-token{border-top-right-radius:var(--theme-rounded-container)}.fill-token{fill:rgba(var(--theme-font-color-base))}.dark .fill-token{fill:rgba(var(--theme-font-color-dark))}.text-surface-700-200-token{color:rgb(var(--color-surface-700))}.dark .text-surface-700-200-token{color:rgb(var(--color-surface-200))}.scrollbar-thin::-webkit-scrollbar-track{background-color:var(--scrollbar-track);border-radius:var(--scrollbar-track-radius)}.scrollbar-thin::-webkit-scrollbar-track:hover{background-color:var(--scrollbar-track-hover, var(--scrollbar-track))}.scrollbar-thin::-webkit-scrollbar-track:active{background-color:var(--scrollbar-track-active, var(--scrollbar-track-hover, var(--scrollbar-track)))}.scrollbar-thin::-webkit-scrollbar-thumb{background-color:var(--scrollbar-thumb);border-radius:var(--scrollbar-thumb-radius)}.scrollbar-thin::-webkit-scrollbar-thumb:hover{background-color:var(--scrollbar-thumb-hover, var(--scrollbar-thumb))}.scrollbar-thin::-webkit-scrollbar-thumb:active{background-color:var(--scrollbar-thumb-active, var(--scrollbar-thumb-hover, var(--scrollbar-thumb)))}.scrollbar-thin::-webkit-scrollbar-corner{background-color:var(--scrollbar-corner);border-radius:var(--scrollbar-corner-radius)}.scrollbar-thin::-webkit-scrollbar-corner:hover{background-color:var(--scrollbar-corner-hover, var(--scrollbar-corner))}.scrollbar-thin::-webkit-scrollbar-corner:active{background-color:var(--scrollbar-corner-active, var(--scrollbar-corner-hover, var(--scrollbar-corner)))}.scrollbar-thin{scrollbar-width:thin;scrollbar-color:var(--scrollbar-thumb, initial) var(--scrollbar-track, initial)}.scrollbar-thin::-webkit-scrollbar{display:block;width:8px;height:8px}.scrollbar-track-transparent{--scrollbar-track: transparent !important}.scrollbar-thumb-slate-400\\/50{--scrollbar-thumb: rgb(148 163 184 / .5) !important}.scrollbar-corner-transparent{--scrollbar-corner: transparent !important}.has-\\[\\:checked\\]\\:\\!variant-filled-primary:has(:checked){--tw-bg-opacity: 1 !important;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity))!important;color:rgb(var(--on-primary))!important}:is(.dark .has-\\[\\:checked\\]\\:\\!variant-filled-primary:has(:checked)){--tw-bg-opacity: 1 !important;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity))!important;color:rgb(var(--on-primary))!important}.hover\\:variant-filled:hover{background-color:rgb(var(--color-surface-900));color:rgb(var(--color-surface-50))}.dark .hover\\:variant-filled:hover{background-color:rgb(var(--color-surface-50));color:rgb(var(--color-surface-900))}.hover\\:variant-soft:hover,.hover\\:variant-soft-surface:hover{background-color:rgb(var(--color-surface-400) / .2);--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important;color:rgb(var(--color-surface-700))}.dark .hover\\:variant-soft:hover,.dark .hover\\:variant-soft-surface:hover{color:rgb(var(--color-surface-200))}:is(.dark .hover\\:variant-soft:hover){background-color:rgb(var(--color-surface-500) / .2)}:is(.dark .hover\\:variant-soft-surface:hover){background-color:rgb(var(--color-surface-500) / .2)}.\\[\\&\\:not\\(\\[disabled\\]\\)\\]\\:variant-soft-primary:not([disabled]){background-color:rgb(var(--color-primary-400) / .2);--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important;color:rgb(var(--color-primary-700))}.dark .\\[\\&\\:not\\(\\[disabled\\]\\)\\]\\:variant-soft-primary:not([disabled]){color:rgb(var(--color-primary-200))}:is(.dark .\\[\\&\\:not\\(\\[disabled\\]\\)\\]\\:variant-soft-primary:not([disabled])){background-color:rgb(var(--color-primary-500) / .2)}.\\*\\:\\!m-0>*{margin:0!important}.\\*\\:items-center>*{align-items:center}.\\*\\:\\!rounded-none>*{border-radius:0!important}.\\*\\:py-4>*{padding-top:16px;padding-bottom:16px}.\\*\\:text-sm>*{font-size:14px;line-height:20px}.\\*\\:border-surface-300-600-token>*{border-color:rgb(var(--color-surface-300))}.dark .\\*\\:border-surface-300-600-token>*{border-color:rgb(var(--color-surface-600))}.hover\\:translate-x-0:hover{--tw-translate-x: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\\:text-xl:hover{font-size:20px;line-height:28px}.hover\\:opacity-100:hover{opacity:1}.hover\\:brightness-110:hover{--tw-brightness: brightness(1.1);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.hover\\:brightness-\\[105\\%\\]:hover{--tw-brightness: brightness(105%);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.focus\\:decoration-wavy:focus{text-decoration-style:wavy}.focus\\:\\!outline-none:focus{outline:2px solid transparent!important;outline-offset:2px!important}.disabled\\:cursor-wait:disabled{cursor:wait}.disabled\\:opacity-70:disabled{opacity:.7}.dark\\:\\!border-surface-200:is(.dark *){--tw-border-opacity: 1 !important;border-color:rgb(var(--color-surface-200) / var(--tw-border-opacity))!important}.dark\\:border-surface-500\\/20:is(.dark *){border-color:rgb(var(--color-surface-500) / .2)}.dark\\:bg-black\\/15:is(.dark *){background-color:#00000026}.dark\\:bg-surface-300:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(var(--color-surface-300) / var(--tw-bg-opacity))}.dark\\:bg-surface-500\\/20:is(.dark *){background-color:rgb(var(--color-surface-500) / .2)}.dark\\:bg-surface-700:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(var(--color-surface-700) / var(--tw-bg-opacity))}.dark\\:fill-slate-200:is(.dark *){fill:#e2e8f0}.dark\\:stroke-surface-50:is(.dark *){stroke:rgb(var(--color-surface-50) / 1)}.dark\\:accent-surface-50:is(.dark *){accent-color:rgb(var(--color-surface-50) / 1)}.dark\\:hover\\:brightness-110:hover:is(.dark *){--tw-brightness: brightness(1.1);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}@media (min-width: 768px){.md\\:h-\\[600px\\]{height:600px}.md\\:max-w-screen-md{max-width:768px}.md\\:max-w-screen-sm{max-width:640px}.md\\:flex-row{flex-direction:row}.md\\:\\!items-baseline{align-items:baseline!important}}@media (min-width: 1024px){.lg\\:max-w-screen-md{max-width:768px}}@media (min-width: 1280px){.xl\\:max-w-screen-lg{max-width:1024px}}.\\[\\&\\:last-child\\]\\:\\*\\:pt-4>*:last-child{padding-top:16px}.\\[\\&\\:not\\(\\:last-child\\)\\]\\:\\*\\:py-4>*:not(:last-child){padding-top:16px;padding-bottom:16px}.\\[\\&\\:not\\(\\[disabled\\]\\)\\]\\:hover\\:bg-slate-400\\/30:hover:not([disabled]){background-color:#94a3b84d}.\\[\\&\\>input\\]\\:\\!min-w-0>input{min-width:0px!important}.\\[\\&\\>input\\]\\:\\!border-transparent>input{border-color:transparent!important} "),window._pdlShadowStyle=t})(),function(t,e,r,a){"use strict";var n=Object.defineProperty,o=(t,e,r)=>((t,e,r)=>e in t?n(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r)(t,"symbol"!=typeof e?e+"":e,r),i=(()=>"undefined"!=typeof GM_download?GM_download:void 0)(),s=(()=>"undefined"!=typeof GM_info?GM_info:void 0)(),l=(()=>"undefined"!=typeof GM_registerMenuCommand?GM_registerMenuCommand:void 0)(),c=(()=>"undefined"!=typeof GM_xmlhttpRequest?GM_xmlhttpRequest:void 0)(),d=(()=>"undefined"!=typeof unsafeWindow?unsafeWindow:void 0)();const u=function(){const t=["info","warn","error"],e=["color: green;","color: orange;","color: red;"],r="[Pixiv Downlaoder] ";function a(r,a){2<=r&&console[t[r]]("%c[Pixiv Downloader]",e[r],...a)}return{info(...t){a(0,t)},warn(...t){a(1,t)},error(...t){a(2,t)},time(t){console.time(r+t)},timeLog(t){console.timeLog(r+t)},timeEnd(t){console.timeEnd(r+t)},throw(t,e){throw e?new e(`${r}${t}`):new Error(`${r}${t}`)}}}();function p(t){return new Promise((e=>{setTimeout(e,t)}))}function h(t){if("string"!=typeof t)throw new TypeError("expect string but got "+typeof t);return t?t.replace(new RegExp("\\p{C}","gu"),"").replace(/\\/g,"＼").replace(/\//g,"／").replace(/:/g,"：").replace(/\*/g,"＊").replace(/\?/g,"？").replace(/\|/g,"｜").replace(/"/g,"＂").replace(/</g,"﹤").replace(/>/g,"﹥").replace(/~/g,"～").trim().replace(/^\.|\.$/g,"．"):""}function f(t){return new Promise((e=>{const r=new FileReader;r.onload=()=>{e(r.result)},r.readAsDataURL(t)}))}async function g(t){t.adoptedStyleSheets=[window._pdlShadowStyle]}function m(t){if(t.normalize(),0===t.childNodes.length)return"";const e=["ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","DD","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HR","LI","MAIN","NAV","OL","P","PRE","SECTION","TABLE","UL"];let r="";for(let a=0;a<t.childNodes.length;a++){const n=t.childNodes[a];if(n.nodeType===Node.TEXT_NODE){const t=n.nodeValue;(null==t?void 0:t.trim())&&(r+=t)}else if(n.nodeType===Node.ELEMENT_NODE){if("BR"===n.nodeName){r+="\n";continue}if(e.includes(n.nodeName)){const t=m(n);t&&(r+=r?"\n"+t:t)}else{const t=m(n);t&&(r+=t)}}}return r}function w(t,e){const r=document.createElement("a");r.href=URL.createObjectURL(t),r.download=e,r.click(),URL.revokeObjectURL(r.href)}class b extends Error{constructor(t,e){super(e+" "+t),o(this,"url"),o(this,"status"),this.name="RequestError",this.url=t,this.status=e}}class v extends Error{constructor(){super("User aborted."),this.name="CancelError"}}class y extends Error{constructor(t){super(t),this.name="JsonDataError"}}const x={isFirefox:()=>navigator.userAgent.includes("Firefox"),isViolentmonkey:()=>"Violentmonkey"===s.scriptHandler,isTampermonkey:()=>"Tampermonkey"===s.scriptHandler,isBlobDlAvaliable(){return!this.isFirefox()||this.isFirefox()&&this.isTampermonkey()&&parseFloat(s.version??"")<4.18},isSupportSubpath(){return this.isBrowserDownloadMode()},isBrowserDownloadMode:()=>"browser"===s.downloadMode,isConflictActionEnable(){return this.isTampermonkey()&&parseFloat(s.version??"")>=4.18&&this.isBrowserDownloadMode()},isConflictActionPromptEnable(){return!this.isFirefox()&&this.isConflictActionEnable()},isFileSystemAccessAvaliable:()=>"function"==typeof d.showDirectoryPicker&&"function"==typeof d.showSaveFilePicker,videoFrameSupported:()=>"function"==typeof d.VideoFrame,isPixiv:()=>"www.pixiv.net"===location.hostname,isYande:()=>"yande.re"===location.hostname,isRule34:()=>"rule34.xxx"===location.hostname};const k=new class{constructor(t){o(this,"filenameConflictAction","uniquify"),o(this,"updateDirHandleChannel"),o(this,"dirHandle"),o(this,"dirHandleStatus",0),o(this,"cachedTasks",[]),o(this,"duplicateFilenameCached",{}),this.updateDirHandleChannel=new BroadcastChannel(t),this.updateDirHandleChannel.onmessage=t=>{const e=t.data;switch(e.kind){case 1:this.dirHandleStatus=1,u.info("正在选择目录");break;case 0:u.warn("取消更新dirHandle"),this.dirHandle?(this.dirHandleStatus=2,this.processCachedTasks()):(this.dirHandleStatus=0,this.rejectCachedTasks());break;case 2:this.dirHandleStatus=2,this.dirHandle=e.handle,u.info("更新dirHandle",this.dirHandle),this.processCachedTasks();break;case"request":this.dirHandle&&(this.updateDirHandleChannel.postMessage({kind:"response",handle:this.dirHandle}),u.info("响应请求dirHandle"));break;case"response":this.dirHandle||(0===this.dirHandleStatus&&(this.dirHandleStatus=2),this.dirHandle=e.handle,u.info("首次获取dirHandle",this.dirHandle));break;default:throw new Error("Invalid data kind.")}},this.updateDirHandleChannel.postMessage({kind:"request"})}async getDirHandleRecursive(t){if(!this.dirHandle)throw new Error("未选择保存文件夹");let e=this.dirHandle;if("string"==typeof t){if(-1===t.indexOf("/"))return await e.getDirectoryHandle(t,{create:!0});t=t.split("/").filter((t=>!!t))}for await(const r of t)e=await e.getDirectoryHandle(r,{create:!0});return e}processCachedTasks(){const{length:t}=this.cachedTasks;for(let e=0;e<t;e++){const[t,r,a,n]=this.cachedTasks[e];this.saveFile(t,r).then(a,n)}u.info(`执行${t}个缓存任务`),this.cachedTasks.length>t?this.cachedTasks=this.cachedTasks.slice(t):this.cachedTasks.length=0}rejectCachedTasks(){this.cachedTasks.forEach((([,,,t])=>t(new v))),this.cachedTasks.length=0,u.info(`取消${this.cachedTasks.length}个缓存任务`)}async getFilenameHandle(t,e){if("overwrite"===this.filenameConflictAction)return await t.getFileHandle(e,{create:!0});if(!(e in this.duplicateFilenameCached)){this.duplicateFilenameCached[e]=[];try{await t.getFileHandle(e),u.warn("存在同名文件",e)}catch(r){return await t.getFileHandle(e,{create:!0})}}const r=e.lastIndexOf("."),a=e.slice(r+1),n=e.slice(0,r);if("prompt"===this.filenameConflictAction)return await d.showSaveFilePicker({suggestedName:e,types:[{description:"Image file",accept:{["image/"+a]:["."+a]}}]});for(let r=1;r<1e3;r++){const o=`${n} (${r}).${a}`;try{await t.getFileHandle(o)}catch(r){if(this.duplicateFilenameCached[e].includes(o))continue;return this.duplicateFilenameCached[e].push(o),u.info("使用文件名:",o),await t.getFileHandle(o,{create:!0})}}throw new RangeError("Oops, you have too many duplicate files.")}clearFilenameCached(t,e){if(!(t in this.duplicateFilenameCached))return;const r=this.duplicateFilenameCached[t];if(u.info("清理重名文件名",r,e),0===r.length)return void delete this.duplicateFilenameCached[t];const a=r.indexOf(e);-1!==a&&(r.splice(a,1),0===r.length&&delete this.duplicateFilenameCached[t])}async updateDirHandle(){try{return this.dirHandleStatus=1,this.updateDirHandleChannel.postMessage({kind:1}),this.dirHandle=await d.showDirectoryPicker({id:"pdl",mode:"readwrite"}),u.info("更新dirHandle",this.dirHandle),this.dirHandleStatus=2,this.updateDirHandleChannel.postMessage({kind:2,handle:this.dirHandle}),this.processCachedTasks(),!0}catch(t){return u.warn(t),this.updateDirHandleChannel.postMessage({kind:0}),this.dirHandle?(this.dirHandleStatus=2,this.processCachedTasks()):(this.dirHandleStatus=0,this.rejectCachedTasks()),!1}}getCurrentDirName(){var t;return(null==(t=this.dirHandle)?void 0:t.name)??""}isDirHandleNotSet(){return 0===this.dirHandleStatus}setFilenameConflictAction(t){this.filenameConflictAction=t}async saveFile(t,e){if(e.isAborted)throw new v;if(1===this.dirHandleStatus){let r,a;const n=new Promise(((t,e)=>{r=t,a=e}));return this.cachedTasks.push([t,e,r,a]),n}if(0===this.dirHandleStatus){if(!await this.updateDirHandle())throw new TypeError("Failed to get dir handle.")}let r,a;const n=e.config.path,o=n.lastIndexOf("/");if(-1===o?(a=n,r=this.dirHandle):(a=n.slice(o+1),r=await this.getDirHandleRecursive(n.slice(0,o))),e.isAborted)throw new v;const i=await this.getFilenameHandle(r,a),s=await i.createWritable();await s.write(t),await s.close(),this.clearFilenameCached(a,i.name)}}("update_dir_channel");var $=(t=>(t.ZIP="zip",t.GIF="gif",t.WEBP="webp",t.PNG="png",t.WEBM="webm",t.MP4="mp4",t))($||{}),C=(t=>(t.UNIQUIFY="uniquify",t.OVERWRITE="overwrite",t.PROMPT="prompt",t))(C||{}),A=(t=>(t.JAPANESE="ja",t.CHINESE="zh",t.TRADITIONAL_CHINESE="zh_tw",t.ENGLISH="en",t))(A||{}),E=(t=>(t[t.NEVER=0]="NEVER",t[t.EVERY_DAY=86400]="EVERY_DAY",t[t.EVERY_7_DAY=604800]="EVERY_7_DAY",t[t.EVERY_30_DAY=2592e3]="EVERY_30_DAY",t))(E||{});let _,S;const P=x.isBlobDlAvaliable();x.isSupportSubpath()?S=P?function(t,e){return new Promise(((r,a)=>{if(e.isAborted)return a(new v);const n=URL.createObjectURL(t),o={url:URL.createObjectURL(t),name:e.config.path,onerror:t=>{URL.revokeObjectURL(n),e.isAborted?r():(console.error(t),a(new Error(`FileSave error: ${e.config.path}`)))},onload:()=>{URL.revokeObjectURL(n),r()}};e.abort=i(o).abort}))}:function(t,e){return f(t).then((t=>new Promise(((r,a)=>{if(e.isAborted)return a(new v);const n={url:t,name:e.config.path,onerror:t=>{e.isAborted?r():(console.error(t),a(new Error(`FileSave error: ${e.config.path}`)))},onload:()=>{r()}};e.abort=i(n).abort}))))}:(S=function(t,e){if(e.isAborted)return Promise.reject(new v);let r=e.config.path;const a=r.lastIndexOf("/");-1!==a&&(r=r.slice(a+1));const n=document.createElement("a");return n.href=URL.createObjectURL(t),n.download=r,n.click(),URL.revokeObjectURL(n.href),Promise.resolve()},u.warn("Download function is not fully supported:",s.scriptHandler,s.version));const I={getAdapter(){return this.isFileSystemAccessEnable()?(k.setFilenameConflictAction(_.get("fileSystemFilenameConflictAction")),k.saveFile.bind(k)):S},isFileSystemAccessEnable:()=>x.isFileSystemAccessAvaliable()&&_.get("useFileSystemAccess"),dirHandleCheck(){this.isFileSystemAccessEnable()&&k.isDirHandleNotSet()&&k.updateDirHandle()},async updateDirHandle(){return this.isFileSystemAccessEnable()?(await k.updateDirHandle(),k.getCurrentDirName()):""},getFsaDirName(){return this.isFileSystemAccessEnable()?k.getCurrentDirName():""}};const T=function(){let t=[],e=[];const r=(r,n)=>{p(500).then((()=>{if(e.splice(e.indexOf(r),1),n)e.push(n),a(n);else if(t.length){const r=t.shift();e.push(r),a(r)}}))},a=t=>{u.info("Start download:",t.config.src);const e=(t=>{const{taskId:e,config:a,timeout:n}=t,o=I.getAdapter();return c({url:a.src,timeout:n,method:"GET",headers:a.headers,responseType:"blob",ontimeout(){var e;const{taskId:a,config:n,isAborted:o}=t;if(!o)if(++t.retry>3){const o=new Error(`Download timout. ${a} | ${n.src}`);null==(e=n.onError)||e.call(n,o,n),t.reject(o),r(t)}else u.error(`Download timeout: ${t.retry}. ${a}`),u.info("Retry download:",t.retry,n.src),r(t,t)},onerror(e){var a;const{taskId:n,config:o,isAborted:i}=t;if(i)return;let s;429===e.status?s=new b(o.src,e.status):(s=new Error(`Download failed. ID: ${n}.`),u.error(e)),null==(a=o.onError)||a.call(o,s,o),t.reject(s),r(t)},onprogress:t=>{var e;if(t.loaded>0&&t.total>0){const r=Math.floor(t.loaded/t.total*100);null==(e=a.onProgress)||e.call(a,r,a)}},onload:async n=>{var i,s,l,c,d;if(r(t),t.isAborted)return u.warn("Download was canceled.",e,a.path);const{status:p,statusText:h,finalUrl:f}=n;if(p<200||p>299){const e=new b(h+" "+f,p);return null==(i=a.onError)||i.call(a,e,a),void t.reject(e)}u.info("Xhr complete:",a.src),null==(s=a.onXhrLoaded)||s.call(a,a);try{let e;"function"==typeof a.beforeFileSave?(e=await a.beforeFileSave(n.response,a),e&&!t.isAborted&&(await o(e,t),null==(l=a.onFileSaved)||l.call(a,a),u.info("Download complete:",a.path))):(await o(n.response,t),null==(c=a.onFileSaved)||c.call(a,a),u.info("Download complete:",a.path)),t.resolve(t.taskId)}catch(e){null==(d=a.onError)||d.call(a,e,a),t.reject(e)}}})})(t);t.abort=e.abort};return{get fileSystemAccessEnabled(){return I.isFileSystemAccessEnable()},dirHandleCheck(){I.dirHandleCheck()},updateDirHandle:()=>I.updateDirHandle(),getCurrentFsaDirName:()=>I.getFsaDirName(),async download(r){if(u.info("Downloader add:",r),Array.isArray(r)||(r=[r]),r.length<1)return Promise.resolve([]);const n=[];for(r.forEach((e=>{n.push(new Promise(((r,a)=>{const n={taskId:e.taskId,config:e,isAborted:!1,retry:0,timeout:e.timeout,resolve:r,reject:a};t.push(n)})))}));e.length<5&&t.length;){const r=t.shift();e.push(r),a(r)}const o=await Promise.allSettled(n),i=[];for(let t=0;t<o.length;t++){const e=o[t];if("rejected"===e.status)throw e.reason;i.push(e.value)}return i},abort(r){if("string"==typeof r&&(r=[r]),r.length)for(u.info("Downloader delete, active:",e.length,"queue",t.length),e=e.filter((t=>{var e,a,n;if(!r.includes(t.taskId)||t.isAborted)return!0;t.isAborted=!0,null==(e=t.abort)||e.call(t),null==(n=(a=t.config).onAbort)||n.call(a,t.config),t.reject(new v),u.warn("Download aborted:",t.config.path)})),t=t.filter((t=>!r.includes(t.taskId)));e.length<5&&t.length;){const r=t.shift();e.push(r),a(r)}}}}();class B extends t{constructor(){super("PdlHistory"),o(this,"history"),o(this,"imageEffect"),this.version(3).stores({history:"pid, userId, user, title, *tags",imageEffect:"id"})}throwIfInvalidNumber(t){if("string"==typeof t){if(""===t)return u.throw('Invalid argument: can not be "".',RangeError);t=+t}return(t<0||!Number.isSafeInteger(t))&&u.throw(`Invalid number: ${t}, must be a non-negative integer.`,RangeError),t}async add(t){const{pid:e,page:r}=t;return this.transaction("rw",this.history,(async()=>{if(void 0!==r){this.throwIfInvalidNumber(r);const a=await this.get(e);if(a&&void 0===a.page)delete t.page,this.history.put(t);else{const e=B.updatePageData(r,null==a?void 0:a.page);this.history.put({...t,page:e})}}else this.history.put(t)}))}import(t){const e=t.map((t=>t.page?{...t,page:new Uint8Array(Object.values(t.page))}:t));return this.history.bulkPut(e)}async has(t,e){if(void 0===e)return!!await this.get(t);{this.throwIfInvalidNumber(e);const r=await this.get(t);return!!r&&(!r.page||B.isPageInData(e,r.page))}}get(t){return t=this.throwIfInvalidNumber(t),this.history.get(t)}getAll(){return this.history.toArray()}generateCsv(){return this.getAll().then((t=>{const e=t.map((t=>{const{pid:e,userId:r="",user:a="",title:n="",tags:o="",comment:i=""}=t;return[String(e),String(r),a,n,i,o?o.join(","):o]}));return e.unshift(["id","userId","user","title","comment","tags"]),function(t){const e=t.map((t=>t.map((t=>'"'+t.replace(/"/g,'""')+'"')).join(","))).join("\r\n");return new Blob(["\ufeff"+e],{type:"text/csv"})}(e)}))}clear(){return this.history.clear()}async getImageEffect(t){const e=await this.imageEffect.get(t);return e||e}addImageEffect(t){return this.imageEffect.put(t)}static updatePageData(t,e){const r=Math.floor(t/8),a=t%8;if(e){if(r>e.length-1){const t=new Uint8Array(r+1);return t.set(e),t[r]|=1<<a,t}return e[r]|=1<<a,e}{const t=new Uint8Array(r+1);return t[r]|=1<<a,t}}static isPageInData(t,e){const r=Math.floor(t/8),a=t%8;return!(r>e.length-1||!(e[r]&1<<a))}}class L extends B{constructor(){super(),o(this,"cache",new Map),o(this,"initCachePromise"),o(this,"channel"),this.initCachePromise=this.initCache(),this.channel=this.initChannel()}async initCache(){u.time("loadDb");const t=await this.getAll();let e;for(let r=0;e=t[r++];){const{pid:t,page:r=null}=e;this.cache.set(t,r)}u.timeEnd("loadDb")}initChannel(){const t=new BroadcastChannel("pdl_sync-cache");return t.addEventListener("message",(t=>{const{data:e}=t;if(void 0===e)return this.cache.clear(),void u.info("clear database cache");Array.isArray(e)?(e.forEach((t=>{this.cache.set(t.pid,t.page)})),u.info("Sync database cache:",e.length)):this.cache.set(e.pid,e.page)})),t}syncCacheViaChannel(t){this.channel.postMessage(t)}updateCache(t){Array.isArray(t)?t.forEach((t=>{this.cache.set(t.pid,t.page)})):this.cache.set(t.pid,t.page),this.syncCacheViaChannel(t)}clearCache(){this.cache.clear(),this.syncCacheViaChannel()}async getCache(t){return t=this.throwIfInvalidNumber(t),await this.initCachePromise,this.cache.get(t)}async add(t){const{pid:e,page:r}=t;if(void 0===r)!await this.has(e)&&this.updateCache({pid:e,page:null});else{this.throwIfInvalidNumber(r);const t=await this.getCache(e);null!==t?this.updateCache({pid:e,page:B.updatePageData(r,t)}):this.updateCache({pid:e,page:null})}return super.add(t)}import(t){const e=t.map((t=>({pid:t.pid,page:t.page?new Uint8Array(Object.values(t.page)):null})));return this.updateCache(e),super.import(t)}async has(t,e){if(t=this.throwIfInvalidNumber(t),await this.initCachePromise,void 0===e)return this.cache.has(t);{this.throwIfInvalidNumber(e);const r=await this.getCache(t);return void 0!==r&&(null===r||B.isPageInData(e,r))}}clear(){return this.clearCache(),super.clear()}}const M=new class extends L{constructor(){super(...arguments),o(this,"subscribers",new Set)}runSubscription(){u.info("runSubscription",this.subscribers.size),this.subscribers.forEach((t=>{t(this.cache)}))}async initCache(){await super.initCache(),this.runSubscription()}initChannel(){const t=super.initChannel();return t.addEventListener("message",(()=>{this.runSubscription()})),t}updateCache(t){super.updateCache(t),this.runSubscription()}clearCache(){super.clearCache(),this.runSubscription()}subscribe(t){return this.subscribers.add(t),t(this.cache),()=>{this.subscribers.delete(t)}}};class D{async getHtml(t){u.info("Fetch url:",t);const e=await fetch(t);if(!e.ok)throw new b(e.url,e.status);return await e.text()}async getDoc(t){const e=await this.getHtml(t);return(new DOMParser).parseFromString(e,"text/html")}async getJSON(t,e){u.info("Fetch url:",t);const r=await fetch(t,e);if(!r.ok)throw new b(r.url,r.status);return await r.json()}}const z=new class extends D{async getPosts(t){let e="https://api.rule34.xxx/index.php?page=dapi&s=post&q=index&json=1";Object.entries(t).forEach((([t,r])=>{"number"==typeof r?r=String(r):Array.isArray(r)&&(r=r.join("+")),e+=`&${t}=${r}`}));const r=await fetch(e);try{return await r.json()}catch(t){if(t instanceof SyntaxError)return[];throw t}}},F={async parse(t){var e,r,a,n,o,i;const s=await fetch("index.php?page=post&s=view&id="+t);if(!s.ok)throw new b(s.url,s.status);const l=await s.text(),c=(new DOMParser).parseFromString(l,"text/html"),d=(null==(e=c.querySelector("#gelcomVideoPlayer > source"))?void 0:e.src)||c.querySelector('meta[property="og:image"]').getAttribute("content"),u=new RegExp("(?<=\\/)\\w+\\.\\w+(?=\\?)").exec(d);if(!u)throw new Error("Can not parse image name from src.");const p=u[0],[h,f]=p.split("."),g=[],m=[],w=[];let v="";c.querySelectorAll('li[class*="tag-type"]').forEach((t=>{var e;const r=new RegExp("(?<=tag-type-)\\w+").exec(t.className);if(!r)throw new Error("Unknown tag: "+t.className);const a=r[0],n=((null==(e=t.querySelector('a[href*="page=post"]'))?void 0:e.textContent)||"").replaceAll(" ","_");"artist"===a?g.push(n):"character"===a&&m.push(n),w.push(a+":"+n)}));const y=c.querySelector('a[href*="page=account&s=profile"]'),x=null==(a=null==(r=null==y?void 0:y.parentElement)?void 0:r.firstChild)?void 0:a.nodeValue,k=x?x.split(": ")[1]:"",$=null==(o=null==(n=null==y?void 0:y.parentElement)?void 0:n.nextElementSibling)?void 0:o.nextElementSibling;if($&&/^source:/i.test($.textContent??"")){const t=$.querySelector("a");v=t?t.href:(null==(i=$.textContent)?void 0:i.replace(/^source: ?/i,""))??""}const C=/Rating: ?(Explicit|Questionable|Safe)/.exec(c.documentElement.innerHTML)[1].toLowerCase();return{id:t,src:d,extendName:f,artist:g.join(",")||"UnknownArtist",character:m.join(",")||"UnknownCharacter",title:h,tags:w,createDate:k,source:v,rating:C}},async parseFavorite(t,e=0){const r=(await z.getDoc(`/index.php?page=favorites&s=view&id=${t}&pid=${e}`)).querySelectorAll(".image-list > span + script");return Array.from(r).map((t=>{const e=t.textContent,[r]=new RegExp("(?<=posts\\[)[0-9]+?(?=\\])").exec(e),[a]=new RegExp("(?<=tags: [\"']).*?(?=[\"']\\.)").exec(e),[n]=new RegExp("(?<=rating: [\"']).*?(?=[\"'],)").exec(e),[o]=new RegExp("(?<=score: [\"'])[0-9]+(?=[\"'],)").exec(e),[i]=new RegExp("(?<=user: [\"']).*?(?=[\"']\\s+})").exec(e);return{id:r,tags:a.split(" "),rating:n,score:+o,user:i}}))},_parsePostData(t){const e=Array.from(t.querySelectorAll(".image-list > span.thumb")).map((t=>{const e=t.querySelector("img").title.trim().replaceAll(/ +/g," ").split(" "),r=t.id.slice(1),a=[];let n="",o=0,i="";for(let t=0;t<e.length;t++){const r=e[t];r.startsWith("rating:")?n=r.slice(7):r.startsWith("score:")?o=+r.slice(6):r.startsWith("user:")?i=r.slice(5):a.push(r)}return{id:r,tags:a,rating:n,score:+o,user:i}}));return u.info(`Parse posts in ${t.URL}:`,e),e},async parsePool(t){const e=await z.getDoc(`/index.php?page=pool&s=show&id=${t}`);return this._parsePostData(e)},async parsePost(t=0,e="all"){Array.isArray(e)&&(e=e.join("+"));const r=await z.getDoc(`/index.php?page=post&s=list&tags=${e}&pid=${t}`);return this._parsePostData(r)},async*_paginationGenerator(t,e,r,a){const[n=1,o=0]=t??[];let i=n,s=await a(i),l=s.length,c=null;if(0===l)throw new Error(`There is no post in page ${i}.`);do{let t=null;if(i!==o&&s.length>=r)try{t=await a(i+1),t.length?l+=t.length:t=null}catch(e){c=e,t=null}const n=[],d=[],u=[];for(let t=0;t<s.length;t++){const{id:r,tags:a}=s[t],o={id:r,tags:a};await e(o)?n.push(r):d.push(r)}yield{total:l,page:i,avaliable:n,invalid:d,unavaliable:u},i++,s=t}while(s);if(c)throw c},async*favoriteGenerator(t,e,r){yield*this._paginationGenerator(t,e,50,(t=>{const e=50*(t-1);return this.parseFavorite(r,e)}))},async*poolGenerator(t,e,r){yield*this._paginationGenerator([1,1],e,1/0,(()=>this.parsePool(r)))},async*postGenerator(t,e,r){yield*this._paginationGenerator(t,e,42,(t=>{const e=42*(t-1);return this.parsePost(e,r)}))}},O={init:"#pdl-download",loading:"#pdl-loading",progress:"#pdl-progress",complete:"#pdl-complete",error:"#pdl-error"};var N=(t=>(t.Init="init",t.Loading="loading",t.Progress="progress",t.Complete="complete",t.Error="error",t))(N||{}),j=(t=>(t.Gallery="gallery",t.PixivMyBookmark="pixiv-my-bookmark",t.PixivHistory="pixiv-history",t.PixivPresentation="pixiv-presentation",t.PixivToolbar="pixiv-toolbar",t.PixivMangaViewer="pixiv-manga-viewer",t.YandeBrowse="yande-browse",t))(j||{});class R extends HTMLElement{constructor(t){if(super(),o(this,"btn"),o(this,"status","init"),o(this,"mediaId"),o(this,"page"),o(this,"type"),o(this,"onClick"),o(this,"unsubscriber"),o(this,"connectedFlag",!1),o(this,"shouldObserveDb",!0),o(this,"progress",0),o(this,"dirty",!1),this.dispatchDownload=this.dispatchDownload.bind(this),this.onClick=t.onClick,this.mediaId=this.checkNumberValidity(t.id),this.dataset.id=String(this.mediaId),t.type&&(this.dataset.type=this.type=t.type),void 0!==t.page&&(this.page=this.checkNumberValidity(t.page),this.dataset.page=String(this.page)),void 0!==t.shouldObserveDb&&(this.shouldObserveDb=t.shouldObserveDb),t.extraData)for(const e in t.extraData)this.dataset[e]=t.extraData[e]}static get tagNameLowerCase(){return"pdl-button"}checkNumberValidity(t){if("string"==typeof t){if(""===t)return u.throw('Invalid argument: can not be "".',RangeError);t=+t}return t<0||!Number.isSafeInteger(t)?u.throw(`Invalid number: ${t}, must be a non-negative integer.`,RangeError):t}static get observedAttributes(){return["data-id","data-status","data-page","data-type","disabled"]}attributeChangedCallback(t,e,r){switch(t){case"data-id":this.updateId(r);break;case"data-status":this.updateIcon(r);break;case"data-page":this.updatePage(r);break;case"data-type":this.resetType(r);break;case"disabled":this.updateDisableStatus(r)}}resetType(t){null===t&&void 0===this.type||t!==this.type&&(void 0===this.type?delete this.dataset.type:this.dataset.type=this.type,u.error('Changes to "data-type" is not allowed.'))}updateId(t){try{if(null===t)throw new Error('Attribute "data-id" is required.');this.mediaId=this.checkNumberValidity(t),this.connectedFlag&&this.shouldObserveDb&&this.observeDb()()}catch(t){u.error(t),this.dataset.id=String(this.mediaId)}}updateDisableStatus(t){this.connectedFlag?"string"==typeof t?this.btn.setAttribute("disabled",""):this.btn.removeAttribute("disabled"):this.dirty=!0}updatePage(t){try{this.page=null===t?void 0:this.checkNumberValidity(t),this.connectedFlag&&this.shouldObserveDb&&this.observeDb()()}catch(t){u.error(t),void 0===this.page?delete this.dataset.page:this.dataset.page=String(this.page)}}updateIcon(t){if(null===t)t="init";else{if("init"===t)return void delete this.dataset.status;if(!(t in O))return void(this.dataset.status=this.status)}if(this.status=t,!this.connectedFlag)return void(this.dirty=!0);const e=this.shadowRoot.querySelector("use");e.setAttribute("xlink:href",O[t]),e.animate([{opacity:.5},{opactiy:1}],{duration:200})}render(){let t;if((t=this.shadowRoot)&&!this.dirty)return;const e="progress"===this.status;t??(t=this.attachShadow({mode:"open"})),t.innerHTML=`<style>.pdl-thumbnail{position:absolute;display:flex;justify-content:center;align-items:center;margin:0;padding:0;height:32px;width:32px;top:calc((100% - 32px) * var(--pdl-btn-top) / 100);left:calc((100% - 32px) * var(--pdl-btn-left) / 100);border:none;border-radius:4px;overflow:hidden;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;user-select:none;font-family:system-ui;font-size:13px;font-weight:700;color:#262626;background-color:#ffffff80;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);z-index:1;cursor:pointer}.pdl-thumbnail:disabled{cursor:not-allowed}.pdl-thumbnail>svg{position:absolute;width:85%;height:85%;fill:currentColor;stroke:currentColor}.pdl-thumbnail>span{opacity:0;transition:opacity .2s}.pdl-thumbnail>span.show{opacity:1}:host([data-type=gallery]) .pdl-thumbnail{position:sticky;top:40px;left:0}:host([data-type=pixiv-my-bookmark]) .pdl-thumbnail{top:calc((100% - 32px) * var(--pdl-btn-self-bookmark-top) / 100);left:calc((100% - 32px) * var(--pdl-btn-self-bookmark-left) / 100)}:host([data-type=pixiv-history]) .pdl-thumbnail{z-index:auto}:host([data-type=pixiv-presentation]) .pdl-thumbnail{position:fixed;top:50px;right:20px;left:auto}:host([data-type=pixiv-toolbar]) .pdl-thumbnail{position:relative;top:auto;left:auto;color:inherit;background-color:transparent}:host([data-type=pixiv-manga-viewer]) .pdl-thumbnail{top:80%;right:4px;left:auto}:host([data-type=yande-browse]) .pdl-thumbnail{top:320px;right:4px;left:auto}:host([data-status]) .pdl-thumbnail{color:#16a34a}:host([data-status=error]) .pdl-thumbnail{color:#ef4444}</style><svg xmlns="http://www.w3.org/2000/svg" style="display: none">\n  <symbol id="pdl-download" viewBox="0 0 512 512">\n    <path\n      d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm-32-316v116h-67c-10.7 0-16 12.9-8.5 20.5l99 99c4.7 4.7 12.3 4.7 17 0l99-99c7.6-7.6 2.2-20.5-8.5-20.5h-67V140c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12z"\n    ></path>\n  </symbol>\n\n  <symbol id="pdl-loading" viewBox="0 0 512 512">\n    <style>\n      @keyframes pdl-loading {\n        0% {\n          transform: rotate3d(0, 0, 1, -90deg) rotate3d(1, 0, 0, 0deg);\n          stroke-dashoffset: 1407.43;\n        }\n\n        49.99% {\n          transform: rotate3d(0, 0, 1, 90deg) rotate3d(1, 0, 0, 0deg);\n        }\n\n        50% {\n          transform: rotate3d(0, 0, 1, 90deg) rotate3d(1, 0, 0, 180deg);\n          stroke-dashoffset: 0;\n        }\n\n        100% {\n          transform: rotate3d(0, 0, 1, 270deg) rotate3d(1, 0, 0, 180deg);\n          stroke-dashoffset: 1407.43;\n        }\n      }\n\n      circle.rotate {\n        transform-origin: 50% 50%;\n        animation: 2.5s infinite ease-in-out pdl-loading;\n      }\n    </style>\n    <circle\n      class="rotate"\n      cx="256"\n      cy="256"\n      r="224"\n      stroke-width="48"\n      fill="none"\n      stroke-dasharray="1407.43"\n      stroke-dashoffset="1055.57"\n      stroke-linecap="round"\n    ></circle>\n  </symbol>\n\n  <symbol id="pdl-progress" viewBox="0 0 512 512">\n    <style>\n      circle.progress {\n        transition: stroke-dashoffset 0.2s ease;\n      }\n    </style>\n    <circle\n      class="progress"\n      cx="256"\n      cy="256"\n      r="224"\n      stroke-width="48"\n      fill="none"\n      stroke-dasharray="1407.43"\n      stroke-linecap="round"\n      transform="rotate(-90 256 256)"\n    ></circle>\n  </symbol>\n\n  <symbol id="pdl-error" viewBox="0 0 512 512">\n    <path\n      d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm101.8-262.2L295.6 256l62.2 62.2c4.7 4.7 4.7 12.3 0 17l-22.6 22.6c-4.7 4.7-12.3 4.7-17 0L256 295.6l-62.2 62.2c-4.7 4.7-12.3 4.7-17 0l-22.6-22.6c-4.7-4.7-4.7-12.3 0-17l62.2-62.2-62.2-62.2c-4.7-4.7-4.7-12.3 0-17l22.6-22.6c4.7-4.7 12.3-4.7 17 0l62.2 62.2 62.2-62.2c4.7-4.7 12.3-4.7 17 0l22.6 22.6c4.7 4.7 4.7 12.3 0 17z"\n    ></path>\n  </symbol>\n\n  <symbol id="pdl-complete" viewBox="0 0 512 512">\n    <path\n      d="M256 8C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm0 48c110.532 0 200 89.451 200 200 0 110.532-89.451 200-200 200-110.532 0-200-89.451-200-200 0-110.532 89.451-200 200-200m140.204 130.267l-22.536-22.718c-4.667-4.705-12.265-4.736-16.97-.068L215.346 303.697l-59.792-60.277c-4.667-4.705-12.265-4.736-16.97-.069l-22.719 22.536c-4.705 4.667-4.736 12.265-.068 16.971l90.781 91.516c4.667 4.705 12.265 4.736 16.97.068l172.589-171.204c4.704-4.668 4.734-12.266.067-16.971z"\n    ></path>\n  </symbol>\n</svg>\n<button class="pdl-thumbnail" ${this.hasAttribute("disabled")?"disabled":""}>\n      <svg xmlns="http://www.w3.org/2000/svg" class="pdl-icon" ${e?`style="stroke-dashoffset: ${this.clacProgressRadial(this.progress)};"`:""}>\n        <use xlink:href="${O[this.status]}"></use>\n      </svg>\n      ${e?`<span class="show">${this.progress}</span>`:"<span></span>"}\n    </button>`}dispatchDownload(t){null==t||t.preventDefault(),null==t||t.stopPropagation(),this.setAttribute("disabled",""),this.setStatus("loading"),Promise.resolve(this.onClick(this)).then((()=>{this.setStatus("complete")}),(t=>{t&&u.error(t),this.setStatus("error")})).finally((()=>{this.removeAttribute("disabled")}))}observeDb(){return M.subscribe((async()=>{const t=await M.has(this.mediaId,this.page);"complete"===this.status?!t&&this.setStatus("init"):t&&this.setStatus("complete")}))}connectedCallback(){this.render(),this.dirty&&(this.dirty=!1),this.connectedFlag=!0,this.btn=this.shadowRoot.querySelector("button"),this.btn.addEventListener("click",this.dispatchDownload),this.shouldObserveDb&&(this.unsubscriber=this.observeDb())}disconnectedCallback(){var t,e;this.connectedFlag=!1,null==(t=this.btn)||t.removeEventListener("click",this.dispatchDownload),null==(e=this.unsubscriber)||e.call(this)}clacProgressRadial(t){const e=2*Math.PI*224;return e-t/100*e}setProgress(t,e=!0){if(t<0||t>100)throw new RangeError('Value "progress" must between 0-100');if(this.progress=Math.floor(t),"progress"!==this.status&&(this.dataset.status="progress"),!this.connectedFlag)return void(this.dirty=!0);const r=this.shadowRoot,a=r.querySelector("span");if(a.classList.add("show"),a.textContent=String(this.progress),!e)return;r.querySelector("svg.pdl-icon").style.strokeDashoffset=String(this.clacProgressRadial(t))}removeProgress(){if("progress"===this.status&&(this.dataset.status="init"),this.progress=0,!this.connectedFlag)return void(this.dirty=!0);const t=this.shadowRoot,e=t.querySelector("span"),r=t.querySelector("svg.pdl-icon");e.classList.remove("show"),e.addEventListener("transitionend",(()=>{e.textContent=""}),{once:!0}),r.style.removeProperty("stroke-dashoffset")}setStatus(t){if(t!==this.status){if("init"===t)return void delete this.dataset.status;if("progress"===t)return void this.setProgress(0);"progress"===this.status&&this.removeProgress(),this.dataset.status=t}}}customElements.define(R.tagNameLowerCase,R);class H{constructor(t){this.meta=t}normalizeString(t){return h(function(t){if("string"!=typeof t)throw new TypeError("expect string but got "+typeof t);if(!t)return"";const e=document.createElement("p");return e.innerHTML=t,e.innerText}(t))}getFolderPattern(){return _.get("folderPattern")}getFilenamePattern(){return _.get("filenamePattern")}getFullpathPattern(){const t=this.getFolderPattern(),e=this.getFilenamePattern()+"."+this.meta.extendName;return t?t+"/"+e:e}isBrowserApi(){return x.isBrowserDownloadMode()}isFsaEnable(){return T.fileSystemAccessEnabled}supportSubpath(){return this.isBrowserApi()||this.isFsaEnable()}isImage(){return/bmp|jp(e)?g|png|tif|gif|exif|svg|webp/i.test(this.meta.extendName)}buildFilePath(){const t=this.getFullpathPattern(),{id:r,createDate:a}=this.meta;let{artist:n,title:o,tags:i}=this.meta;n=this.normalizeString(n),o=this.normalizeString(o),i=i.map((t=>this.normalizeString(t)));return t.replaceAll(/\{date\((.*?)\)\}|\{date\}/g,((t,r)=>{const n=r||"YYYY-MM-DD";return e(a).format(n)})).replaceAll("{artist}",n).replaceAll("{title}",o).replaceAll("{tags}",i.join("_")).replaceAll("{id}",r)}generateTaskId(){return this.meta.id+"_"+Math.random().toString(36).slice(2)}}function U(t){if(t)return function(e){t.setProgress(e)}}class W extends H{constructor(t){super(t),o(this,"headers",_.get("token")?{cookie:`cf_clearance=${_.get("token")}`}:void 0),this.meta=t}getDownloadConfig(t){return{headers:this.headers,taskId:this.generateTaskId(),src:this.meta.src,path:this.buildFilePath(),source:this.meta,timeout:this.isImage()?6e4:void 0,onProgress:U(t)}}buildFilePath(){return super.buildFilePath().replaceAll("{character}",this.normalizeString(this.meta.character))}}async function q(t){T.dirHandleCheck();const e=t.dataset.id,r=await F.parse(e),{tags:a,artist:n,title:o,source:i,rating:s}=r,l=new W(r).getDownloadConfig(t);_.get("addBookmark")&&function(t){d.addFav(t)}(e),await T.download(l),M.add({pid:Number(e),user:n,title:o,tags:a,source:i,rating:s})}const G={setting:{save_to:{title:"保存至",label:{directory:"保存位置",filename:"文件名"},options:{use_fsa:"使用FileSystemAccess API",fsa_directory:"选择保存文件夹",fsa_filename_conflict:"当文件名重复时",tag_language:"使用的标签语言",tag_language_tips:"无翻译的标签仍可能是其他语言"},button:{choose_fsa_directory:"浏览"},radio:{filename_conflict_option_uniquify:"重命名",filename_conflict_option_overwrite:"覆盖",filename_conflict_option_prompt:"提示"},placeholder:{sub_directory_unused:"如不需要保存到子目录，此行留空即可",vm_not_supported:"Violentmonkey不支持",need_browser_api:'请将下载模式设置为"Browser Api"',filename_requried:"必填"}},ugoira:{title:"动图转换",label:{format:"动图格式",quality:"动图质量"},options:{select_format:"将动图转换到所选格式",gif_tips:"数值越低颜色越好，但处理速度显著减慢",webm_tips:"0最差，99最好",webp_lossy:"无损转换",webp_quality:"图片质量",webp_quality_tips:"有损：0表示文件最小，100表示文件最大。无损：0最快，但文件较大，100最慢，但质量最好。",webp_method:"压缩方法",webp_method_tips:"0=快，6=慢但效果更好",png_tips:"颜色数量。0：所有颜色（无损PNG）"}},history:{title:"下载历史",label:{scheduled_backups:"定期备份",export:"导出",import:"导入",clear:"清理"},options:{scheduled_backups:"以选定的时间间隔自动备份下载历史",export_as_json:"将下载历史导出为JSON文件",export_as_csv:"将下载历史导出为CSV文件",import_json:"导入JSON格式下载历史",clear_history:"清除下载历史"},button:{export:"导出记录",import:"导入记录",clear:"清除记录"},select:{backup_interval_never:"不备份",backup_interval_every_day:"每天",backup_interval_every_7_day:"每7天",backup_interval_every_30_day:"每30天"},text:{confirm_clear_history:"真的要清除历史记录吗？"}},button_position:{title:"按钮位置",label:{common:"通用",my_bookmark:"我的收藏"},options:{horizon_position:"水平位置",vertical_position:"垂直位置"}},others:{title:"其它",options:{show_setting_button:"显示设置按钮",bundle_multipage_illust:"将多页插图打包为zip压缩包",bundle_manga:"将漫画作品打包为zip压缩包",like_illust_when_downloading:"下载作品时点赞",add_bookmark_when_downloading:"下载作品时收藏",add_bookmark_with_tags:"收藏时添加作品标签",add_bookmark_private_r18:"将R-18作品收藏到不公开类别",option_does_not_apply_to_batch_download:"批量下载不适用"}},feedback:{title:"反馈 / 赞赏",label:{feedback:"反馈",donate:"赞赏"},text:{feedback_desc:'如果你在使用中发现了问题或有改进建议，欢迎到<a href="https://github.com/drunkg00se/Pixiv-Downloader/issues" target="_blank" class="anchor">此链接</a>反馈。',give_me_a_star:'如果脚本有帮助到你，<a href="https://github.com/drunkg00se/Pixiv-Downloader" target="_blank" class="anchor">欢迎点此在GitHub中给我一个 ⭐Star。</a>',donate_desc:"或者，扫码请我喝杯可乐 ^_^"}}},downloader:{category:{tab_name:"类别",filter:{exclude_downloaded:"排除已下载",exclude_blacklist:"排除黑名单",image:"图片",video:"视频",download_all_pages:"下载所有页",download_selected_pages:"自定义页数",pixiv_illust:"插画",pixiv_manga:"漫画",pixiv_ugoira:"动图"}},tag_filter:{tab_name:"标签",placeholder:{blacklist_tag:"黑名单，将排除含有以下标签的作品。",whitelist_tag:"白名单，只下载包含以下标签的作品。"}},others:{tab_name:"其它",options:{retry_failed:"对首次下载失败的图片进行重试"}},download_type:{stop:"停止",pixiv_works:"作品",pixiv_bookmark:"收藏",pixiv_bookmark_public:"公开收藏",pixiv_bookmark_private:"不公开收藏",pixiv_follow_latest_all:"全部",pixiv_follow_latest_r18:"R-18",pixiv_series:"系列",yande_posts:"投稿",yande_pool:"图集",yande_popular_1d:"日",yande_popular_1w:"周",yande_popular_1m:"月",yande_popular_1y:"年"}},button:{setting:"设置"},changelog:{feedback:"有问题or想建议？这里反馈",credit:"脚本还行？请点这里支持我！",give_me_a_star:"在GitHub中给我一个 ⭐Star，",buy_me_a_drink:"或者，扫码请我喝杯香草味冰可乐。^_^"}},Y={"zh-cn":G,"zh-tw":G,zh:G,en:{setting:{save_to:{title:"Save To",label:{directory:"Save Path",filename:"Filename"},options:{use_fsa:"Use FileSystemAccess API",fsa_directory:"Select directory",fsa_filename_conflict:"When filename conflicts",tag_language:"Tag Language",tag_language_tips:"Tags without translation may still be in another language"},button:{choose_fsa_directory:"Browse"},radio:{filename_conflict_option_uniquify:"Uniquify",filename_conflict_option_overwrite:"Overwrite",filename_conflict_option_prompt:"Prompt"},placeholder:{sub_directory_unused:"Leave folder name blank if not saving to a subdirectory",vm_not_supported:"Not supported by Violentmonkey",need_browser_api:"Browser API required",filename_requried:"Required"}},ugoira:{title:"Ugoira",label:{format:"Ugoira Format",quality:"Ugoira Quality"},options:{select_format:"Convert Ugoira to selected format",gif_tips:"Lower values produce better colors, but slow processing significantly",webm_tips:"0 (worst) to 99 (best)",webp_lossy:"Lossless Webp",webp_quality:"Image Quality",webp_quality_tips:"For lossy, 0 gives the smallest size and 100 the largest. For lossless, 0 is the fastest but gives larger files compared to the slowest, but best, 100.",webp_method:"Compression Method",webp_method_tips:"Quality/speed trade-off (0=fast, 6=slower-better)",png_tips:"Number of colors in the result; 0: all colors (lossless PNG)"}},history:{title:"History",label:{scheduled_backups:"Scheduled Backups",export:"Export",import:"Import",clear:"Clear"},options:{scheduled_backups:"Automatically back up download history at selected intervals.",export_as_json:"Export download history as JSON file",export_as_csv:"Export download history as CSV file",import_json:"Import JSON format download history",clear_history:"Clear download history"},button:{export:"Export",import:"Import",clear:"Clear"},select:{backup_interval_never:"Never",backup_interval_every_day:"Every day",backup_interval_every_7_day:"7 days",backup_interval_every_30_day:"30 days"},text:{confirm_clear_history:"Do you really want to clear history?"}},button_position:{title:"Button",label:{common:"Common",my_bookmark:"My Bookmark"},options:{horizon_position:"Horizontal Position",vertical_position:"Vertical Position"}},others:{title:"Others",options:{show_setting_button:"Show Setting Button",bundle_multipage_illust:"Bundle multipage illustrations into a zip file",bundle_manga:"Bundle manga into a zip file",like_illust_when_downloading:"Like the artwork when downloading",add_bookmark_when_downloading:"Bookmark artwork when downloading",add_bookmark_with_tags:"Add tags when bookmarking",add_bookmark_private_r18:"Bookmark R-18 artwork as private",option_does_not_apply_to_batch_download:"This option does not apply to batch download"}},feedback:{title:"Feedback",label:{feedback:"Feedback",donate:"Donate"},text:{feedback_desc:'If you encounter any issues or have suggestions for improvements, feel free to provide feedback <a href="https://github.com/drunkg00se/Pixiv-Downloader/issues" target="_blank" class=" anchor">here.</a>',give_me_a_star:'If the script is helpful to you, please <a href="https://github.com/drunkg00se/Pixiv-Downloader" target="_blank" class="anchor">click here and give me a ⭐Star on GitHub.</a>',donate_desc:"Or, buy me a cola. ^_^"}}},downloader:{category:{tab_name:"Category",filter:{exclude_downloaded:"Exclude Downloaded",exclude_blacklist:"Exclude Blacklist",image:"Image",video:"Video",download_all_pages:"All Pages",download_selected_pages:"Custom Pages",pixiv_illust:"Illustration",pixiv_manga:"Manga",pixiv_ugoira:"Ugoira"}},tag_filter:{tab_name:"Tags",placeholder:{blacklist_tag:"Blacklist: Exclude works with these tags.",whitelist_tag:"Whitelist: Only download works with these tags."}},others:{tab_name:"others",options:{retry_failed:"Retry failed image downloads."}},download_type:{stop:"Stop",pixiv_works:"Works",pixiv_bookmark:"Bookmarks",pixiv_bookmark_public:"Public",pixiv_bookmark_private:"Private",pixiv_follow_latest_all:"All",pixiv_follow_latest_r18:"R-18",pixiv_series:"Series",yande_posts:"Posts",yande_pool:"Pool",yande_popular_1d:"1d",yande_popular_1w:"1w",yande_popular_1m:"1m",yande_popular_1y:"1y"}},button:{setting:"Setting"},changelog:{feedback:"Feedback / Report an issue",credit:"Click here to support me!",give_me_a_star:"Give me a ⭐Star on GitHub.",buy_me_a_drink:"Or, buy me a vanilla-flavored iced cola. ^_^"}}},V=navigator.language.toLowerCase(),Q=V in Y?V:"en";function J(t){const e=t.split(".");let r=Y[Q];for(let t=0;t<e.length;t++){const a=r[e[t]];if(null==a)return null;r=a}return r}function X(){}const Z=t=>t;function K(t,e){for(const r in e)t[r]=e[r];return t}function tt(t){return t()}function et(){return Object.create(null)}function rt(t){t.forEach(tt)}function at(t){return"function"==typeof t}function nt(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let ot;function it(t,e){return t===e||(ot||(ot=document.createElement("a")),ot.href=e,t===ot.href)}function st(t,...e){if(null==t){for(const t of e)t(void 0);return X}const r=t.subscribe(...e);return r.unsubscribe?()=>r.unsubscribe():r}function lt(t){let e;return st(t,(t=>e=t))(),e}function ct(t,e,r){t.$$.on_destroy.push(st(e,r))}function dt(t,e,r,a){if(t){const n=ut(t,e,r,a);return t[0](n)}}function ut(t,e,r,a){return t[1]&&a?K(r.ctx.slice(),t[1](a(e))):r.ctx}function pt(t,e,r,a){if(t[2]&&a){const n=t[2](a(r));if(void 0===e.dirty)return n;if("object"==typeof n){const t=[],r=Math.max(e.dirty.length,n.length);for(let a=0;a<r;a+=1)t[a]=e.dirty[a]|n[a];return t}return e.dirty|n}return e.dirty}function ht(t,e,r,a,n,o){if(n){const i=ut(e,r,a,o);t.p(i,n)}}function ft(t){if(t.ctx.length>32){const e=[],r=t.ctx.length/32;for(let t=0;t<r;t++)e[t]=-1;return e}return-1}function gt(t){const e={};for(const r in t)"$"!==r[0]&&(e[r]=t[r]);return e}function mt(t,e){const r={};e=new Set(e);for(const a in t)e.has(a)||"$"===a[0]||(r[a]=t[a]);return r}function wt(t){const e={};for(const r in t)e[r]=!0;return e}function bt(t,e,r){return t.set(r),e}function vt(t){return t&&at(t.destroy)?t.destroy:X}function yt(t){const e="string"==typeof t&&t.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[t,"px"]}const xt="undefined"!=typeof window;let kt=xt?()=>window.performance.now():()=>Date.now(),$t=xt?t=>requestAnimationFrame(t):X;const Ct=new Set;function At(t){Ct.forEach((e=>{e.c(t)||(Ct.delete(e),e.f())})),0!==Ct.size&&$t(At)}function Et(t){let e;return 0===Ct.size&&$t(At),{promise:new Promise((r=>{Ct.add(e={c:t,f:r})})),abort(){Ct.delete(e)}}}function _t(t,e){t.appendChild(e)}function St(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Pt(t){const e=Lt("style");return e.textContent="/* empty */",function(t,e){_t(t.head||t,e),e.sheet}(St(t),e),e.sheet}function It(t,e,r){t.insertBefore(e,r||null)}function Tt(t){t.parentNode&&t.parentNode.removeChild(t)}function Bt(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function Lt(t){return document.createElement(t)}function Mt(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Dt(t){return document.createTextNode(t)}function zt(){return Dt(" ")}function Ft(){return Dt("")}function Ot(t,e,r,a){return t.addEventListener(e,r,a),()=>t.removeEventListener(e,r,a)}function Nt(t,e,r){null==r?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}const jt=["width","height"];function Rt(t,e){const r=Object.getOwnPropertyDescriptors(t.__proto__);for(const a in e)null==e[a]?t.removeAttribute(a):"style"===a?t.style.cssText=e[a]:"__value"===a?t.value=t[a]=e[a]:r[a]&&r[a].set&&-1===jt.indexOf(a)?t[a]=e[a]:Nt(t,a,e[a])}function Ht(t){let e;return{p(...r){e=r,e.forEach((e=>t.push(e)))},r(){e.forEach((e=>t.splice(t.indexOf(e),1)))}}}function Ut(t){return""===t?null:+t}function Wt(t,e){e=""+e,t.data!==e&&(t.data=e)}function qt(t,e){t.value=null==e?"":e}function Gt(t,e,r,a){null==r?t.style.removeProperty(e):t.style.setProperty(e,r,"")}function Yt(t,e,r){for(let r=0;r<t.options.length;r+=1){const a=t.options[r];if(a.__value===e)return void(a.selected=!0)}r&&void 0===e||(t.selectedIndex=-1)}function Vt(t,e){for(let r=0;r<t.options.length;r+=1){const a=t.options[r];a.selected=~e.indexOf(a.__value)}}function Qt(t){const e=t.querySelector(":checked");return e&&e.__value}function Jt(t,e,r){t.classList.toggle(e,!!r)}function Xt(t,e,{bubbles:r=!1,cancelable:a=!1}={}){return new CustomEvent(t,{detail:e,bubbles:r,cancelable:a})}class Zt{constructor(t=!1){o(this,"is_svg",!1),o(this,"e"),o(this,"n"),o(this,"t"),o(this,"a"),this.is_svg=t,this.e=this.n=null}c(t){this.h(t)}m(t,e,r=null){this.e||(this.is_svg?this.e=Mt(e.nodeName):this.e=Lt(11===e.nodeType?"TEMPLATE":e.nodeName),this.t="TEMPLATE"!==e.tagName?e:e.content,this.c(t)),this.i(r)}h(t){this.e.innerHTML=t,this.n=Array.from("TEMPLATE"===this.e.nodeName?this.e.content.childNodes:this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)It(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(Tt)}}function Kt(t,e){return new t(e)}const te=new Map;let ee,re=0;function ae(t,e,r,a,n,o,i,s=0){const l=16.666/a;let c="{\n";for(let t=0;t<=1;t+=l){const a=e+(r-e)*o(t);c+=100*t+`%{${i(a,1-a)}}\n`}const d=c+`100% {${i(r,1-r)}}\n}`,u=`__svelte_${function(t){let e=5381,r=t.length;for(;r--;)e=(e<<5)-e^t.charCodeAt(r);return e>>>0}(d)}_${s}`,p=St(t),{stylesheet:h,rules:f}=te.get(p)||function(t,e){const r={stylesheet:Pt(e),rules:{}};return te.set(t,r),r}(p,t);f[u]||(f[u]=!0,h.insertRule(`@keyframes ${u} ${d}`,h.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?`${g}, `:""}${u} ${a}ms linear ${n}ms 1 both`,re+=1,u}function ne(t,e){const r=(t.style.animation||"").split(", "),a=r.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),n=r.length-a.length;n&&(t.style.animation=a.join(", "),re-=n,re||$t((()=>{re||(te.forEach((t=>{const{ownerNode:e}=t.stylesheet;e&&Tt(e)})),te.clear())})))}function oe(t){const e=getComputedStyle(t);if("absolute"!==e.position&&"fixed"!==e.position){const{width:r,height:a}=e,n=t.getBoundingClientRect();t.style.position="absolute",t.style.width=r,t.style.height=a,function(t,e){const r=t.getBoundingClientRect();if(e.left!==r.left||e.top!==r.top){const a=getComputedStyle(t),n="none"===a.transform?"":a.transform;t.style.transform=`${n} translate(${e.left-r.left}px, ${e.top-r.top}px)`}}(t,n)}}function ie(t){ee=t}function se(){if(!ee)throw new Error("Function called outside component initialization");return ee}function le(t){se().$$.on_mount.push(t)}function ce(t){se().$$.after_update.push(t)}function de(){const t=se();return(e,r,{cancelable:a=!1}={})=>{const n=t.$$.callbacks[e];if(n){const o=Xt(e,r,{cancelable:a});return n.slice().forEach((e=>{e.call(t,o)})),!o.defaultPrevented}return!0}}function ue(t,e){return se().$$.context.set(t,e),e}function pe(t){return se().$$.context.get(t)}function he(t,e){const r=t.$$.callbacks[e.type];r&&r.slice().forEach((t=>t.call(this,e)))}const fe=[],ge=[];let me=[];const we=[],be=Promise.resolve();let ve=!1;function ye(){ve||(ve=!0,be.then(_e))}function xe(){return ye(),be}function ke(t){me.push(t)}function $e(t){we.push(t)}const Ce=new Set;let Ae,Ee=0;function _e(){if(0!==Ee)return;const t=ee;do{try{for(;Ee<fe.length;){const t=fe[Ee];Ee++,ie(t),Se(t.$$)}}catch(t){throw fe.length=0,Ee=0,t}for(ie(null),fe.length=0,Ee=0;ge.length;)ge.pop()();for(let t=0;t<me.length;t+=1){const e=me[t];Ce.has(e)||(Ce.add(e),e())}me.length=0}while(fe.length);for(;we.length;)we.pop()();ve=!1,Ce.clear(),ie(t)}function Se(t){if(null!==t.fragment){t.update(),rt(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ke)}}function Pe(){return Ae||(Ae=Promise.resolve(),Ae.then((()=>{Ae=null}))),Ae}function Ie(t,e,r){t.dispatchEvent(Xt(`${e?"intro":"outro"}${r}`))}const Te=new Set;let Be;function Le(){Be={r:0,c:[],p:Be}}function Me(){Be.r||rt(Be.c),Be=Be.p}function De(t,e){t&&t.i&&(Te.delete(t),t.i(e))}function ze(t,e,r,a){if(t&&t.o){if(Te.has(t))return;Te.add(t),Be.c.push((()=>{Te.delete(t),a&&(r&&t.d(1),a())})),t.o(e)}else a&&a()}const Fe={duration:0};function Oe(t,e,r){const a={direction:"in"};let n,o,i=e(t,r,a),s=!1,l=0;function c(){n&&ne(t,n)}function d(){const{delay:e=0,duration:r=300,easing:a=Z,tick:d=X,css:u}=i||Fe;u&&(n=ae(t,0,1,r,e,a,u,l++)),d(0,1);const p=kt()+e,h=p+r;o&&o.abort(),s=!0,ke((()=>Ie(t,!0,"start"))),o=Et((e=>{if(s){if(e>=h)return d(1,0),Ie(t,!0,"end"),c(),s=!1;if(e>=p){const t=a((e-p)/r);d(t,1-t)}}return s}))}let u=!1;return{start(){u||(u=!0,ne(t),at(i)?(i=i(a),Pe().then(d)):d())},invalidate(){u=!1},end(){s&&(c(),s=!1)}}}function Ne(t,e,r){const a={direction:"out"};let n,o=e(t,r,a),i=!0;const s=Be;let l;function c(){const{delay:e=0,duration:r=300,easing:a=Z,tick:c=X,css:d}=o||Fe;d&&(n=ae(t,1,0,r,e,a,d));const u=kt()+e,p=u+r;ke((()=>Ie(t,!1,"start"))),"inert"in t&&(l=t.inert,t.inert=!0),Et((e=>{if(i){if(e>=p)return c(0,1),Ie(t,!1,"end"),--s.r||rt(s.c),!1;if(e>=u){const t=a((e-u)/r);c(1-t,t)}}return i}))}return s.r+=1,at(o)?Pe().then((()=>{o=o(a),c()})):c(),{end(e){e&&"inert"in t&&(t.inert=l),e&&o.tick&&o.tick(1,0),i&&(n&&ne(t,n),i=!1)}}}function je(t,e,r,a){let n,o=e(t,r,{direction:"both"}),i=a?0:1,s=null,l=null,c=null;function d(){c&&ne(t,c)}function u(t,e){const r=t.b-i;return e*=Math.abs(r),{a:i,b:t.b,d:r,duration:e,start:t.start,end:t.start+e,group:t.group}}function p(e){const{delay:r=0,duration:a=300,easing:p=Z,tick:h=X,css:f}=o||Fe,g={start:kt()+r,b:e};e||(g.group=Be,Be.r+=1),"inert"in t&&(e?void 0!==n&&(t.inert=n):(n=t.inert,t.inert=!0)),s||l?l=g:(f&&(d(),c=ae(t,i,e,a,r,p,f)),e&&h(0,1),s=u(g,a),ke((()=>Ie(t,e,"start"))),Et((e=>{if(l&&e>l.start&&(s=u(l,a),l=null,Ie(t,s.b,"start"),f&&(d(),c=ae(t,i,s.b,s.duration,0,p,o.css))),s)if(e>=s.end)h(i=s.b,1-i),Ie(t,s.b,"end"),l||(s.b?d():--s.group.r||rt(s.group.c)),s=null;else if(e>=s.start){const t=e-s.start;i=s.a+s.d*p(t/s.duration),h(i,1-i)}return!(!s&&!l)})))}return{run(t){at(o)?Pe().then((()=>{o=o({direction:t?"in":"out"}),p(t)})):p(t)},end(){d(),s=l=null}}}function Re(t,e){const r=e.token={};function a(t,a,n,o){if(e.token!==r)return;e.resolved=o;let i=e.ctx;void 0!==n&&(i=i.slice(),i[n]=o);const s=t&&(e.current=t)(i);let l=!1;e.block&&(e.blocks?e.blocks.forEach(((t,r)=>{r!==a&&t&&(Le(),ze(t,1,1,(()=>{e.blocks[r]===t&&(e.blocks[r]=null)})),Me())})):e.block.d(1),s.c(),De(s,1),s.m(e.mount(),e.anchor),l=!0),e.block=s,e.blocks&&(e.blocks[a]=s),l&&_e()}if(!(n=t)||"object"!=typeof n&&"function"!=typeof n||"function"!=typeof n.then){if(e.current!==e.then)return a(e.then,1,e.value,t),!0;e.resolved=t}else{const r=se();if(t.then((t=>{ie(r),a(e.then,1,e.value,t),ie(null)}),(t=>{if(ie(r),a(e.catch,2,e.error,t),ie(null),!e.hasCatch)throw t})),e.current!==e.pending)return a(e.pending,0),!0}var n}function He(t){return void 0!==(null==t?void 0:t.length)?t:Array.from(t)}function Ue(t,e){t.f(),function(t,e){ze(t,1,1,(()=>{e.delete(t.key)}))}(t,e)}function We(t,e){const r={},a={},n={$$scope:1};let o=t.length;for(;o--;){const i=t[o],s=e[o];if(s){for(const t in i)t in s||(a[t]=1);for(const t in s)n[t]||(r[t]=s[t],n[t]=1);t[o]=s}else for(const t in i)n[t]=1}for(const t in a)t in r||(r[t]=void 0);return r}function qe(t){return"object"==typeof t&&null!==t?t:{}}function Ge(t,e,r){const a=t.$$.props[e];void 0!==a&&(t.$$.bound[a]=r,r(t.$$.ctx[a]))}function Ye(t){t&&t.c()}function Ve(t,e,r){const{fragment:a,after_update:n}=t.$$;a&&a.m(e,r),ke((()=>{const e=t.$$.on_mount.map(tt).filter(at);t.$$.on_destroy?t.$$.on_destroy.push(...e):rt(e),t.$$.on_mount=[]})),n.forEach(ke)}function Qe(t,e){const r=t.$$;null!==r.fragment&&(!function(t){const e=[],r=[];me.forEach((a=>-1===t.indexOf(a)?e.push(a):r.push(a))),r.forEach((t=>t())),me=e}(r.after_update),rt(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function Je(t,e,r,a,n,o,i=null,s=[-1]){const l=ee;ie(t);const c=t.$$={fragment:null,ctx:[],props:o,update:X,not_equal:n,bound:et(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:et(),dirty:s,skip_bound:!1,root:e.target||l.$$.root};i&&i(c.root);let d=!1;if(c.ctx=r?r(t,e.props||{},((e,r,...a)=>{const o=a.length?a[0]:r;return c.ctx&&n(c.ctx[e],c.ctx[e]=o)&&(!c.skip_bound&&c.bound[e]&&c.bound[e](o),d&&function(t,e){-1===t.$$.dirty[0]&&(fe.push(t),ye(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(t,e)),r})):[],c.update(),d=!0,rt(c.before_update),c.fragment=!!a&&a(c.ctx),e.target){if(e.hydrate){const t=(u=e.target,Array.from(u.childNodes));c.fragment&&c.fragment.l(t),t.forEach(Tt)}else c.fragment&&c.fragment.c();e.intro&&De(t.$$.fragment),Ve(t,e.target,e.anchor),_e()}var u;ie(l)}let Xe;function Ze(t,e,r,a){var n;const o=null==(n=r[t])?void 0:n.type;if(e="Boolean"===o&&"boolean"!=typeof e?null!=e:e,!a||!r[t])return e;if("toAttribute"===a)switch(o){case"Object":case"Array":return null==e?null:JSON.stringify(e);case"Boolean":return e?"":null;case"Number":return null==e?null:e;default:return e}else switch(o){case"Object":case"Array":return e&&JSON.parse(e);case"Boolean":default:return e;case"Number":return null!=e?+e:e}}"function"==typeof HTMLElement&&(Xe=class extends HTMLElement{constructor(t,e,r){super(),o(this,"$$ctor"),o(this,"$$s"),o(this,"$$c"),o(this,"$$cn",!1),o(this,"$$d",{}),o(this,"$$r",!1),o(this,"$$p_d",{}),o(this,"$$l",{}),o(this,"$$l_u",new Map),this.$$ctor=t,this.$$s=e,r&&this.attachShadow({mode:"open"})}addEventListener(t,e,r){if(this.$$l[t]=this.$$l[t]||[],this.$$l[t].push(e),this.$$c){const r=this.$$c.$on(t,e);this.$$l_u.set(e,r)}super.addEventListener(t,e,r)}removeEventListener(t,e,r){if(super.removeEventListener(t,e,r),this.$$c){const t=this.$$l_u.get(e);t&&(t(),this.$$l_u.delete(e))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){let t=function(t){return()=>{let e;return{c:function(){e=Lt("slot"),"default"!==t&&Nt(e,"name",t)},m:function(t,r){It(t,e,r)},d:function(t){t&&Tt(e)}}}};if(await Promise.resolve(),!this.$$cn||this.$$c)return;const e={},r=function(t){const e={};return t.childNodes.forEach((t=>{e[t.slot||"default"]=!0})),e}(this);for(const a of this.$$s)a in r&&(e[a]=[t(a)]);for(const t of this.attributes){const e=this.$$g_p(t.name);e in this.$$d||(this.$$d[e]=Ze(e,t.value,this.$$p_d,"toProp"))}for(const t in this.$$p_d)t in this.$$d||void 0===this[t]||(this.$$d[t]=this[t],delete this[t]);this.$$c=new this.$$ctor({target:this.shadowRoot||this,props:{...this.$$d,$$slots:e,$$scope:{ctx:[]}}});const a=()=>{this.$$r=!0;for(const t in this.$$p_d)if(this.$$d[t]=this.$$c.$$.ctx[this.$$c.$$.props[t]],this.$$p_d[t].reflect){const e=Ze(t,this.$$d[t],this.$$p_d,"toAttribute");null==e?this.removeAttribute(this.$$p_d[t].attribute||t):this.setAttribute(this.$$p_d[t].attribute||t,e)}this.$$r=!1};this.$$c.$$.after_update.push(a),a();for(const t in this.$$l)for(const e of this.$$l[t]){const r=this.$$c.$on(t,e);this.$$l_u.set(e,r)}this.$$l={}}}attributeChangedCallback(t,e,r){var a;this.$$r||(t=this.$$g_p(t),this.$$d[t]=Ze(t,r,this.$$p_d,"toProp"),null==(a=this.$$c)||a.$set({[t]:this.$$d[t]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then((()=>{!this.$$cn&&this.$$c&&(this.$$c.$destroy(),this.$$c=void 0)}))}$$g_p(t){return Object.keys(this.$$p_d).find((e=>this.$$p_d[e].attribute===t||!this.$$p_d[e].attribute&&e.toLowerCase()===t))||t}});class Ke{constructor(){o(this,"$$"),o(this,"$$set")}$destroy(){Qe(this,1),this.$destroy=X}$on(t,e){if(!at(e))return X;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(e),()=>{const t=r.indexOf(e);-1!==t&&r.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const tr=[];function er(t,e){return{subscribe:rr(t,e).subscribe}}function rr(t,e=X){let r;const a=new Set;function n(e){if(nt(t,e)&&(t=e,r)){const e=!tr.length;for(const e of a)e[1](),tr.push(e,t);if(e){for(let t=0;t<tr.length;t+=2)tr[t][0](tr[t+1]);tr.length=0}}}function o(e){n(e(t))}return{set:n,update:o,subscribe:function(i,s=X){const l=[i,s];return a.add(l),1===a.size&&(r=e(n,o)||X),i(t),()=>{a.delete(l),0===a.size&&r&&(r(),r=null)}}}}function ar(t,e,r){const a=!Array.isArray(t),n=a?[t]:t;if(!n.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const o=e.length<2;return er(r,((t,r)=>{let i=!1;const s=[];let l=0,c=X;const d=()=>{if(l)return;c();const n=e(a?s[0]:s,t,r);o?t(n):c=at(n)?n:X},u=n.map(((t,e)=>st(t,(t=>{s[e]=t,l&=~(1<<e),i&&d()}),(()=>{l|=1<<e}))));return i=!0,d(),function(){rt(u),c(),i=!1}}))}function nr(t){return{subscribe:t.subscribe.bind(t)}}function or(){return ue("drawerStore",function(){const{subscribe:t,set:e,update:r}=rr({});return{subscribe:t,set:e,update:r,open:t=>r((()=>({open:!0,...t}))),close:()=>r((t=>(t.open=!1,t)))}}())}const ir="modalStore";function sr(){const t=pe(ir);if(!t)throw new Error("modalStore is not initialized. Please ensure that `initializeStores()` is invoked in the root layout file of this app!");return t}function lr(){const t=function(){const{subscribe:t,set:e,update:r}=rr([]);return{subscribe:t,set:e,update:r,trigger:t=>r((e=>(e.push(t),e))),close:()=>r((t=>(t.length>0&&t.shift(),t))),clear:()=>e([])}}();return ue(ir,t)}const cr={message:"Missing Toast Message",autohide:!0,timeout:5e3};function dr(){return ue("toastStore",function(){const{subscribe:t,set:e,update:r}=rr([]),a=t=>r((e=>{if(e.length>0){const r=e.findIndex((e=>e.id===t)),a=e[r];a&&(a.callback&&a.callback({id:t,status:"closed"}),a.timeoutId&&clearTimeout(a.timeoutId),e.splice(r,1))}return e}));function n(t){if(!0===t.autohide)return setTimeout((()=>{a(t.id)}),t.timeout)}return{subscribe:t,close:a,trigger:t=>{const e=function(){const t=Math.random();return Number(t).toString(32)}();return r((r=>{t&&t.callback&&t.callback({id:e,status:"queued"}),t.hideDismiss&&(t.autohide=!0);const a={...cr,...t,id:e};return a.timeoutId=n(a),r.push(a),r})),e},freeze:t=>r((e=>(e.length>0&&clearTimeout(e[t].timeoutId),e))),unfreeze:t=>r((e=>(e.length>0&&(e[t].timeoutId=n(e[t])),e))),clear:()=>e([])}}())}const ur={};function pr(t){return"local"===t?localStorage:sessionStorage}function hr(t,e,r){const a=JSON,n="local";function o(t,e){pr(n).setItem(t,a.stringify(e))}if(!ur[t]){const r=rr(e,(e=>{const r=pr(n).getItem(t);r&&e(a.parse(r));{const r=r=>{r.key===t&&e(r.newValue?a.parse(r.newValue):null)};return window.addEventListener("storage",r),()=>window.removeEventListener("storage",r)}})),{subscribe:i,set:s}=r;ur[t]={set(e){o(t,e),s(e)},update(e){const a=e(lt(r));o(t,a),s(a)},subscribe:i}}return ur[t]}hr("modeOsPrefers",!1),hr("modeUserPrefers",void 0),hr("modeCurrent",!1);const fr="(prefers-reduced-motion: reduce)";const gr=er(window.matchMedia(fr).matches,(t=>{{const e=e=>{t(e.matches)},r=window.matchMedia(fr);return r.addEventListener("change",e),()=>{r.removeEventListener("change",e)}}}));function mr(t,e){let r,a;function n(t){t.shiftKey&&"Tab"===t.code&&(t.preventDefault(),a.focus())}function o(t){t.shiftKey||"Tab"!==t.code||(t.preventDefault(),r.focus())}const i=i=>{if(!1===e)return;const s=(t=>t.filter((t=>t.tabIndex>=0)).sort(((t,e)=>0===t.tabIndex&&e.tabIndex>0?1:t.tabIndex>0&&0===e.tabIndex?-1:t.tabIndex-e.tabIndex)))(Array.from(t.querySelectorAll('a[href]:not([tabindex="-1"]), button:not([tabindex="-1"]), input:not([tabindex="-1"]), textarea:not([tabindex="-1"]), select:not([tabindex="-1"]), details:not([tabindex="-1"]), [tabindex]:not([tabindex="-1"])')));s.length&&(r=s[0],a=s[s.length-1],i||(e=>{const r=[...t.querySelectorAll("[data-focusindex]")];return r&&0!==r.length&&r.sort(((t,e)=>+t.dataset.focusindex-+e.dataset.focusindex))[0]||e})(r).focus(),r.addEventListener("keydown",n),a.addEventListener("keydown",o))};function s(){r&&r.removeEventListener("keydown",n),a&&a.removeEventListener("keydown",o)}i(!1);const l=new MutationObserver(((t,e)=>(t.length&&(s(),i(!0)),e)));return l.observe(t,{childList:!0,subtree:!0}),{update(t){e=t,t?i(!1):s()},destroy(){s(),l.disconnect()}}}function wr(t){const e=t-1;return e*e*e+1}function br(t,{delay:e=0,duration:r=400,easing:a=Z}={}){const n=+getComputedStyle(t).opacity;return{delay:e,duration:r,easing:a,css:t=>"opacity: "+t*n}}function vr(t,{delay:e=0,duration:r=400,easing:a=wr,x:n=0,y:o=0,opacity:i=0}={}){const s=getComputedStyle(t),l=+s.opacity,c="none"===s.transform?"":s.transform,d=l*(1-i),[u,p]=yt(n),[h,f]=yt(o);return{delay:e,duration:r,easing:a,css:(t,e)=>`\n\t\t\ttransform: ${c} translate(${(1-t)*u}${p}, ${(1-t)*h}${f});\n\t\t\topacity: ${l-d*e}`}}function yr(t,{delay:e=0,duration:r=400,easing:a=wr,axis:n="y"}={}){const o=getComputedStyle(t),i=+o.opacity,s="y"===n?"height":"width",l=parseFloat(o[s]),c="y"===n?["top","bottom"]:["left","right"],d=c.map((t=>`${t[0].toUpperCase()}${t.slice(1)}`)),u=parseFloat(o[`padding${d[0]}`]),p=parseFloat(o[`padding${d[1]}`]),h=parseFloat(o[`margin${d[0]}`]),f=parseFloat(o[`margin${d[1]}`]),g=parseFloat(o[`border${d[0]}Width`]),m=parseFloat(o[`border${d[1]}Width`]);return{delay:e,duration:r,easing:a,css:t=>`overflow: hidden;opacity: ${Math.min(20*t,1)*i};${s}: ${t*l}px;padding-${c[0]}: ${t*u}px;padding-${c[1]}: ${t*p}px;margin-${c[0]}: ${t*h}px;margin-${c[1]}: ${t*f}px;border-${c[0]}-width: ${t*g}px;border-${c[1]}-width: ${t*m}px;`}}function xr(t,{delay:e=0,duration:r=400,easing:a=wr,start:n=0,opacity:o=0}={}){const i=getComputedStyle(t),s=+i.opacity,l="none"===i.transform?"":i.transform,c=1-n,d=s*(1-o);return{delay:e,duration:r,easing:a,css:(t,e)=>`\n\t\t\ttransform: ${l} scale(${1-c*e});\n\t\t\topacity: ${s-d*e}\n\t\t`}}function kr(t,e){const{transition:r,params:a,enabled:n}=e;return n?r(t,a):"duration"in a?r(t,{duration:0}):{duration:0}}const $r=t=>({}),Cr=t=>({}),Ar=t=>({}),Er=t=>({}),_r=t=>({}),Sr=t=>({});function Pr(t){let e,r,a;const n=t[22].lead,o=dt(n,t,t[21],Sr);return{c(){e=Lt("div"),o&&o.c(),Nt(e,"class",r="app-bar-slot-lead "+t[4])},m(t,r){It(t,e,r),o&&o.m(e,null),a=!0},p(t,i){o&&o.p&&(!a||2097152&i)&&ht(o,n,t,t[21],a?pt(n,t[21],i,_r):ft(t[21]),Sr),(!a||16&i&&r!==(r="app-bar-slot-lead "+t[4]))&&Nt(e,"class",r)},i(t){a||(De(o,t),a=!0)},o(t){ze(o,t),a=!1},d(t){t&&Tt(e),o&&o.d(t)}}}function Ir(t){let e,r,a;const n=t[22].trail,o=dt(n,t,t[21],Er);return{c(){e=Lt("div"),o&&o.c(),Nt(e,"class",r="app-bar-slot-trail "+t[2])},m(t,r){It(t,e,r),o&&o.m(e,null),a=!0},p(t,i){o&&o.p&&(!a||2097152&i)&&ht(o,n,t,t[21],a?pt(n,t[21],i,Ar):ft(t[21]),Er),(!a||4&i&&r!==(r="app-bar-slot-trail "+t[2]))&&Nt(e,"class",r)},i(t){a||(De(o,t),a=!0)},o(t){ze(o,t),a=!1},d(t){t&&Tt(e),o&&o.d(t)}}}function Tr(t){let e,r,a;const n=t[22].headline,o=dt(n,t,t[21],Cr);return{c(){e=Lt("div"),o&&o.c(),Nt(e,"class",r="app-bar-row-headline "+t[5])},m(t,r){It(t,e,r),o&&o.m(e,null),a=!0},p(t,i){o&&o.p&&(!a||2097152&i)&&ht(o,n,t,t[21],a?pt(n,t[21],i,$r):ft(t[21]),Cr),(!a||32&i&&r!==(r="app-bar-row-headline "+t[5]))&&Nt(e,"class",r)},i(t){a||(De(o,t),a=!0)},o(t){ze(o,t),a=!1},d(t){t&&Tt(e),o&&o.d(t)}}}function Br(t){let e,r,a,n,o,i,s,l,c,d,u=t[8].lead&&Pr(t);const p=t[22].default,h=dt(p,t,t[21],null);let f=t[8].trail&&Ir(t),g=t[8].headline&&Tr(t);return{c(){e=Lt("div"),r=Lt("div"),u&&u.c(),a=zt(),n=Lt("div"),h&&h.c(),i=zt(),f&&f.c(),l=zt(),g&&g.c(),Nt(n,"class",o="app-bar-slot-default "+t[3]),Nt(r,"class",s="app-bar-row-main "+t[6]),Nt(e,"class",c="app-bar "+t[7]),Nt(e,"data-testid","app-bar"),Nt(e,"role","toolbar"),Nt(e,"aria-label",t[0]),Nt(e,"aria-labelledby",t[1])},m(t,o){It(t,e,o),_t(e,r),u&&u.m(r,null),_t(r,a),_t(r,n),h&&h.m(n,null),_t(r,i),f&&f.m(r,null),_t(e,l),g&&g.m(e,null),d=!0},p(t,[i]){t[8].lead?u?(u.p(t,i),256&i&&De(u,1)):(u=Pr(t),u.c(),De(u,1),u.m(r,a)):u&&(Le(),ze(u,1,1,(()=>{u=null})),Me()),h&&h.p&&(!d||2097152&i)&&ht(h,p,t,t[21],d?pt(p,t[21],i,null):ft(t[21]),null),(!d||8&i&&o!==(o="app-bar-slot-default "+t[3]))&&Nt(n,"class",o),t[8].trail?f?(f.p(t,i),256&i&&De(f,1)):(f=Ir(t),f.c(),De(f,1),f.m(r,null)):f&&(Le(),ze(f,1,1,(()=>{f=null})),Me()),(!d||64&i&&s!==(s="app-bar-row-main "+t[6]))&&Nt(r,"class",s),t[8].headline?g?(g.p(t,i),256&i&&De(g,1)):(g=Tr(t),g.c(),De(g,1),g.m(e,null)):g&&(Le(),ze(g,1,1,(()=>{g=null})),Me()),(!d||128&i&&c!==(c="app-bar "+t[7]))&&Nt(e,"class",c),(!d||1&i)&&Nt(e,"aria-label",t[0]),(!d||2&i)&&Nt(e,"aria-labelledby",t[1])},i(t){d||(De(u),De(h,t),De(f),De(g),d=!0)},o(t){ze(u),ze(h,t),ze(f),ze(g),d=!1},d(t){t&&Tt(e),u&&u.d(),h&&h.d(t),f&&f.d(),g&&g.d()}}}function Lr(t,e,r){let a,n,o,i,s,l,{$$slots:c={},$$scope:d}=e;const u=wt(c);let{background:p="bg-surface-100-800-token"}=e,{border:h=""}=e,{padding:f="p-4"}=e,{shadow:g=""}=e,{spacing:m="space-y-4"}=e,{gridColumns:w="grid-cols-[auto_1fr_auto]"}=e,{gap:b="gap-4"}=e,{regionRowMain:v=""}=e,{regionRowHeadline:y=""}=e,{slotLead:x=""}=e,{slotDefault:k=""}=e,{slotTrail:$=""}=e,{label:C=""}=e,{labelledby:A=""}=e;return t.$$set=t=>{r(23,e=K(K({},e),gt(t))),"background"in t&&r(9,p=t.background),"border"in t&&r(10,h=t.border),"padding"in t&&r(11,f=t.padding),"shadow"in t&&r(12,g=t.shadow),"spacing"in t&&r(13,m=t.spacing),"gridColumns"in t&&r(14,w=t.gridColumns),"gap"in t&&r(15,b=t.gap),"regionRowMain"in t&&r(16,v=t.regionRowMain),"regionRowHeadline"in t&&r(17,y=t.regionRowHeadline),"slotLead"in t&&r(18,x=t.slotLead),"slotDefault"in t&&r(19,k=t.slotDefault),"slotTrail"in t&&r(20,$=t.slotTrail),"label"in t&&r(0,C=t.label),"labelledby"in t&&r(1,A=t.labelledby),"$$scope"in t&&r(21,d=t.$$scope)},t.$$.update=()=>{r(7,a=`flex flex-col ${p} ${h} ${m} ${f} ${g} ${e.class??""}`),114688&t.$$.dirty&&r(6,n=`grid items-center ${w} ${b} ${v}`),131072&t.$$.dirty&&r(5,o=` ${y}`),262144&t.$$.dirty&&r(4,i=`flex-none flex justify-between items-center ${x}`),524288&t.$$.dirty&&r(3,s=`flex-auto ${k}`),1048576&t.$$.dirty&&r(2,l=`flex-none flex items-center space-x-4 ${$}`)},e=gt(e),[C,A,l,s,i,o,n,a,u,p,h,f,g,m,w,b,v,y,x,k,$,d,c]}class Mr extends Ke{constructor(t){super(),Je(this,t,Lr,Br,nt,{background:9,border:10,padding:11,shadow:12,spacing:13,gridColumns:14,gap:15,regionRowMain:16,regionRowHeadline:17,slotLead:18,slotDefault:19,slotTrail:20,label:0,labelledby:1})}}function Dr(t){let e,r,a,n,o,i,s,l,c,d,u,p=[{type:"file"},{name:t[2]},t[6]()],h={};for(let t=0;t<p.length;t+=1)h=K(h,p[t]);const f=t[11].default,g=dt(f,t,t[10],null),m=g||function(){let t;return{c(){t=Dt("Select a File")},m(e,r){It(e,t,r)},d(e){e&&Tt(t)}}}();return{c(){e=Lt("div"),r=Lt("div"),a=Lt("input"),n=zt(),o=Lt("button"),m&&m.c(),Rt(a,h),Nt(r,"class","w-0 h-0 overflow-hidden"),Nt(o,"type","button"),Nt(o,"class",i="file-button-btn "+t[3]),o.disabled=s=t[7].disabled,Nt(e,"class",l="file-button "+t[4]),Nt(e,"data-testid","file-button")},m(i,s){It(i,e,s),_t(e,r),_t(r,a),a.autofocus&&a.focus(),t[16](a),_t(e,n),_t(e,o),m&&m.m(o,null),c=!0,d||(u=[Ot(a,"change",t[17]),Ot(a,"change",t[15]),Ot(o,"click",t[5]),Ot(o,"keydown",t[12]),Ot(o,"keyup",t[13]),Ot(o,"keypress",t[14])],d=!0)},p(t,[r]){Rt(a,h=We(p,[{type:"file"},(!c||4&r)&&{name:t[2]},t[6]()])),g&&g.p&&(!c||1024&r)&&ht(g,f,t,t[10],c?pt(f,t[10],r,null):ft(t[10]),null),(!c||8&r&&i!==(i="file-button-btn "+t[3]))&&Nt(o,"class",i),(!c||128&r&&s!==(s=t[7].disabled))&&(o.disabled=s),(!c||16&r&&l!==(l="file-button "+t[4]))&&Nt(e,"class",l)},i(t){c||(De(m,t),c=!0)},o(t){ze(m,t),c=!1},d(r){r&&Tt(e),t[16](null),m&&m.d(r),d=!1,rt(u)}}}function zr(t,e,r){let a,n;const o=["files","fileInput","name","width","button"];let i=mt(e,o),{$$slots:s={},$$scope:l}=e,{files:c}=e,{fileInput:d}=e,{name:u}=e,{width:p=""}=e,{button:h="btn variant-filled"}=e;return t.$$set=t=>{r(18,e=K(K({},e),gt(t))),r(7,i=mt(e,o)),"files"in t&&r(0,c=t.files),"fileInput"in t&&r(1,d=t.fileInput),"name"in t&&r(2,u=t.name),"width"in t&&r(8,p=t.width),"button"in t&&r(9,h=t.button),"$$scope"in t&&r(10,l=t.$$scope)},t.$$.update=()=>{r(4,a=`${e.class??""}`),768&t.$$.dirty&&r(3,n=`${h} ${p}`)},e=gt(e),[c,d,u,n,a,function(){d&&d.click()},function(){return delete i.class,i},i,p,h,l,s,function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(t){ge[t?"unshift":"push"]((()=>{d=t,r(1,d)}))},function(){c=this.files,r(0,c)}]}class Fr extends Ke{constructor(t){super(),Je(this,t,zr,Dr,nt,{files:0,fileInput:1,name:2,width:8,button:9})}}function Or(t,{from:e,to:r},a={}){const n=getComputedStyle(t),o="none"===n.transform?"":n.transform,[i,s]=n.transformOrigin.split(" ").map(parseFloat),l=e.left+e.width*i/r.width-(r.left+i),c=e.top+e.height*s/r.height-(r.top+s),{delay:d=0,duration:u=t=>120*Math.sqrt(t),easing:p=wr}=a;return{delay:d,duration:at(u)?u(Math.sqrt(l*l+c*c)):u,easing:p,css:(t,a)=>{const n=a*l,i=a*c,s=t+a*e.width/r.width,d=t+a*e.height/r.height;return`transform: ${o} translate(${n}px, ${i}px) scale(${s}, ${d});`}}}function Nr(t,e,r){const a=t.slice();return a[65]=e[r].id,a[66]=e[r].val,a[68]=r,a}function jr(t,e,r){const a=t.slice();return a[69]=e[r],a}function Rr(t){let e,r,a,n=t[69]+"";return{c(){e=Lt("option"),r=Dt(n),e.__value=a=t[69],qt(e,e.__value)},m(t,a){It(t,e,a),_t(e,r)},p(t,o){1&o[0]&&n!==(n=t[69]+"")&&Wt(r,n),1&o[0]&&a!==(a=t[69])&&(e.__value=a,qt(e,e.__value))},d(t){t&&Tt(e)}}}function Hr(t){let e,r,a,n,o,i=[],s=new Map,l=He(t[16]);const c=t=>t[65];for(let e=0;e<l.length;e+=1){let r=Nr(t,l,e),a=c(r);s.set(a,i[e]=Ur(a,r))}return{c(){e=Lt("div");for(let t=0;t<i.length;t+=1)i[t].c();Nt(e,"class",r="input-chip-list "+t[19])},m(t,r){It(t,e,r);for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(e,null);o=!0},p(a,n){if(t=a,8503456&n[0]){l=He(t[16]),Le();for(let t=0;t<i.length;t+=1)i[t].r();i=function(t,e,r,a,n,o,i,s,l,c,d,u){let p=t.length,h=o.length,f=p;const g={};for(;f--;)g[t[f].key]=f;const m=[],w=new Map,b=new Map,v=[];for(f=h;f--;){const t=u(n,o,f),a=r(t);let s=i.get(a);s?v.push((()=>s.p(t,e))):(s=c(a,t),s.c()),w.set(a,m[f]=s),a in g&&b.set(a,Math.abs(f-g[a]))}const y=new Set,x=new Set;function k(t){De(t,1),t.m(s,d),i.set(t.key,t),d=t.first,h--}for(;p&&h;){const e=m[h-1],r=t[p-1],a=e.key,n=r.key;e===r?(d=e.first,p--,h--):w.has(n)?!i.has(a)||y.has(a)?k(e):x.has(n)?p--:b.get(a)>b.get(n)?(x.add(a),k(e)):(y.add(n),p--):(l(r,i),p--)}for(;p--;){const e=t[p];w.has(e.key)||l(e,i)}for(;h;)k(m[h-1]);return rt(v),m}(i,n,c,0,t,l,s,e,Ue,Ur,null,Nr);for(let t=0;t<i.length;t+=1)i[t].a();Me()}(!o||524288&n[0]&&r!==(r="input-chip-list "+t[19]))&&Nt(e,"class",r)},i(r){if(!o){for(let t=0;t<l.length;t+=1)De(i[t]);r&&ke((()=>{o&&(n&&n.end(1),a=Oe(e,kr,{transition:t[8],params:t[9],enabled:t[7]}),a.start())})),o=!0}},o(r){for(let t=0;t<i.length;t+=1)ze(i[t]);a&&a.invalidate(),r&&(n=Ne(e,kr,{transition:t[10],params:t[11],enabled:t[7]})),o=!1},d(t){t&&Tt(e);for(let t=0;t<i.length;t+=1)i[t].d();t&&n&&n.end()}}}function Ur(t,e){let r,a,n,o,i,s,l,c,d,u,p,h,f,g,m=e[66]+"",w=X;function b(...t){return e[52](e[68],e[66],...t)}return{key:t,first:null,c(){r=Lt("div"),a=Lt("button"),n=Lt("span"),o=Dt(m),i=zt(),s=Lt("span"),s.textContent="✕",u=zt(),Nt(a,"type","button"),Nt(a,"class",l="chip "+e[5]),this.first=r},m(t,l){It(t,r,l),_t(r,a),_t(a,n),_t(n,o),_t(a,i),_t(a,s),_t(r,u),h=!0,f||(g=[Ot(a,"click",b),Ot(a,"click",e[42]),Ot(a,"keypress",e[43]),Ot(a,"keydown",e[44]),Ot(a,"keyup",e[45])],f=!0)},p(t,r){e=t,(!h||65536&r[0])&&m!==(m=e[66]+"")&&Wt(o,m),(!h||32&r[0]&&l!==(l="chip "+e[5]))&&Nt(a,"class",l)},r(){p=r.getBoundingClientRect()},f(){oe(r),w()},a(){w(),w=function(t,e,r,a){if(!e)return X;const n=t.getBoundingClientRect();if(e.left===n.left&&e.right===n.right&&e.top===n.top&&e.bottom===n.bottom)return X;const{delay:o=0,duration:i=300,easing:s=Z,start:l=kt()+o,end:c=l+i,tick:d=X,css:u}=r(t,{from:e,to:n},a);let p,h=!0,f=!1;function g(){u&&ne(t,p),h=!1}return Et((t=>{if(!f&&t>=l&&(f=!0),f&&t>=c&&(d(1,0),g()),!h)return!1;if(f){const e=0+1*s((t-l)/i);d(e,1-e)}return!0})),u&&(p=ae(t,0,1,i,o,s,u)),o||(f=!0),d(0,1),g}(r,p,Or,{duration:e[3]})},i(t){h||(t&&ke((()=>{h&&(d&&d.end(1),c=Oe(a,kr,{transition:e[12],params:e[13],enabled:e[7]}),c.start())})),h=!0)},o(t){c&&c.invalidate(),t&&(d=Ne(a,kr,{transition:e[14],params:e[15],enabled:e[7]})),h=!1},d(t){t&&Tt(r),t&&d&&d.end(),f=!1,rt(g)}}}function Wr(t){let e,r,a,n,o,i,s,l,c,d,u,p,h,f,g,m=He(t[0]),w=[];for(let e=0;e<m.length;e+=1)w[e]=Rr(jr(t,m,e));let b=t[16].length&&Hr(t);return{c(){e=Lt("div"),r=Lt("div"),a=Lt("select");for(let t=0;t<w.length;t+=1)w[t].c();n=zt(),o=Lt("div"),i=Lt("input"),d=zt(),b&&b.c(),Nt(a,"name",t[2]),a.multiple=!0,a.required=t[4],Nt(a,"aria-label",t[6]),Nt(a,"tabindex","-1"),void 0===t[0]&&ke((()=>t[50].call(a))),Nt(r,"class","h-0 overflow-hidden"),Nt(i,"type","text"),Nt(i,"placeholder",s=t[24].placeholder??"Enter values..."),Nt(i,"class",l="input-chip-field "+t[18]),i.disabled=c=t[24].disabled,Nt(o,"class",u="input-chip-wrapper "+t[20]),Nt(e,"class",p="input-chip "+t[21]),Jt(e,"opacity-50",t[24].disabled)},m(s,l){It(s,e,l),_t(e,r),_t(r,a);for(let t=0;t<w.length;t+=1)w[t]&&w[t].m(a,null);t[49](a),Vt(a,t[0]),_t(e,n),_t(e,o),_t(o,i),qt(i,t[1]),_t(o,d),b&&b.m(o,null),h=!0,f||(g=[Ot(a,"change",t[50]),Ot(i,"input",t[51]),Ot(i,"keydown",t[22]),Ot(i,"input",t[46]),Ot(i,"focus",t[47]),Ot(i,"blur",t[48])],f=!0)},p(t,r){if(1&r[0]){let e;for(m=He(t[0]),e=0;e<m.length;e+=1){const n=jr(t,m,e);w[e]?w[e].p(n,r):(w[e]=Rr(n),w[e].c(),w[e].m(a,null))}for(;e<w.length;e+=1)w[e].d(1);w.length=m.length}(!h||4&r[0])&&Nt(a,"name",t[2]),(!h||16&r[0])&&(a.required=t[4]),(!h||64&r[0])&&Nt(a,"aria-label",t[6]),1&r[0]&&Vt(a,t[0]),(!h||16777216&r[0]&&s!==(s=t[24].placeholder??"Enter values..."))&&Nt(i,"placeholder",s),(!h||262144&r[0]&&l!==(l="input-chip-field "+t[18]))&&Nt(i,"class",l),(!h||16777216&r[0]&&c!==(c=t[24].disabled))&&(i.disabled=c),2&r[0]&&i.value!==t[1]&&qt(i,t[1]),t[16].length?b?(b.p(t,r),65536&r[0]&&De(b,1)):(b=Hr(t),b.c(),De(b,1),b.m(o,null)):b&&(Le(),ze(b,1,1,(()=>{b=null})),Me()),(!h||1048576&r[0]&&u!==(u="input-chip-wrapper "+t[20]))&&Nt(o,"class",u),(!h||2097152&r[0]&&p!==(p="input-chip "+t[21]))&&Nt(e,"class",p),(!h||18874368&r[0])&&Jt(e,"opacity-50",t[24].disabled)},i(t){h||(De(b),h=!0)},o(t){ze(b),h=!1},d(r){r&&Tt(e),Bt(w,r),t[49](null),b&&b.d(),f=!1,rt(g)}}}function qr(t,e,r){let a,n,o,i,s;const l=["input","name","value","whitelist","max","minlength","maxlength","allowUpperCase","allowDuplicates","validation","duration","required","chips","invalid","padding","rounded","regionChipWrapper","regionChipList","regionInput","label","transitions","listTransitionIn","listTransitionInParams","listTransitionOut","listTransitionOutParams","chipTransitionIn","chipTransitionInParams","chipTransitionOut","chipTransitionOutParams","addChip","removeChip"];let c,d=mt(e,l);ct(t,gr,(t=>r(53,c=t)));const u=de();let p,{input:h=""}=e,{name:f}=e,{value:g=[]}=e,{whitelist:m=[]}=e,{max:w=-1}=e,{minlength:b=-1}=e,{maxlength:v=-1}=e,{allowUpperCase:y=!1}=e,{allowDuplicates:x=!1}=e,{validation:k=()=>!0}=e,{duration:$=150}=e,{required:C=!1}=e,{chips:A="variant-filled"}=e,{invalid:E="input-error"}=e,{padding:_="p-2"}=e,{rounded:S="rounded-container-token"}=e,{regionChipWrapper:P=""}=e,{regionChipList:I=""}=e,{regionInput:T=""}=e,{label:B="Chips select"}=e,{transitions:L=!c}=e,{listTransitionIn:M=vr}=e,{listTransitionInParams:D={duration:150,opacity:0,y:-20}}=e,{listTransitionOut:z=vr}=e,{listTransitionOutParams:F={duration:150,opacity:0,y:-20}}=e,{chipTransitionIn:O=xr}=e,{chipTransitionInParams:N={duration:150,opacity:0}}=e,{chipTransitionOut:j=xr}=e,{chipTransitionOutParams:R={duration:150,opacity:0}}=e,H=!0,U=(null==g?void 0:g.map((t=>({val:t,id:Math.random()}))))||[];function W(){r(0,g=[])}function q(t=""){return!(!t&&!h)&&(function(t){return void 0===k||k(t)}(t=""!==t?t.trim():h.trim())&&(-1===w||g.length<w)&&function(t){return(-1===b||t.length>=b)&&(-1===v||t.length<=v)}(t)&&function(t){return 0===m.length||m.includes(t)}(t)&&function(t){return x||!g.includes(t)}(t))}function G(t){t=y?t:t.toLowerCase(),g.push(t),r(0,g),U.push({val:t,id:Math.random()}),r(16,U),r(0,g)}function Y(t){let e=g.indexOf(t);g.splice(e,1),r(0,g),U.splice(e,1),r(16,U),r(0,g)}function V(t,e,r){d.disabled||(Y(r),u("remove",{event:t,chipIndex:e,chipValue:r}))}le((()=>{if(!p.form)return;const t=p.form;return t.addEventListener("reset",W),()=>{t.removeEventListener("reset",W)}}));return t.$$set=t=>{r(64,e=K(K({},e),gt(t))),r(24,d=mt(e,l)),"input"in t&&r(1,h=t.input),"name"in t&&r(2,f=t.name),"value"in t&&r(0,g=t.value),"whitelist"in t&&r(25,m=t.whitelist),"max"in t&&r(26,w=t.max),"minlength"in t&&r(27,b=t.minlength),"maxlength"in t&&r(28,v=t.maxlength),"allowUpperCase"in t&&r(29,y=t.allowUpperCase),"allowDuplicates"in t&&r(30,x=t.allowDuplicates),"validation"in t&&r(31,k=t.validation),"duration"in t&&r(3,$=t.duration),"required"in t&&r(4,C=t.required),"chips"in t&&r(5,A=t.chips),"invalid"in t&&r(32,E=t.invalid),"padding"in t&&r(33,_=t.padding),"rounded"in t&&r(34,S=t.rounded),"regionChipWrapper"in t&&r(35,P=t.regionChipWrapper),"regionChipList"in t&&r(36,I=t.regionChipList),"regionInput"in t&&r(37,T=t.regionInput),"label"in t&&r(6,B=t.label),"transitions"in t&&r(7,L=t.transitions),"listTransitionIn"in t&&r(8,M=t.listTransitionIn),"listTransitionInParams"in t&&r(9,D=t.listTransitionInParams),"listTransitionOut"in t&&r(10,z=t.listTransitionOut),"listTransitionOutParams"in t&&r(11,F=t.listTransitionOutParams),"chipTransitionIn"in t&&r(12,O=t.chipTransitionIn),"chipTransitionInParams"in t&&r(13,N=t.chipTransitionInParams),"chipTransitionOut"in t&&r(14,j=t.chipTransitionOut),"chipTransitionOutParams"in t&&r(15,R=t.chipTransitionOutParams)},t.$$.update=()=>{514&t.$$.dirty[1]&&r(41,a=!1===H?E:""),r(21,n=`textarea cursor-pointer ${_} ${S} ${e.class??""} ${a}`),16&t.$$.dirty[1]&&r(20,o=`space-y-4 ${P}`),32&t.$$.dirty[1]&&r(19,i=`flex flex-wrap gap-2 ${I}`),64&t.$$.dirty[1]&&r(18,s=`unstyled bg-transparent border-0 !ring-0 p-0 w-full ${T}`),65537&t.$$.dirty[0]&&r(16,U=(null==g?void 0:g.map(((t,e)=>{var r;return(null==(r=U[e])?void 0:r.val)===t?U[e]:{id:Math.random(),val:t}})))||[])},e=gt(e),[g,h,f,$,C,A,B,L,M,D,z,F,O,N,j,R,U,p,s,i,o,n,function(t){"Enter"===t.key&&(t.preventDefault(),r(40,H=q()),!1!==H?(G(h),u("add",{event:t,chipIndex:g.length-1,chipValue:h}),r(1,h="")):u("invalid",{event:t,input:h}))},V,d,m,w,b,v,y,x,k,E,_,S,P,I,T,function(t){r(40,H=q(t)),!1!==H?(G(t),u("addManually",{chipIndex:g.length-1,chipValue:t})):u("invalidManually",{input:t})},function(t){d.disabled||(Y(t),u("removeManually",{chipValue:t}))},H,a,function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(t){ge[t?"unshift":"push"]((()=>{p=t,r(17,p)}))},function(){var t;t=this,g=[].map.call(t.querySelectorAll(":checked"),(t=>t.__value)),r(0,g)},function(){h=this.value,r(1,h)},(t,e,r)=>V(r,t,e)]}class Gr extends Ke{constructor(t){super(),Je(this,t,qr,Wr,nt,{input:1,name:2,value:0,whitelist:25,max:26,minlength:27,maxlength:28,allowUpperCase:29,allowDuplicates:30,validation:31,duration:3,required:4,chips:5,invalid:32,padding:33,rounded:34,regionChipWrapper:35,regionChipList:36,regionInput:37,label:6,transitions:7,listTransitionIn:8,listTransitionInParams:9,listTransitionOut:10,listTransitionOutParams:11,chipTransitionIn:12,chipTransitionInParams:13,chipTransitionOut:14,chipTransitionOutParams:15,addChip:38,removeChip:39},null,[-1,-1,-1])}get addChip(){return this.$$.ctx[38]}get removeChip(){return this.$$.ctx[39]}}function Yr(t){let e,r,a;const n=t[13].default,o=dt(n,t,t[12],null);return{c(){e=Lt("div"),o&&o.c(),Nt(e,"class",r="listbox "+t[1]),Nt(e,"role","listbox"),Nt(e,"aria-labelledby",t[0]),Nt(e,"data-testid","listbox")},m(t,r){It(t,e,r),o&&o.m(e,null),a=!0},p(t,[i]){o&&o.p&&(!a||4096&i)&&ht(o,n,t,t[12],a?pt(n,t[12],i,null):ft(t[12]),null),(!a||2&i&&r!==(r="listbox "+t[1]))&&Nt(e,"class",r),(!a||1&i)&&Nt(e,"aria-labelledby",t[0])},i(t){a||(De(o,t),a=!0)},o(t){ze(o,t),a=!1},d(t){t&&Tt(e),o&&o.d(t)}}}function Vr(t,e,r){let a,{$$slots:n={},$$scope:o}=e,{multiple:i=!1}=e,{disabled:s=!1}=e,{spacing:l="space-y-1"}=e,{rounded:c="rounded-token"}=e,{active:d="variant-filled"}=e,{hover:u="hover:variant-soft"}=e,{padding:p="px-4 py-2"}=e,{regionLead:h=""}=e,{regionDefault:f=""}=e,{regionTrail:g=""}=e,{labelledby:m=""}=e;return ue("disabled",s),ue("multiple",i),ue("rounded",c),ue("active",d),ue("hover",u),ue("padding",p),ue("regionLead",h),ue("regionDefault",f),ue("regionTrail",g),t.$$set=t=>{r(14,e=K(K({},e),gt(t))),"multiple"in t&&r(2,i=t.multiple),"disabled"in t&&r(3,s=t.disabled),"spacing"in t&&r(4,l=t.spacing),"rounded"in t&&r(5,c=t.rounded),"active"in t&&r(6,d=t.active),"hover"in t&&r(7,u=t.hover),"padding"in t&&r(8,p=t.padding),"regionLead"in t&&r(9,h=t.regionLead),"regionDefault"in t&&r(10,f=t.regionDefault),"regionTrail"in t&&r(11,g=t.regionTrail),"labelledby"in t&&r(0,m=t.labelledby),"$$scope"in t&&r(12,o=t.$$scope)},t.$$.update=()=>{r(1,a=` ${l} ${c} ${e.class??""}`)},e=gt(e),[m,a,i,s,l,c,d,u,p,h,f,g,o,n]}class Qr extends Ke{constructor(t){super(),Je(this,t,Vr,Yr,nt,{multiple:2,disabled:3,spacing:4,rounded:5,active:6,hover:7,padding:8,regionLead:9,regionDefault:10,regionTrail:11,labelledby:0})}}const Jr=t=>({}),Xr=t=>({}),Zr=t=>({}),Kr=t=>({});function ta(t){let e,r,a,n,o=!1;return r=Ht(t[37][0]),{c(){e=Lt("input"),e.disabled=t[3],Nt(e,"type","radio"),Nt(e,"name",t[1]),e.__value=t[2],qt(e,e.__value),Nt(e,"tabindex","-1"),r.p(e)},m(r,o){It(r,e,o),t[35](e),e.checked=e.__value===t[0],a||(n=[Ot(e,"change",t[36]),Ot(e,"click",t[31]),Ot(e,"change",t[32])],a=!0)},p(t,r){8&r[0]&&(e.disabled=t[3]),2&r[0]&&Nt(e,"name",t[1]),4&r[0]&&(e.__value=t[2],qt(e,e.__value),o=!0),(o||1&r[0])&&(e.checked=e.__value===t[0])},d(o){o&&Tt(e),t[35](null),r.r(),a=!1,rt(n)}}}function ea(t){let e,r,a;return{c(){e=Lt("input"),e.disabled=t[3],Nt(e,"type","checkbox"),Nt(e,"name",t[1]),e.__value=t[2],qt(e,e.__value),Nt(e,"tabindex","-1")},m(n,o){It(n,e,o),t[33](e),e.checked=t[5],r||(a=[Ot(e,"change",t[34]),Ot(e,"click",t[29]),Ot(e,"change",t[30])],r=!0)},p(t,r){8&r[0]&&(e.disabled=t[3]),2&r[0]&&Nt(e,"name",t[1]),4&r[0]&&(e.__value=t[2],qt(e,e.__value)),32&r[0]&&(e.checked=t[5])},d(n){n&&Tt(e),t[33](null),r=!1,rt(a)}}}function ra(t){let e,r,a;const n=t[25].lead,o=dt(n,t,t[24],Kr);return{c(){e=Lt("div"),o&&o.c(),Nt(e,"class",r="listbox-label-lead "+t[10])},m(t,r){It(t,e,r),o&&o.m(e,null),a=!0},p(t,i){o&&o.p&&(!a||16777216&i[0])&&ht(o,n,t,t[24],a?pt(n,t[24],i,Zr):ft(t[24]),Kr),(!a||1024&i[0]&&r!==(r="listbox-label-lead "+t[10]))&&Nt(e,"class",r)},i(t){a||(De(o,t),a=!0)},o(t){ze(o,t),a=!1},d(t){t&&Tt(e),o&&o.d(t)}}}function aa(t){let e,r,a;const n=t[25].trail,o=dt(n,t,t[24],Xr);return{c(){e=Lt("div"),o&&o.c(),Nt(e,"class",r="listbox-label-trail "+t[8])},m(t,r){It(t,e,r),o&&o.m(e,null),a=!0},p(t,i){o&&o.p&&(!a||16777216&i[0])&&ht(o,n,t,t[24],a?pt(n,t[24],i,Jr):ft(t[24]),Xr),(!a||256&i[0]&&r!==(r="listbox-label-trail "+t[8]))&&Nt(e,"class",r)},i(t){a||(De(o,t),a=!0)},o(t){ze(o,t),a=!1},d(t){t&&Tt(e),o&&o.d(t)}}}function na(t){let e,r,a,n,o,i,s,l,c,d,u,p,h,f;function g(t,e){return t[4]?ea:ta}let m=g(t),w=m(t),b=t[14].lead&&ra(t);const v=t[25].default,y=dt(v,t,t[24],null);let x=t[14].trail&&aa(t);return{c(){e=Lt("label"),r=Lt("div"),a=Lt("div"),w.c(),n=zt(),o=Lt("div"),b&&b.c(),i=zt(),s=Lt("div"),y&&y.c(),c=zt(),x&&x.c(),Nt(a,"class","h-0 w-0 overflow-hidden"),Nt(s,"class",l="listbox-label-content "+t[9]),Nt(o,"class",d="listbox-label "+t[11]),Nt(r,"class",u="listbox-item "+t[12]),Nt(r,"data-testid","listbox-item"),Nt(r,"role","option"),Nt(r,"aria-selected",t[6]),Nt(r,"tabindex","0")},m(l,d){It(l,e,d),_t(e,r),_t(r,a),w.m(a,null),_t(r,n),_t(r,o),b&&b.m(o,null),_t(o,i),_t(o,s),y&&y.m(s,null),_t(o,c),x&&x.m(o,null),p=!0,h||(f=[Ot(r,"keydown",t[13]),Ot(r,"keydown",t[26]),Ot(r,"keyup",t[27]),Ot(r,"keypress",t[28])],h=!0)},p(t,e){m===(m=g(t))&&w?w.p(t,e):(w.d(1),w=m(t),w&&(w.c(),w.m(a,null))),t[14].lead?b?(b.p(t,e),16384&e[0]&&De(b,1)):(b=ra(t),b.c(),De(b,1),b.m(o,i)):b&&(Le(),ze(b,1,1,(()=>{b=null})),Me()),y&&y.p&&(!p||16777216&e[0])&&ht(y,v,t,t[24],p?pt(v,t[24],e,null):ft(t[24]),null),(!p||512&e[0]&&l!==(l="listbox-label-content "+t[9]))&&Nt(s,"class",l),t[14].trail?x?(x.p(t,e),16384&e[0]&&De(x,1)):(x=aa(t),x.c(),De(x,1),x.m(o,null)):x&&(Le(),ze(x,1,1,(()=>{x=null})),Me()),(!p||2048&e[0]&&d!==(d="listbox-label "+t[11]))&&Nt(o,"class",d),(!p||4096&e[0]&&u!==(u="listbox-item "+t[12]))&&Nt(r,"class",u),(!p||64&e[0])&&Nt(r,"aria-selected",t[6])},i(t){p||(De(b),De(y,t),De(x),p=!0)},o(t){ze(b),ze(y,t),ze(x),p=!1},d(t){t&&Tt(e),w.d(),b&&b.d(),y&&y.d(t),x&&x.d(),h=!1,rt(f)}}}function oa(t,e){if(t===e)return!0;if(!(t instanceof Object&&e instanceof Object))return!1;const r=Object.keys(t),a=Object.keys(e);if(r.length!==a.length)return!1;for(const a of r){if(!oa(t[a],e[a]))return!1}return!0}function ia(t,e,r){let a,n,o,i,s,l,c,d,{$$slots:u={},$$scope:p}=e;const h=wt(u);let f,g,{group:m}=e,{name:w}=e,{value:b}=e,{disabled:v=pe("disabled")}=e,{multiple:y=pe("multiple")}=e,{rounded:x=pe("rounded")}=e,{active:k=pe("active")}=e,{hover:$=pe("hover")}=e,{padding:C=pe("padding")}=e,{regionLead:A=pe("regionLead")}=e,{regionDefault:E=pe("regionDefault")}=e,{regionTrail:_=pe("regionTrail")}=e;return t.$$set=t=>{r(40,e=K(K({},e),gt(t))),"group"in t&&r(0,m=t.group),"name"in t&&r(1,w=t.name),"value"in t&&r(2,b=t.value),"disabled"in t&&r(3,v=t.disabled),"multiple"in t&&r(4,y=t.multiple),"rounded"in t&&r(15,x=t.rounded),"active"in t&&r(16,k=t.active),"hover"in t&&r(17,$=t.hover),"padding"in t&&r(18,C=t.padding),"regionLead"in t&&r(19,A=t.regionLead),"regionDefault"in t&&r(20,E=t.regionDefault),"regionTrail"in t&&r(21,_=t.regionTrail),"$$scope"in t&&r(24,p=t.$$scope)},t.$$.update=()=>{17&t.$$.dirty[0]&&y&&r(5,f=m.indexOf(b)>=0),48&t.$$.dirty[0]&&y&&function(t){const e=m.indexOf(b);t?e<0&&(m.push(b),r(0,m)):e>=0&&(m.splice(e,1),r(0,m))}(f),21&t.$$.dirty[0]&&r(6,a=y?m.some((t=>oa(b,t))):oa(m,b)),196680&t.$$.dirty[0]&&r(22,n=a?k:v?"":$),8&t.$$.dirty[0]&&r(23,o=v?"opacity-50 !cursor-default":""),r(12,i=`cursor-pointer -outline-offset-[3px] ${o} ${x} ${C} ${n} ${e.class??""}`),524288&t.$$.dirty[0]&&r(10,l=` ${A}`),1048576&t.$$.dirty[0]&&r(9,c=`flex-1 ${E}`),2097152&t.$$.dirty[0]&&r(8,d=` ${_}`)},r(11,s="flex items-center space-x-4"),e=gt(e),[m,w,b,v,y,f,a,g,d,c,l,"flex items-center space-x-4",i,function(t){["Enter","Space"].includes(t.code)&&(t.preventDefault(),g.click())},h,x,k,$,C,A,E,_,n,o,p,u,function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(t){ge[t?"unshift":"push"]((()=>{g=t,r(7,g)}))},function(){f=this.checked,r(5,f)},function(t){ge[t?"unshift":"push"]((()=>{g=t,r(7,g)}))},function(){m=this.__value,r(0,m)},[[]]]}class sa extends Ke{constructor(t){super(),Je(this,t,ia,na,nt,{group:0,name:1,value:2,disabled:3,multiple:4,rounded:15,active:16,hover:17,padding:18,regionLead:19,regionDefault:20,regionTrail:21},null,[-1,-1])}}function la(t){let e,r,a,n,o,i=`${t[4]?100:t[7]}%`;return{c(){e=Lt("div"),r=Lt("div"),Nt(r,"class",a="progress-bar-meter "+t[5]+" svelte-12wvf64"),Gt(r,"width",i),Nt(e,"class",n="progress-bar "+t[6]+" svelte-12wvf64"),Nt(e,"data-testid","progress-bar"),Nt(e,"role","progressbar"),Nt(e,"aria-labelledby",t[3]),Nt(e,"aria-valuenow",t[0]),Nt(e,"aria-valuemin",t[1]),Nt(e,"aria-valuemax",o=t[2]-t[1])},m(t,a){It(t,e,a),_t(e,r)},p(t,[s]){32&s&&a!==(a="progress-bar-meter "+t[5]+" svelte-12wvf64")&&Nt(r,"class",a),144&s&&i!==(i=`${t[4]?100:t[7]}%`)&&Gt(r,"width",i),64&s&&n!==(n="progress-bar "+t[6]+" svelte-12wvf64")&&Nt(e,"class",n),8&s&&Nt(e,"aria-labelledby",t[3]),1&s&&Nt(e,"aria-valuenow",t[0]),2&s&&Nt(e,"aria-valuemin",t[1]),6&s&&o!==(o=t[2]-t[1])&&Nt(e,"aria-valuemax",o)},i:X,o:X,d(t){t&&Tt(e)}}}function ca(t,e,r){let a,n,o,i,s,{value:l}=e,{min:c=0}=e,{max:d=100}=e,{height:u="h-2"}=e,{rounded:p="rounded-token"}=e,{transition:h="transition-[width]"}=e,{animIndeterminate:f="anim-indeterminate"}=e,{meter:g="bg-surface-900-50-token"}=e,{track:m="bg-surface-200-700-token"}=e,{labelledby:w=""}=e;return t.$$set=t=>{r(15,e=K(K({},e),gt(t))),"value"in t&&r(0,l=t.value),"min"in t&&r(1,c=t.min),"max"in t&&r(2,d=t.max),"height"in t&&r(8,u=t.height),"rounded"in t&&r(9,p=t.rounded),"transition"in t&&r(10,h=t.transition),"animIndeterminate"in t&&r(11,f=t.animIndeterminate),"meter"in t&&r(12,g=t.meter),"track"in t&&r(13,m=t.track),"labelledby"in t&&r(3,w=t.labelledby)},t.$$.update=()=>{7&t.$$.dirty&&r(7,a=l?100*(l-c)/(d-c):0),1&t.$$.dirty&&r(4,n=void 0===l||l<0),2064&t.$$.dirty&&r(14,o=n?f:""),r(6,i=`w-full overflow-hidden ${m} ${u} ${p} ${e.class??""}`),22016&t.$$.dirty&&r(5,s=`h-full ${g} ${p} ${o} ${h}`)},e=gt(e),[l,c,d,w,n,s,i,a,u,p,h,f,g,m,o]}class da extends Ke{constructor(t){super(),Je(this,t,ca,la,nt,{value:0,min:1,max:2,height:8,rounded:9,transition:10,animIndeterminate:11,meter:12,track:13,labelledby:3})}}function ua(t){let e,r,a;const n=t[16].default,o=dt(n,t,t[15],null);return{c(){e=Mt("text"),o&&o.c(),Nt(e,"x","50%"),Nt(e,"y","50%"),Nt(e,"text-anchor","middle"),Nt(e,"dominant-baseline","middle"),Nt(e,"font-weight","bold"),Nt(e,"font-size",t[2]),Nt(e,"class",r="progress-radial-text "+t[7])},m(t,r){It(t,e,r),o&&o.m(e,null),a=!0},p(t,i){o&&o.p&&(!a||32768&i)&&ht(o,n,t,t[15],a?pt(n,t[15],i,null):ft(t[15]),null),(!a||4&i)&&Nt(e,"font-size",t[2]),(!a||128&i&&r!==(r="progress-radial-text "+t[7]))&&Nt(e,"class",r)},i(t){a||(De(o,t),a=!0)},o(t){ze(o,t),a=!1},d(t){t&&Tt(e),o&&o.d(t)}}}function pa(t){let e,r,a,n,o,i,s,l,c,d,u=`${t[9]}\n\t\t\t${t[9]}`,p=null!=t[0]&&t[0]>=0&&t[13].default&&ua(t);return{c(){e=Lt("figure"),r=Mt("svg"),a=Mt("circle"),o=Mt("circle"),p&&p.c(),Nt(a,"class",n="progress-radial-track "+ha+" "+t[6]),Nt(a,"stroke-width",t[1]),Nt(a,"r",t[12]),Nt(a,"cx","50%"),Nt(a,"cy","50%"),Nt(o,"class",i="progress-radial-meter "+fa+" "+t[5]+" "+t[4]),Nt(o,"stroke-width",t[1]),Nt(o,"r",t[12]),Nt(o,"cx","50%"),Nt(o,"cy","50%"),Nt(o,"stroke-linecap",t[3]),Gt(o,"stroke-dasharray",u),Gt(o,"stroke-dashoffset",t[10]),Nt(r,"viewBox","0 0 "+ga+" "+ga),Nt(r,"class","rounded-full"),Jt(r,"animate-spin",void 0===t[0]),Nt(e,"class",s="progress-radial "+t[11]),Nt(e,"data-testid","progress-radial"),Nt(e,"role","meter"),Nt(e,"aria-labelledby",t[8]),Nt(e,"aria-valuenow",l=t[0]||0),Nt(e,"aria-valuetext",c=t[0]?`${t[0]}%`:"Indeterminate Spinner"),Nt(e,"aria-valuemin",0),Nt(e,"aria-valuemax",100)},m(t,n){It(t,e,n),_t(e,r),_t(r,a),_t(r,o),p&&p.m(r,null),d=!0},p(t,[h]){(!d||64&h&&n!==(n="progress-radial-track "+ha+" "+t[6]))&&Nt(a,"class",n),(!d||2&h)&&Nt(a,"stroke-width",t[1]),(!d||48&h&&i!==(i="progress-radial-meter "+fa+" "+t[5]+" "+t[4]))&&Nt(o,"class",i),(!d||2&h)&&Nt(o,"stroke-width",t[1]),(!d||8&h)&&Nt(o,"stroke-linecap",t[3]),512&h&&u!==(u=`${t[9]}\n\t\t\t${t[9]}`)&&Gt(o,"stroke-dasharray",u),1024&h&&Gt(o,"stroke-dashoffset",t[10]),null!=t[0]&&t[0]>=0&&t[13].default?p?(p.p(t,h),8193&h&&De(p,1)):(p=ua(t),p.c(),De(p,1),p.m(r,null)):p&&(Le(),ze(p,1,1,(()=>{p=null})),Me()),(!d||1&h)&&Jt(r,"animate-spin",void 0===t[0]),(!d||2048&h&&s!==(s="progress-radial "+t[11]))&&Nt(e,"class",s),(!d||256&h)&&Nt(e,"aria-labelledby",t[8]),(!d||1&h&&l!==(l=t[0]||0))&&Nt(e,"aria-valuenow",l),(!d||1&h&&c!==(c=t[0]?`${t[0]}%`:"Indeterminate Spinner"))&&Nt(e,"aria-valuetext",c)},i(t){d||(De(p),d=!0)},o(t){ze(p),d=!1},d(t){t&&Tt(e),p&&p.d()}}}const ha="fill-transparent",fa="fill-transparent -rotate-90 origin-[50%_50%]",ga=512;function ma(t,e,r){let a,{$$slots:n={},$$scope:o}=e;const i=wt(n);let{value:s}=e,{stroke:l=40}=e,{font:c=56}=e,{strokeLinecap:d="butt"}=e,{transition:u="transition-[stroke-dashoffset]"}=e,{width:p="w-36"}=e,{meter:h="stroke-surface-900 dark:stroke-surface-50"}=e,{track:f="stroke-surface-500/30"}=e,{fill:g="fill-token"}=e,{labelledby:m=""}=e;const w=ga/2-l/2;let b,v=w;function y(t){r(9,v=2*w*Math.PI),r(10,b=v-t/100*v)}return y(0),ce((()=>{y(void 0===s?25:s)})),t.$$set=t=>{r(18,e=K(K({},e),gt(t))),"value"in t&&r(0,s=t.value),"stroke"in t&&r(1,l=t.stroke),"font"in t&&r(2,c=t.font),"strokeLinecap"in t&&r(3,d=t.strokeLinecap),"transition"in t&&r(4,u=t.transition),"width"in t&&r(14,p=t.width),"meter"in t&&r(5,h=t.meter),"track"in t&&r(6,f=t.track),"fill"in t&&r(7,g=t.fill),"labelledby"in t&&r(8,m=t.labelledby),"$$scope"in t&&r(15,o=t.$$scope)},t.$$.update=()=>{r(11,a=`progress-radial relative overflow-hidden ${p} ${e.class??""}`)},e=gt(e),[s,l,c,d,u,h,f,g,m,v,b,a,w,i,p,o,n]}class wa extends Ke{constructor(t){super(),Je(this,t,ma,pa,nt,{value:0,stroke:1,font:2,strokeLinecap:3,transition:4,width:14,meter:5,track:6,fill:7,labelledby:8})}}function ba(t){let e,r,a;const n=t[15].default,o=dt(n,t,t[14],null);return{c(){e=Lt("div"),o&&o.c(),Nt(e,"class",r="radio-group "+t[1]),Nt(e,"data-testid","radio-group"),Nt(e,"role","radiogroup"),Nt(e,"aria-labelledby",t[0])},m(t,r){It(t,e,r),o&&o.m(e,null),a=!0},p(t,[i]){o&&o.p&&(!a||16384&i)&&ht(o,n,t,t[14],a?pt(n,t[14],i,null):ft(t[14]),null),(!a||2&i&&r!==(r="radio-group "+t[1]))&&Nt(e,"class",r),(!a||1&i)&&Nt(e,"aria-labelledby",t[0])},i(t){a||(De(o,t),a=!0)},o(t){ze(o,t),a=!1},d(t){t&&Tt(e),o&&o.d(t)}}}function va(t,e,r){let a,{$$slots:n={},$$scope:o}=e,{display:i="inline-flex"}=e,{flexDirection:s="flex-row"}=e,{gap:l="gap-1"}=e,{background:c="bg-surface-200-700-token"}=e,{border:d="border-token border-surface-400-500-token"}=e,{rounded:u="rounded-token"}=e,{padding:p="px-4 py-1"}=e,{active:h="variant-filled"}=e,{hover:f="hover:variant-soft"}=e,{color:g=""}=e,{fill:m=""}=e,{regionLabel:w=""}=e,{labelledby:b=""}=e;return ue("rounded",u),ue("padding",p),ue("active",h),ue("hover",f),ue("color",g),ue("fill",m),ue("regionLabel",w),t.$$set=t=>{r(16,e=K(K({},e),gt(t))),"display"in t&&r(2,i=t.display),"flexDirection"in t&&r(3,s=t.flexDirection),"gap"in t&&r(4,l=t.gap),"background"in t&&r(5,c=t.background),"border"in t&&r(6,d=t.border),"rounded"in t&&r(7,u=t.rounded),"padding"in t&&r(8,p=t.padding),"active"in t&&r(9,h=t.active),"hover"in t&&r(10,f=t.hover),"color"in t&&r(11,g=t.color),"fill"in t&&r(12,m=t.fill),"regionLabel"in t&&r(13,w=t.regionLabel),"labelledby"in t&&r(0,b=t.labelledby),"$$scope"in t&&r(14,o=t.$$scope)},t.$$.update=()=>{r(1,a=`p-1 ${i} ${s} ${l} ${c} ${d} ${u} ${e.class??""}`)},e=gt(e),[b,a,i,s,l,c,d,u,p,h,f,g,m,w,o,n]}class ya extends Ke{constructor(t){super(),Je(this,t,va,ba,nt,{display:2,flexDirection:3,gap:4,background:5,border:6,rounded:7,padding:8,active:9,hover:10,color:11,fill:12,regionLabel:13,labelledby:0})}}function xa(t){let e,r,a,n,o,i,s,l,c,d,u,p=[{type:"radio"},{name:t[1]},{__value:t[2]},t[11](),{tabindex:"-1"}],h={};for(let t=0;t<p.length;t+=1)h=K(h,p[t]);const f=t[21].default,g=dt(f,t,t[20],null);return c=Ht(t[29][0]),{c(){e=Lt("label"),r=Lt("div"),a=Lt("div"),n=Lt("input"),o=zt(),g&&g.c(),Rt(n,h),Nt(a,"class","h-0 w-0 overflow-hidden"),Nt(r,"class",i="radio-item "+t[8]),Nt(r,"data-testid","radio-item"),Nt(r,"role","radio"),Nt(r,"aria-checked",t[6]),Nt(r,"aria-label",t[4]),Nt(r,"tabindex","0"),Nt(r,"title",t[3]),Nt(e,"class",s="radio-label "+t[9]+" "+t[5]),c.p(n)},m(i,s){It(i,e,s),_t(e,r),_t(r,a),_t(a,n),n.autofocus&&n.focus(),t[27](n),n.checked=n.__value===t[0],_t(r,o),g&&g.m(r,null),l=!0,d||(u=[Ot(n,"change",t[28]),Ot(n,"click",t[25]),Ot(n,"change",t[26]),Ot(r,"keydown",t[10]),Ot(r,"keydown",t[22]),Ot(r,"keyup",t[23]),Ot(r,"keypress",t[24])],d=!0)},p(t,a){Rt(n,h=We(p,[{type:"radio"},(!l||2&a[0])&&{name:t[1]},(!l||4&a[0])&&{__value:t[2]},t[11](),{tabindex:"-1"}])),1&a[0]&&(n.checked=n.__value===t[0]),g&&g.p&&(!l||1048576&a[0])&&ht(g,f,t,t[20],l?pt(f,t[20],a,null):ft(t[20]),null),(!l||256&a[0]&&i!==(i="radio-item "+t[8]))&&Nt(r,"class",i),(!l||64&a[0])&&Nt(r,"aria-checked",t[6]),(!l||16&a[0])&&Nt(r,"aria-label",t[4]),(!l||8&a[0])&&Nt(r,"title",t[3]),(!l||544&a[0]&&s!==(s="radio-label "+t[9]+" "+t[5]))&&Nt(e,"class",s)},i(t){l||(De(g,t),l=!0)},o(t){ze(g,t),l=!1},d(r){r&&Tt(e),t[27](null),g&&g.d(r),c.r(),d=!1,rt(u)}}}function ka(t,e,r){let a,n,o,i,s;const l=["group","name","value","title","label","rounded","padding","active","hover","color","fill","regionLabel"];let c,d=mt(e,l),{$$slots:u={},$$scope:p}=e,{group:h}=e,{name:f}=e,{value:g}=e,{title:m=""}=e,{label:w=""}=e,{rounded:b=pe("rounded")}=e,{padding:v=pe("padding")}=e,{active:y=pe("active")}=e,{hover:x=pe("hover")}=e,{color:k=pe("color")}=e,{fill:$=pe("fill")}=e,{regionLabel:C=pe("regionLabel")}=e;return t.$$set=t=>{r(31,e=K(K({},e),gt(t))),r(30,d=mt(e,l)),"group"in t&&r(0,h=t.group),"name"in t&&r(1,f=t.name),"value"in t&&r(2,g=t.value),"title"in t&&r(3,m=t.title),"label"in t&&r(4,w=t.label),"rounded"in t&&r(12,b=t.rounded),"padding"in t&&r(13,v=t.padding),"active"in t&&r(14,y=t.active),"hover"in t&&r(15,x=t.hover),"color"in t&&r(16,k=t.color),"fill"in t&&r(17,$=t.fill),"regionLabel"in t&&r(5,C=t.regionLabel),"$$scope"in t&&r(20,p=t.$$scope)},t.$$.update=()=>{5&t.$$.dirty[0]&&r(6,a=g===h),245824&t.$$.dirty[0]&&r(19,n=a?`${y} ${k} ${$}`:x),r(18,o=e.disabled?"opacity-50 cursor-not-allowed":""),r(8,s=`text-base text-center cursor-pointer ${v} ${b} ${n} ${o} ${e.class??""}`)},r(9,i="flex-auto"),e=gt(e),[h,f,g,m,w,C,a,c,s,"flex-auto",function(t){["Enter","Space"].includes(t.code)&&(t.preventDefault(),c.click())},function(){return delete d.class,d},b,v,y,x,k,$,o,n,p,u,function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(t){ge[t?"unshift":"push"]((()=>{c=t,r(7,c)}))},function(){h=this.__value,r(0,h)},[[]]]}class $a extends Ke{constructor(t){super(),Je(this,t,ka,xa,nt,{group:0,name:1,value:2,title:3,label:4,rounded:12,padding:13,active:14,hover:15,color:16,fill:17,regionLabel:5},null,[-1,-1])}}const Ca=t=>({}),Aa=t=>({});function Ea(t,e,r){const a=t.slice();return a[23]=e[r],a}function _a(t){let e,r;const a=t[15].default,n=dt(a,t,t[14],null);return{c(){e=Lt("label"),n&&n.c(),Nt(e,"class","range-slider-label "+Ba),Nt(e,"for",t[2])},m(t,a){It(t,e,a),n&&n.m(e,null),r=!0},p(t,o){n&&n.p&&(!r||16384&o)&&ht(n,a,t,t[14],r?pt(a,t[14],o,null):ft(t[14]),null),(!r||4&o)&&Nt(e,"for",t[2])},i(t){r||(De(n,t),r=!0)},o(t){ze(n,t),r=!1},d(t){t&&Tt(e),n&&n.d(t)}}}function Sa(t){let e,r,a=He(t[8]),n=[];for(let e=0;e<a.length;e+=1)n[e]=Pa(Ea(t,a,e));return{c(){e=Lt("datalist");for(let t=0;t<n.length;t+=1)n[t].c();Nt(e,"id",r="tickmarks-"+t[2]),Nt(e,"class","range-slider-ticks")},m(t,r){It(t,e,r);for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,null)},p(t,o){if(256&o){let r;for(a=He(t[8]),r=0;r<a.length;r+=1){const i=Ea(t,a,r);n[r]?n[r].p(i,o):(n[r]=Pa(i),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=a.length}4&o&&r!==(r="tickmarks-"+t[2])&&Nt(e,"id",r)},d(t){t&&Tt(e),Bt(n,t)}}}function Pa(t){let e,r,a;return{c(){e=Lt("option"),e.__value=r=t[23],qt(e,e.__value),Nt(e,"label",a=t[23])},m(t,r){It(t,e,r)},p(t,n){256&n&&r!==(r=t[23])&&(e.__value=r,qt(e,e.__value)),256&n&&a!==(a=t[23])&&Nt(e,"label",a)},d(t){t&&Tt(e)}}}function Ia(t){let e,r;const a=t[15].trail,n=dt(a,t,t[14],Aa);return{c(){e=Lt("div"),n&&n.c(),Nt(e,"class","range-slider-trail")},m(t,a){It(t,e,a),n&&n.m(e,null),r=!0},p(t,e){n&&n.p&&(!r||16384&e)&&ht(n,a,t,t[14],r?pt(a,t[14],e,Ca):ft(t[14]),Aa)},i(t){r||(De(n,t),r=!0)},o(t){ze(n,t),r=!1},d(t){t&&Tt(e),n&&n.d(t)}}}function Ta(t){let e,r,a,n,o,i,s,l,c,d,u,p,h=t[12].default&&_a(t),f=[{type:"range"},{id:t[2]},{name:t[1]},{class:o="range-slider-input "+t[9]},{list:i="tickmarks-"+t[2]},{"aria-label":t[7]},{min:t[3]},{max:t[4]},{step:t[5]},t[11]()],g={};for(let t=0;t<f.length;t+=1)g=K(g,f[t]);let m=t[6]&&t[8]&&t[8].length&&Sa(t),w=t[12].trail&&Ia(t);return{c(){e=Lt("div"),h&&h.c(),r=zt(),a=Lt("div"),n=Lt("input"),s=zt(),m&&m.c(),l=zt(),w&&w.c(),Rt(n,g),Nt(a,"class","range-content "+La),Nt(e,"class",c="range-slider "+t[10]),Nt(e,"data-testid","range-slider")},m(o,i){It(o,e,i),h&&h.m(e,null),_t(e,r),_t(e,a),_t(a,n),n.autofocus&&n.focus(),qt(n,t[0]),_t(a,s),m&&m.m(a,null),_t(e,l),w&&w.m(e,null),d=!0,u||(p=[Ot(n,"change",t[19]),Ot(n,"input",t[19]),Ot(n,"click",t[16]),Ot(n,"change",t[17]),Ot(n,"blur",t[18])],u=!0)},p(t,[s]){t[12].default?h?(h.p(t,s),4096&s&&De(h,1)):(h=_a(t),h.c(),De(h,1),h.m(e,r)):h&&(Le(),ze(h,1,1,(()=>{h=null})),Me()),Rt(n,g=We(f,[{type:"range"},(!d||4&s)&&{id:t[2]},(!d||2&s)&&{name:t[1]},(!d||512&s&&o!==(o="range-slider-input "+t[9]))&&{class:o},(!d||4&s&&i!==(i="tickmarks-"+t[2]))&&{list:i},(!d||128&s)&&{"aria-label":t[7]},(!d||8&s)&&{min:t[3]},(!d||16&s)&&{max:t[4]},(!d||32&s)&&{step:t[5]},t[11]()])),1&s&&qt(n,t[0]),t[6]&&t[8]&&t[8].length?m?m.p(t,s):(m=Sa(t),m.c(),m.m(a,null)):m&&(m.d(1),m=null),t[12].trail?w?(w.p(t,s),4096&s&&De(w,1)):(w=Ia(t),w.c(),De(w,1),w.m(e,null)):w&&(Le(),ze(w,1,1,(()=>{w=null})),Me()),(!d||1024&s&&c!==(c="range-slider "+t[10]))&&Nt(e,"class",c)},i(t){d||(De(h),De(w),d=!0)},o(t){ze(h),ze(w),d=!1},d(t){t&&Tt(e),h&&h.d(),m&&m.d(),w&&w.d(),u=!1,rt(p)}}}const Ba="",La="flex justify-center py-2";function Ma(t,e,r){let a,n;const o=["name","id","value","min","max","step","ticked","accent","label"];let i=mt(e,o),{$$slots:s={},$$scope:l}=e;const c=wt(s);let d,{name:u}=e,{id:p=String(Math.random())}=e,{value:h=0}=e,{min:f=0}=e,{max:g=100}=e,{step:m=1}=e,{ticked:w=!1}=e,{accent:b="accent-surface-900 dark:accent-surface-50"}=e,{label:v=""}=e;function y(){0!=w&&r(8,d=Array.from({length:g-f+1},((t,e)=>e+f)))}return w&&y(),ce((()=>{y()})),t.$$set=t=>{r(22,e=K(K({},e),gt(t))),r(21,i=mt(e,o)),"name"in t&&r(1,u=t.name),"id"in t&&r(2,p=t.id),"value"in t&&r(0,h=t.value),"min"in t&&r(3,f=t.min),"max"in t&&r(4,g=t.max),"step"in t&&r(5,m=t.step),"ticked"in t&&r(6,w=t.ticked),"accent"in t&&r(13,b=t.accent),"label"in t&&r(7,v=t.label),"$$scope"in t&&r(14,l=t.$$scope)},t.$$.update=()=>{r(10,a=`space-y-2 ${e.class??""}`),8192&t.$$.dirty&&r(9,n=`w-full h-2 ${b}`)},e=gt(e),[h,u,p,f,g,m,w,v,d,n,a,function(){return delete i.class,i},c,b,l,s,function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(){h=Ut(this.value),r(0,h)}]}class Da extends Ke{constructor(t){super(),Je(this,t,Ma,Ta,nt,{name:1,id:2,value:0,min:3,max:4,step:5,ticked:6,accent:13,label:7})}}function za(t){let e,r;const a=t[22].default,n=dt(a,t,t[21],null);return{c(){e=Lt("div"),n&&n.c(),Nt(e,"class","slide-toggle-text ml-3")},m(t,a){It(t,e,a),n&&n.m(e,null),r=!0},p(t,e){n&&n.p&&(!r||2097152&e[0])&&ht(n,a,t,t[21],r?pt(a,t[21],e,null):ft(t[21]),null)},i(t){r||(De(n,t),r=!0)},o(t){ze(n,t),r=!1},d(t){t&&Tt(e),n&&n.d(t)}}}function Fa(t){let e,r,a,n,o,i,s,l,c,d,u,p,h,f,g,m=[{type:"checkbox"},{class:"slide-toggle-input hidden"},{name:t[1]},t[8](),{disabled:n=t[9].disabled}],w={};for(let t=0;t<m.length;t+=1)w=K(w,m[t]);let b=t[10].default&&za(t);return{c(){e=Lt("div"),r=Lt("label"),a=Lt("input"),o=zt(),i=Lt("div"),s=Lt("div"),d=zt(),b&&b.c(),Rt(a,w),Nt(s,"class",l="slide-toggle-thumb "+t[3]),Jt(s,"cursor-not-allowed",t[9].disabled),Nt(i,"class",c="slide-toggle-track "+t[4]),Jt(i,"cursor-not-allowed",t[9].disabled),Nt(r,"class",u="slide-toggle-label "+t[5]),Nt(e,"id",t[2]),Nt(e,"class",p="slide-toggle "+t[6]),Nt(e,"data-testid","slide-toggle"),Nt(e,"role","switch"),Nt(e,"aria-label",t[2]),Nt(e,"aria-checked",t[0]),Nt(e,"tabindex","0")},m(n,l){It(n,e,l),_t(e,r),_t(r,a),a.autofocus&&a.focus(),a.checked=t[0],_t(r,o),_t(r,i),_t(i,s),_t(r,d),b&&b.m(r,null),h=!0,f||(g=[Ot(a,"change",t[31]),Ot(a,"click",t[23]),Ot(a,"keydown",t[24]),Ot(a,"keyup",t[25]),Ot(a,"keypress",t[26]),Ot(a,"mouseover",t[27]),Ot(a,"change",t[28]),Ot(a,"focus",t[29]),Ot(a,"blur",t[30]),Ot(e,"keydown",t[7])],f=!0)},p(t,o){Rt(a,w=We(m,[{type:"checkbox"},{class:"slide-toggle-input hidden"},(!h||2&o[0])&&{name:t[1]},t[8](),(!h||512&o[0]&&n!==(n=t[9].disabled))&&{disabled:n}])),1&o[0]&&(a.checked=t[0]),(!h||8&o[0]&&l!==(l="slide-toggle-thumb "+t[3]))&&Nt(s,"class",l),(!h||520&o[0])&&Jt(s,"cursor-not-allowed",t[9].disabled),(!h||16&o[0]&&c!==(c="slide-toggle-track "+t[4]))&&Nt(i,"class",c),(!h||528&o[0])&&Jt(i,"cursor-not-allowed",t[9].disabled),t[10].default?b?(b.p(t,o),1024&o[0]&&De(b,1)):(b=za(t),b.c(),De(b,1),b.m(r,null)):b&&(Le(),ze(b,1,1,(()=>{b=null})),Me()),(!h||32&o[0]&&u!==(u="slide-toggle-label "+t[5]))&&Nt(r,"class",u),(!h||4&o[0])&&Nt(e,"id",t[2]),(!h||64&o[0]&&p!==(p="slide-toggle "+t[6]))&&Nt(e,"class",p),(!h||4&o[0])&&Nt(e,"aria-label",t[2]),(!h||1&o[0])&&Nt(e,"aria-checked",t[0])},i(t){h||(De(b),h=!0)},o(t){ze(b),h=!1},d(t){t&&Tt(e),b&&b.d(),f=!1,rt(g)}}}function Oa(t,e,r){let a,n,o,i,s,l,c,d;const u=["name","checked","size","background","active","border","rounded","label"];let p=mt(e,u),{$$slots:h={},$$scope:f}=e;const g=wt(h),m=de();let w,{name:b}=e,{checked:v=!1}=e,{size:y="md"}=e,{background:x="bg-surface-400 dark:bg-surface-700"}=e,{active:k="bg-surface-900 dark:bg-surface-300"}=e,{border:$=""}=e,{rounded:C="rounded-full"}=e,{label:A=""}=e;switch(y){case"sm":w="w-12 h-6";break;case"lg":w="w-20 h-10";break;default:w="w-16 h-8"}return t.$$set=t=>{r(9,e=K(K({},e),gt(t))),r(33,p=mt(e,u)),"name"in t&&r(1,b=t.name),"checked"in t&&r(0,v=t.checked),"size"in t&&r(11,y=t.size),"background"in t&&r(12,x=t.background),"active"in t&&r(13,k=t.active),"border"in t&&r(14,$=t.border),"rounded"in t&&r(15,C=t.rounded),"label"in t&&r(2,A=t.label),"$$scope"in t&&r(21,f=t.$$scope)},t.$$.update=()=>{12289&t.$$.dirty[0]&&r(19,a=v?k:`${x} cursor-pointer`),1&t.$$.dirty[0]&&r(18,n=v?"bg-white/75":"bg-white"),1&t.$$.dirty[0]&&r(17,o=v?"translate-x-full":""),r(20,i=!0===e.disabled?"opacity-50":"hover:brightness-[105%] dark:hover:brightness-110 cursor-pointer"),r(6,s=`inline-block ${C} ${i} ${e.class??""}`),638976&t.$$.dirty[0]&&r(4,c=`flex transition-all duration-[200ms] cursor-pointer ${$} ${C} ${w} ${a}`),425984&t.$$.dirty[0]&&r(3,d=`w-[50%] h-full scale-[0.8] transition-all duration-[200ms] shadow ${C} ${n} ${o}`)},r(5,l="unstyled flex items-center"),e=gt(e),[v,b,A,d,c,"unstyled flex items-center",s,function(t){if(["Enter","Space"].includes(t.code)){t.preventDefault(),m("keyup",t);t.currentTarget.firstChild.click()}},function(){return delete p.class,p},e,g,y,x,k,$,C,w,o,n,a,i,f,h,function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(){v=this.checked,r(0,v)}]}class Na extends Ke{constructor(t){super(),Je(this,t,Oa,Fa,nt,{name:1,checked:0,size:11,background:12,active:13,border:14,rounded:15,label:2},null,[-1,-1])}}const ja=t=>({}),Ra=t=>({});function Ha(t){let e,r,a;const n=t[17].panel,o=dt(n,t,t[16],Ra);return{c(){e=Lt("div"),o&&o.c(),Nt(e,"class",r="tab-panel "+t[2]),Nt(e,"role","tabpanel"),Nt(e,"aria-labelledby",t[1]),Nt(e,"tabindex","0")},m(t,r){It(t,e,r),o&&o.m(e,null),a=!0},p(t,i){o&&o.p&&(!a||65536&i)&&ht(o,n,t,t[16],a?pt(n,t[16],i,ja):ft(t[16]),Ra),(!a||4&i&&r!==(r="tab-panel "+t[2]))&&Nt(e,"class",r),(!a||2&i)&&Nt(e,"aria-labelledby",t[1])},i(t){a||(De(o,t),a=!0)},o(t){ze(o,t),a=!1},d(t){t&&Tt(e),o&&o.d(t)}}}function Ua(t){let e,r,a,n,o,i;const s=t[17].default,l=dt(s,t,t[16],null);let c=t[5].panel&&Ha(t);return{c(){e=Lt("div"),r=Lt("div"),l&&l.c(),n=zt(),c&&c.c(),Nt(r,"class",a="tab-list "+t[3]),Nt(r,"role","tablist"),Nt(r,"aria-labelledby",t[0]),Nt(e,"class",o="tab-group "+t[4]),Nt(e,"data-testid","tab-group")},m(t,a){It(t,e,a),_t(e,r),l&&l.m(r,null),_t(e,n),c&&c.m(e,null),i=!0},p(t,[n]){l&&l.p&&(!i||65536&n)&&ht(l,s,t,t[16],i?pt(s,t[16],n,null):ft(t[16]),null),(!i||8&n&&a!==(a="tab-list "+t[3]))&&Nt(r,"class",a),(!i||1&n)&&Nt(r,"aria-labelledby",t[0]),t[5].panel?c?(c.p(t,n),32&n&&De(c,1)):(c=Ha(t),c.c(),De(c,1),c.m(e,null)):c&&(Le(),ze(c,1,1,(()=>{c=null})),Me()),(!i||16&n&&o!==(o="tab-group "+t[4]))&&Nt(e,"class",o)},i(t){i||(De(l,t),De(c),i=!0)},o(t){ze(l,t),ze(c),i=!1},d(t){t&&Tt(e),l&&l.d(t),c&&c.d()}}}function Wa(t,e,r){let a,n,o,{$$slots:i={},$$scope:s}=e;const l=wt(i);let{justify:c="justify-start"}=e,{border:d="border-b border-surface-400-500-token"}=e,{active:u="border-b-2 border-surface-900-50-token"}=e,{hover:p="hover:variant-soft"}=e,{flex:h="flex-none"}=e,{padding:f="px-4 py-2"}=e,{rounded:g="rounded-tl-container-token rounded-tr-container-token"}=e,{spacing:m="space-y-1"}=e,{regionList:w=""}=e,{regionPanel:b=""}=e,{labelledby:v=""}=e,{panel:y=""}=e;return ue("active",u),ue("hover",p),ue("flex",h),ue("padding",f),ue("rounded",g),ue("spacing",m),t.$$set=t=>{r(18,e=K(K({},e),gt(t))),"justify"in t&&r(6,c=t.justify),"border"in t&&r(7,d=t.border),"active"in t&&r(8,u=t.active),"hover"in t&&r(9,p=t.hover),"flex"in t&&r(10,h=t.flex),"padding"in t&&r(11,f=t.padding),"rounded"in t&&r(12,g=t.rounded),"spacing"in t&&r(13,m=t.spacing),"regionList"in t&&r(14,w=t.regionList),"regionPanel"in t&&r(15,b=t.regionPanel),"labelledby"in t&&r(0,v=t.labelledby),"panel"in t&&r(1,y=t.panel),"$$scope"in t&&r(16,s=t.$$scope)},t.$$.update=()=>{r(4,a=`space-y-4 ${e.class??""}`),16576&t.$$.dirty&&r(3,n=`flex overflow-x-auto hide-scrollbar ${c} ${d} ${w}`),32768&t.$$.dirty&&r(2,o=` ${b}`)},e=gt(e),[v,y,o,n,a,l,c,d,u,p,h,f,g,m,w,b,s,i]}class qa extends Ke{constructor(t){super(),Je(this,t,Wa,Ua,nt,{justify:6,border:7,active:8,hover:9,flex:10,padding:11,rounded:12,spacing:13,regionList:14,regionPanel:15,labelledby:0,panel:1})}}const Ga=t=>({}),Ya=t=>({});function Va(t){let e,r;const a=t[22].lead,n=dt(a,t,t[21],Ya);return{c(){e=Lt("div"),n&&n.c(),Nt(e,"class","tab-lead")},m(t,a){It(t,e,a),n&&n.m(e,null),r=!0},p(t,e){n&&n.p&&(!r||2097152&e[0])&&ht(n,a,t,t[21],r?pt(a,t[21],e,Ga):ft(t[21]),Ya)},i(t){r||(De(n,t),r=!0)},o(t){ze(n,t),r=!1},d(t){t&&Tt(e),n&&n.d(t)}}}function Qa(t){let e,r,a,n,o,i,s,l,c,d,u,p,h,f,g,m=[{type:"radio"},{name:t[1]},{__value:t[2]},t[11](),{tabindex:"-1"}],w={};for(let t=0;t<m.length;t+=1)w=K(w,m[t]);let b=t[12].lead&&Va(t);const v=t[22].default,y=dt(v,t,t[21],null);return h=Ht(t[30][0]),{c(){e=Lt("label"),r=Lt("div"),a=Lt("div"),n=Lt("input"),o=zt(),i=Lt("div"),b&&b.c(),s=zt(),l=Lt("div"),y&&y.c(),Rt(n,w),Nt(a,"class","h-0 w-0 overflow-hidden"),Nt(l,"class","tab-label"),Nt(i,"class",c="tab-interface "+t[8]),Nt(r,"class",d="tab "+t[7]),Nt(r,"data-testid","tab"),Nt(r,"role","tab"),Nt(r,"aria-controls",t[4]),Nt(r,"aria-selected",t[5]),Nt(r,"tabindex",u=t[5]?0:-1),Nt(e,"class",t[9]),Nt(e,"title",t[3]),h.p(n)},m(c,d){It(c,e,d),_t(e,r),_t(r,a),_t(a,n),n.autofocus&&n.focus(),t[28](n),n.checked=n.__value===t[0],_t(r,o),_t(r,i),b&&b.m(i,null),_t(i,s),_t(i,l),y&&y.m(l,null),p=!0,f||(g=[Ot(n,"change",t[29]),Ot(n,"click",t[26]),Ot(n,"change",t[27]),Ot(r,"keydown",t[10]),Ot(r,"keydown",t[23]),Ot(r,"keyup",t[24]),Ot(r,"keypress",t[25])],f=!0)},p(t,a){Rt(n,w=We(m,[{type:"radio"},(!p||2&a[0])&&{name:t[1]},(!p||4&a[0])&&{__value:t[2]},t[11](),{tabindex:"-1"}])),1&a[0]&&(n.checked=n.__value===t[0]),t[12].lead?b?(b.p(t,a),4096&a[0]&&De(b,1)):(b=Va(t),b.c(),De(b,1),b.m(i,s)):b&&(Le(),ze(b,1,1,(()=>{b=null})),Me()),y&&y.p&&(!p||2097152&a[0])&&ht(y,v,t,t[21],p?pt(v,t[21],a,null):ft(t[21]),null),(!p||256&a[0]&&c!==(c="tab-interface "+t[8]))&&Nt(i,"class",c),(!p||128&a[0]&&d!==(d="tab "+t[7]))&&Nt(r,"class",d),(!p||16&a[0])&&Nt(r,"aria-controls",t[4]),(!p||32&a[0])&&Nt(r,"aria-selected",t[5]),(!p||32&a[0]&&u!==(u=t[5]?0:-1))&&Nt(r,"tabindex",u),(!p||512&a[0])&&Nt(e,"class",t[9]),(!p||8&a[0])&&Nt(e,"title",t[3])},i(t){p||(De(b),De(y,t),p=!0)},o(t){ze(b),ze(y,t),p=!1},d(r){r&&Tt(e),t[28](null),b&&b.d(),y&&y.d(r),h.r(),f=!1,rt(g)}}}function Ja(t,e,r){let a,n,o,i,s;const l=["group","name","value","title","controls","regionTab","active","hover","flex","padding","rounded","spacing"];let c=mt(e,l),{$$slots:d={},$$scope:u}=e;const p=wt(d);let h,{group:f}=e,{name:g}=e,{value:m}=e,{title:w=""}=e,{controls:b=""}=e,{regionTab:v=""}=e,{active:y=pe("active")}=e,{hover:x=pe("hover")}=e,{flex:k=pe("flex")}=e,{padding:$=pe("padding")}=e,{rounded:C=pe("rounded")}=e,{spacing:A=pe("spacing")}=e;return t.$$set=t=>{r(32,e=K(K({},e),gt(t))),r(31,c=mt(e,l)),"group"in t&&r(0,f=t.group),"name"in t&&r(1,g=t.name),"value"in t&&r(2,m=t.value),"title"in t&&r(3,w=t.title),"controls"in t&&r(4,b=t.controls),"regionTab"in t&&r(13,v=t.regionTab),"active"in t&&r(14,y=t.active),"hover"in t&&r(15,x=t.hover),"flex"in t&&r(16,k=t.flex),"padding"in t&&r(17,$=t.padding),"rounded"in t&&r(18,C=t.rounded),"spacing"in t&&r(19,A=t.spacing),"$$scope"in t&&r(21,u=t.$$scope)},t.$$.update=()=>{5&t.$$.dirty[0]&&r(5,a=m===f),49184&t.$$.dirty[0]&&r(20,n=a?y:x),r(9,o=`text-center cursor-pointer transition-colors duration-100 ${k} ${$} ${C} ${n} ${e.class??""}`),524288&t.$$.dirty[0]&&r(8,i=` ${A}`),8192&t.$$.dirty[0]&&r(7,s=`${v}`)},e=gt(e),[f,g,m,w,b,a,h,s,i,o,function(t){if(["Enter","Space"].includes(t.code))t.preventDefault(),h.click();else if("ArrowRight"===t.code){const t=h.closest(".tab-list");if(!t)return;const e=Array.from(t.querySelectorAll(".tab")),r=h.closest(".tab");if(!r)return;const a=e.indexOf(r),n=e[a+1>=e.length?0:a+1],o=null==n?void 0:n.querySelector("input");n&&o&&(o.click(),n.focus())}else if("ArrowLeft"===t.code){const t=h.closest(".tab-list");if(!t)return;const e=Array.from(t.querySelectorAll(".tab")),r=h.closest(".tab");if(!r)return;const a=e.indexOf(r),n=e[a-1<0?e.length-1:a-1],o=null==n?void 0:n.querySelector("input");n&&o&&(o.click(),n.focus())}},function(){return delete c.class,c},p,v,y,x,k,$,C,A,n,u,d,function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(t){ge[t?"unshift":"push"]((()=>{h=t,r(6,h)}))},function(){f=this.__value,r(0,f)},[[]]]}class Xa extends Ke{constructor(t){super(),Je(this,t,Ja,Qa,nt,{group:0,name:1,value:2,title:3,controls:4,regionTab:13,active:14,hover:15,flex:16,padding:17,rounded:18,spacing:19},null,[-1,-1])}}function Za(t){let e,r,a=t[14],n=un(t);return{c(){n.c(),e=Ft()},m(t,a){n.m(t,a),It(t,e,a),r=!0},p(t,r){16384&r[0]&&nt(a,a=t[14])?(Le(),ze(n,1,1,X),Me(),n=un(t),n.c(),De(n,1),n.m(e.parentNode,e)):n.p(t,r)},i(t){r||(De(n),r=!0)},o(t){ze(n),r=!1},d(t){t&&Tt(e),n.d(t)}}}function Ka(t){let e,r,a,n,o,i;const s=[rn,en],l=[];function c(t,e){var r;return(null==(r=t[16])?void 0:r.slot)?0:1}return r=c(t),a=l[r]=s[r](t),{c(){var r;e=Lt("div"),a.c(),Nt(e,"class",n="modal contents "+((null==(r=t[14][0])?void 0:r.modalClasses)??"")),Nt(e,"data-testid","modal-component"),Nt(e,"role","dialog"),Nt(e,"aria-modal","true"),Nt(e,"aria-label",o=t[14][0].title??"")},m(a,n){It(a,e,n),l[r].m(e,null),t[47](e),i=!0},p(t,d){var u;let p=r;r=c(t),r===p?l[r].p(t,d):(Le(),ze(l[p],1,1,(()=>{l[p]=null})),Me(),a=l[r],a?a.p(t,d):(a=l[r]=s[r](t),a.c()),De(a,1),a.m(e,null)),(!i||16384&d[0]&&n!==(n="modal contents "+((null==(u=t[14][0])?void 0:u.modalClasses)??"")))&&Nt(e,"class",n),(!i||16384&d[0]&&o!==(o=t[14][0].title??""))&&Nt(e,"aria-label",o)},i(t){i||(De(a),i=!0)},o(t){ze(a),i=!1},d(a){a&&Tt(e),l[r].d(),t[47](null)}}}function tn(t){var e,r,a,n;let o,i,s,l,c,d,u=(null==(e=t[14][0])?void 0:e.title)&&nn(t),p=(null==(r=t[14][0])?void 0:r.body)&&on(t),h=(null==(a=t[14][0])?void 0:a.image)&&"string"==typeof(null==(n=t[14][0])?void 0:n.image)&&sn(t);function f(t,e){return"alert"===t[14][0].type?dn:"confirm"===t[14][0].type?cn:"prompt"===t[14][0].type?ln:void 0}let g=f(t),m=g&&g(t);return{c(){o=Lt("div"),u&&u.c(),i=zt(),p&&p.c(),s=zt(),h&&h.c(),l=zt(),m&&m.c(),Nt(o,"class",c="modal "+t[20]),Nt(o,"data-testid","modal"),Nt(o,"role","dialog"),Nt(o,"aria-modal","true"),Nt(o,"aria-label",d=t[14][0].title??"")},m(e,r){It(e,o,r),u&&u.m(o,null),_t(o,i),p&&p.m(o,null),_t(o,s),h&&h.m(o,null),_t(o,l),m&&m.m(o,null),t[46](o)},p(t,e){var r,a,n,w;(null==(r=t[14][0])?void 0:r.title)?u?u.p(t,e):(u=nn(t),u.c(),u.m(o,i)):u&&(u.d(1),u=null),(null==(a=t[14][0])?void 0:a.body)?p?p.p(t,e):(p=on(t),p.c(),p.m(o,s)):p&&(p.d(1),p=null),(null==(n=t[14][0])?void 0:n.image)&&"string"==typeof(null==(w=t[14][0])?void 0:w.image)?h?h.p(t,e):(h=sn(t),h.c(),h.m(o,l)):h&&(h.d(1),h=null),g===(g=f(t))&&m?m.p(t,e):(m&&m.d(1),m=g&&g(t),m&&(m.c(),m.m(o,null))),1048576&e[0]&&c!==(c="modal "+t[20])&&Nt(o,"class",c),16384&e[0]&&d!==(d=t[14][0].title??"")&&Nt(o,"aria-label",d)},i:X,o:X,d(e){e&&Tt(o),u&&u.d(),p&&p.d(),h&&h.d(),m&&m.d(),t[46](null)}}}function en(t){var e,r;let a,n,o;const i=[null==(e=t[16])?void 0:e.props,{parent:t[19]}];var s=null==(r=t[16])?void 0:r.ref;function l(t,e){var r;let a={};for(let t=0;t<i.length;t+=1)a=K(a,i[t]);return void 0!==e&&589824&e[0]&&(a=K(a,We(i,[65536&e[0]&&qe(null==(r=t[16])?void 0:r.props),524288&e[0]&&{parent:t[19]}]))),{props:a}}return s&&(a=Kt(s,l(t))),{c(){a&&Ye(a.$$.fragment),n=Ft()},m(t,e){a&&Ve(a,t,e),It(t,n,e),o=!0},p(t,e){var r,o;if(65536&e[0]&&s!==(s=null==(r=t[16])?void 0:r.ref)){if(a){Le();const t=a;ze(t.$$.fragment,1,0,(()=>{Qe(t,1)})),Me()}s?(a=Kt(s,l(t,e)),Ye(a.$$.fragment),De(a.$$.fragment,1),Ve(a,n.parentNode,n)):a=null}else if(s){const r=589824&e[0]?We(i,[65536&e[0]&&qe(null==(o=t[16])?void 0:o.props),524288&e[0]&&{parent:t[19]}]):{};a.$set(r)}},i(t){o||(a&&De(a.$$.fragment,t),o=!0)},o(t){a&&ze(a.$$.fragment,t),o=!1},d(t){t&&Tt(n),a&&Qe(a,t)}}}function rn(t){var e,r;let a,n,o;const i=[null==(e=t[16])?void 0:e.props,{parent:t[19]}];var s=null==(r=t[16])?void 0:r.ref;function l(t,e){var r;let a={$$slots:{default:[an]},$$scope:{ctx:t}};for(let t=0;t<i.length;t+=1)a=K(a,i[t]);return void 0!==e&&589824&e[0]&&(a=K(a,We(i,[65536&e[0]&&qe(null==(r=t[16])?void 0:r.props),524288&e[0]&&{parent:t[19]}]))),{props:a}}return s&&(a=Kt(s,l(t))),{c(){a&&Ye(a.$$.fragment),n=Ft()},m(t,e){a&&Ve(a,t,e),It(t,n,e),o=!0},p(t,e){var r,o;if(65536&e[0]&&s!==(s=null==(r=t[16])?void 0:r.ref)){if(a){Le();const t=a;ze(t.$$.fragment,1,0,(()=>{Qe(t,1)})),Me()}s?(a=Kt(s,l(t,e)),Ye(a.$$.fragment),De(a.$$.fragment,1),Ve(a,n.parentNode,n)):a=null}else if(s){const r=589824&e[0]?We(i,[65536&e[0]&&qe(null==(o=t[16])?void 0:o.props),524288&e[0]&&{parent:t[19]}]):{};65536&e[0]|16777216&e[1]&&(r.$$scope={dirty:e,ctx:t}),a.$set(r)}},i(t){o||(a&&De(a.$$.fragment,t),o=!0)},o(t){a&&ze(a.$$.fragment,t),o=!1},d(t){t&&Tt(n),a&&Qe(a,t)}}}function an(t){var e;let r,a,n=(null==(e=t[16])?void 0:e.slot)+"";return{c(){r=new Zt(!1),a=Ft(),r.a=a},m(t,e){r.m(n,t,e),It(t,a,e)},p(t,e){var a;65536&e[0]&&n!==(n=(null==(a=t[16])?void 0:a.slot)+"")&&r.p(n)},d(t){t&&(Tt(a),r.d())}}}function nn(t){let e,r,a=t[14][0].title+"";return{c(){e=Lt("header"),Nt(e,"class",r="modal-header "+t[5])},m(t,r){It(t,e,r),e.innerHTML=a},p(t,n){16384&n[0]&&a!==(a=t[14][0].title+"")&&(e.innerHTML=a),32&n[0]&&r!==(r="modal-header "+t[5])&&Nt(e,"class",r)},d(t){t&&Tt(e)}}}function on(t){let e,r,a=t[14][0].body+"";return{c(){e=Lt("article"),Nt(e,"class",r="modal-body "+t[6])},m(t,r){It(t,e,r),e.innerHTML=a},p(t,n){16384&n[0]&&a!==(a=t[14][0].body+"")&&(e.innerHTML=a),64&n[0]&&r!==(r="modal-body "+t[6])&&Nt(e,"class",r)},d(t){t&&Tt(e)}}}function sn(t){let e,r;return{c(){var a;e=Lt("img"),Nt(e,"class","modal-image "+hn),it(e.src,r=null==(a=t[14][0])?void 0:a.image)||Nt(e,"src",r),Nt(e,"alt","Modal")},m(t,r){It(t,e,r)},p(t,a){var n;16384&a[0]&&!it(e.src,r=null==(n=t[14][0])?void 0:n.image)&&Nt(e,"src",r)},d(t){t&&Tt(e)}}}function ln(t){let e,r,a,n,o,i,s,l,c,d,u,p,h,f,g=[{class:"modal-prompt-input input"},{name:"prompt"},{type:"text"},t[14][0].valueAttr],m={};for(let t=0;t<g.length;t+=1)m=K(m,g[t]);return{c(){e=Lt("form"),r=Lt("input"),a=zt(),n=Lt("footer"),o=Lt("button"),i=Dt(t[0]),l=zt(),c=Lt("button"),d=Dt(t[2]),Rt(r,m),Nt(o,"type","button"),Nt(o,"class",s="btn "+t[3]),Nt(c,"type","submit"),Nt(c,"class",u="btn "+t[4]),Nt(n,"class",p="modal-footer "+t[7]),Nt(e,"class","space-y-4")},m(s,u){It(s,e,u),_t(e,r),r.autofocus&&r.focus(),qt(r,t[15]),_t(e,a),_t(e,n),_t(n,o),_t(o,i),_t(n,l),_t(n,c),_t(c,d),h||(f=[Ot(r,"input",t[45]),Ot(o,"click",t[26]),Ot(e,"submit",t[28])],h=!0)},p(t,e){Rt(r,m=We(g,[{class:"modal-prompt-input input"},{name:"prompt"},{type:"text"},16384&e[0]&&t[14][0].valueAttr])),32768&e[0]&&r.value!==t[15]&&qt(r,t[15]),1&e[0]&&Wt(i,t[0]),8&e[0]&&s!==(s="btn "+t[3])&&Nt(o,"class",s),4&e[0]&&Wt(d,t[2]),16&e[0]&&u!==(u="btn "+t[4])&&Nt(c,"class",u),128&e[0]&&p!==(p="modal-footer "+t[7])&&Nt(n,"class",p)},d(t){t&&Tt(e),h=!1,rt(f)}}}function cn(t){let e,r,a,n,o,i,s,l,c,d,u;return{c(){e=Lt("footer"),r=Lt("button"),a=Dt(t[0]),o=zt(),i=Lt("button"),s=Dt(t[1]),Nt(r,"type","button"),Nt(r,"class",n="btn "+t[3]),Nt(i,"type","button"),Nt(i,"class",l="btn "+t[4]),Nt(e,"class",c="modal-footer "+t[7])},m(n,l){It(n,e,l),_t(e,r),_t(r,a),_t(e,o),_t(e,i),_t(i,s),d||(u=[Ot(r,"click",t[26]),Ot(i,"click",t[27])],d=!0)},p(t,o){1&o[0]&&Wt(a,t[0]),8&o[0]&&n!==(n="btn "+t[3])&&Nt(r,"class",n),2&o[0]&&Wt(s,t[1]),16&o[0]&&l!==(l="btn "+t[4])&&Nt(i,"class",l),128&o[0]&&c!==(c="modal-footer "+t[7])&&Nt(e,"class",c)},d(t){t&&Tt(e),d=!1,rt(u)}}}function dn(t){let e,r,a,n,o,i,s;return{c(){e=Lt("footer"),r=Lt("button"),a=Dt(t[0]),Nt(r,"type","button"),Nt(r,"class",n="btn "+t[3]),Nt(e,"class",o="modal-footer "+t[7])},m(n,o){It(n,e,o),_t(e,r),_t(r,a),i||(s=Ot(r,"click",t[26]),i=!0)},p(t,i){1&i[0]&&Wt(a,t[0]),8&i[0]&&n!==(n="btn "+t[3])&&Nt(r,"class",n),128&i[0]&&o!==(o="modal-footer "+t[7])&&Nt(e,"class",o)},d(t){t&&Tt(e),i=!1,s()}}}function un(t){let e,r,a,n,o,i,s,l,c,d,u,p;const h=[tn,Ka],f=[];function g(t,e){return"component"!==t[14][0].type?0:1}return a=g(t),n=f[a]=h[a](t),{c(){e=Lt("div"),r=Lt("div"),n.c(),Nt(r,"class",o="modal-transition "+t[21]),Nt(e,"class",l="modal-backdrop "+t[22]+" "+t[18]),Nt(e,"data-testid","modal-backdrop")},m(n,o){It(n,e,o),_t(e,r),f[a].m(r,null),d=!0,u||(p=[Ot(e,"mousedown",t[24]),Ot(e,"mouseup",t[25]),Ot(e,"touchstart",t[42],{passive:!0}),Ot(e,"touchend",t[43],{passive:!0}),vt(mr.call(null,e,!0))],u=!0)},p(i,s){let c=a;a=g(t=i),a===c?f[a].p(t,s):(Le(),ze(f[c],1,1,(()=>{f[c]=null})),Me(),n=f[a],n?n.p(t,s):(n=f[a]=h[a](t),n.c()),De(n,1),n.m(r,null)),(!d||2097152&s[0]&&o!==(o="modal-transition "+t[21]))&&Nt(r,"class",o),(!d||4456448&s[0]&&l!==(l="modal-backdrop "+t[22]+" "+t[18]))&&Nt(e,"class",l)},i(a){d||(De(n),ke((()=>{d&&(s&&s.end(1),i=Oe(r,kr,{transition:t[9],params:t[10],enabled:t[8]}),i.start())})),ke((()=>{d&&(c||(c=je(e,kr,{transition:br,params:{duration:150},enabled:t[8]},!0)),c.run(1))})),d=!0)},o(a){ze(n),i&&i.invalidate(),s=Ne(r,kr,{transition:t[11],params:t[12],enabled:t[8]}),c||(c=je(e,kr,{transition:br,params:{duration:150},enabled:t[8]},!1)),c.run(0),d=!1},d(t){t&&Tt(e),f[a].d(),t&&s&&s.end(),t&&c&&c.end(),u=!1,rt(p)}}}function pn(t){let e,r,a,n;ke(t[44]);let o=t[14].length>0&&Za(t);return{c(){o&&o.c(),e=Ft()},m(i,s){o&&o.m(i,s),It(i,e,s),r=!0,a||(n=[Ot(window,"keydown",t[29]),Ot(window,"resize",t[44])],a=!0)},p(t,r){t[14].length>0?o?(o.p(t,r),16384&r[0]&&De(o,1)):(o=Za(t),o.c(),De(o,1),o.m(e.parentNode,e)):o&&(Le(),ze(o,1,1,(()=>{o=null})),Me())},i(t){r||(De(o),r=!0)},o(t){ze(o),r=!1},d(t){t&&Tt(e),o&&o.d(t),a=!1,rt(n)}}}const hn="w-full h-auto";function fn(t,e,r){let a,n,o,i,s,l,c;ct(t,gr,(t=>r(49,c=t)));const d=de();let u,{components:p={}}=e,{position:h="items-center"}=e,{background:f="bg-surface-100-800-token"}=e,{width:g="w-modal"}=e,{height:m="h-auto"}=e,{padding:w="p-4"}=e,{spacing:b="space-y-4"}=e,{rounded:v="rounded-container-token"}=e,{shadow:y="shadow-xl"}=e,{zIndex:x="z-[999]"}=e,{buttonNeutral:k="variant-ghost-surface"}=e,{buttonPositive:$="variant-filled"}=e,{buttonTextCancel:C="Cancel"}=e,{buttonTextConfirm:A="Confirm"}=e,{buttonTextSubmit:E="Submit"}=e,{regionBackdrop:_=""}=e,{regionHeader:S="text-2xl font-bold"}=e,{regionBody:P="max-h-[200px] overflow-hidden"}=e,{regionFooter:I="flex justify-end space-x-2"}=e,{transitions:T=!c}=e,{transitionIn:B=vr}=e,{transitionInParams:L={duration:150,opacity:0,x:0,y:100}}=e,{transitionOut:M=vr}=e,{transitionOutParams:D={duration:150,opacity:0,x:0,y:100}}=e;const z={buttonTextCancel:C,buttonTextConfirm:A,buttonTextSubmit:E};let F,O,N,j=!1,R="overflow-y-hidden";const H=sr();function U(){l[0].response&&l[0].response(!1),H.close()}return ct(t,H,(t=>r(14,l=t))),t.$$set=t=>{r(54,e=K(K({},e),gt(t))),"components"in t&&r(30,p=t.components),"position"in t&&r(31,h=t.position),"background"in t&&r(32,f=t.background),"width"in t&&r(33,g=t.width),"height"in t&&r(34,m=t.height),"padding"in t&&r(35,w=t.padding),"spacing"in t&&r(36,b=t.spacing),"rounded"in t&&r(37,v=t.rounded),"shadow"in t&&r(38,y=t.shadow),"zIndex"in t&&r(39,x=t.zIndex),"buttonNeutral"in t&&r(3,k=t.buttonNeutral),"buttonPositive"in t&&r(4,$=t.buttonPositive),"buttonTextCancel"in t&&r(0,C=t.buttonTextCancel),"buttonTextConfirm"in t&&r(1,A=t.buttonTextConfirm),"buttonTextSubmit"in t&&r(2,E=t.buttonTextSubmit),"regionBackdrop"in t&&r(40,_=t.regionBackdrop),"regionHeader"in t&&r(5,S=t.regionHeader),"regionBody"in t&&r(6,P=t.regionBody),"regionFooter"in t&&r(7,I=t.regionFooter),"transitions"in t&&r(8,T=t.transitions),"transitionIn"in t&&r(9,B=t.transitionIn),"transitionInParams"in t&&r(10,L=t.transitionInParams),"transitionOut"in t&&r(11,M=t.transitionOut),"transitionOutParams"in t&&r(12,D=t.transitionOutParams)},t.$$.update=()=>{var c,d,T,B;16384&t.$$.dirty[0]&&l.length&&("prompt"===(B=l)[0].type&&r(15,u=B[0].value),r(0,C=B[0].buttonTextCancel||z.buttonTextCancel),r(1,A=B[0].buttonTextConfirm||z.buttonTextConfirm),r(2,E=B[0].buttonTextSubmit||z.buttonTextSubmit),r(16,F="string"==typeof B[0].component?p[B[0].component]:B[0].component)),8192&t.$$.dirty[0]&&function(t){var e;let a=null==t?void 0:t.clientHeight;a||(a=null==(e=null==t?void 0:t.firstChild)?void 0:e.clientHeight),a&&r(18,R=a>N?"overflow-y-auto":"overflow-y-hidden")}(O),16384&t.$$.dirty[0]|1&t.$$.dirty[1]&&r(41,a=(null==(c=l[0])?void 0:c.position)??h),r(22,n=`fixed top-0 left-0 right-0 bottom-0 bg-surface-backdrop-token p-4 ${_} ${x} ${e.class??""} ${(null==(d=l[0])?void 0:d.backdropClasses)??""}`),1024&t.$$.dirty[1]&&r(21,o=`w-full h-fit min-h-full overflow-y-auto flex justify-center ${a??""}`),16384&t.$$.dirty[0]|254&t.$$.dirty[1]&&r(20,i=`block overflow-y-auto ${f} ${g} ${m} ${w} ${b} ${v} ${y} ${(null==(T=l[0])?void 0:T.modalClasses)??""}`),255&t.$$.dirty[0]|767&t.$$.dirty[1]&&r(19,s={position:h,background:f,width:g,height:m,padding:w,spacing:b,rounded:v,shadow:y,buttonNeutral:k,buttonPositive:$,buttonTextCancel:C,buttonTextConfirm:A,buttonTextSubmit:E,regionBackdrop:_,regionHeader:S,regionBody:P,regionFooter:I,onClose:U})},e=gt(e),[C,A,E,k,$,S,P,I,T,B,L,M,D,O,l,u,F,N,R,s,i,o,n,H,function(t){if(!(t.target instanceof Element))return;const e=t.target.classList;(e.contains("modal-backdrop")||e.contains("modal-transition"))&&(j=!0)},function(t){if(!(t.target instanceof Element))return;const e=t.target.classList;(e.contains("modal-backdrop")||e.contains("modal-transition"))&&j&&(l[0].response&&l[0].response(void 0),H.close(),d("backdrop",t)),j=!1},U,function(){l[0].response&&l[0].response(!0),H.close()},function(t){t.preventDefault(),l[0].response&&(void 0!==l[0].valueAttr&&"type"in l[0].valueAttr&&"number"===l[0].valueAttr.type?l[0].response(parseInt(u)):l[0].response(u)),H.close()},function(t){l.length&&"Escape"===t.code&&U()},p,h,f,g,m,w,b,v,y,x,_,a,function(e){he.call(this,t,e)},function(e){he.call(this,t,e)},function(){r(17,N=window.innerHeight)},function(){u=this.value,r(15,u)},function(t){ge[t?"unshift":"push"]((()=>{O=t,r(13,O)}))},function(t){ge[t?"unshift":"push"]((()=>{O=t,r(13,O)}))}]}class gn extends Ke{constructor(t){super(),Je(this,t,fn,pn,nt,{components:30,position:31,background:32,width:33,height:34,padding:35,spacing:36,rounded:37,shadow:38,zIndex:39,buttonNeutral:3,buttonPositive:4,buttonTextCancel:0,buttonTextConfirm:1,buttonTextSubmit:2,regionBackdrop:40,regionHeader:5,regionBody:6,regionFooter:7,transitions:8,transitionIn:9,transitionInParams:10,transitionOut:11,transitionOutParams:12},null,[-1,-1])}}const mn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxMAAAsTAQCanBgAADzWSURBVHhe7Z0HnBRF9sdrMyxZoiCegKCCOZ3xzKcCgp56CoqKohj+6pmznBGMGM+cQDALBgwneuZ4nieGU5KKIoqAIrCEDf1/3zddQ29vd09P2oD++BQzW93TXV316uWqLvhZUCowv8P8+OOP5uOPPzY9evQwvXr1MoWFhe6RYDiOY2bPnm2+/vprs+WWW5p27dq5R37bWCEwNTU1K6WDfvNYvny5M2LECKd58+bOjjvu6Hz77bfukXB88803zuabb+60aNHCueqqq5xVq1a5R+JB+t79tmZBnms5U7IqQWdrHhYvXmymTZvm/hWNlStXmpkzZxohMOVCcK9UKCkpMT/88INZtmyZqa6uNgUFBe6RaHzxxRdm6dKl7l9rJKqieX0Txi+//GKGDh1qhKOYs846y1RVRc+fsrIy0759eyWOyspK2Ll7JBxrr722ef31182ECRPMyJEjTXFxsXskHOeee67p27ev+b//+79Y92iqWGMJCy4yb9481YNeeOGFlBwINbNbt26qV8G94g567969lYDXWmsttyYatIM2iWqLGuLWrnlYYwmrdevWyoHATz/9ZL777jv9HgYIqmPHjqaoqEg5FmIUAsg1xo4dax588EFz/fXXm/Lycrd2zUOTIiy4CDqNKMluTThatmxpNt54YxVPiMXvv/8+JaF07dpVCYvrw1nywVHatm1rDjvsMLU64+hk6G60Jc4zNyY0GcJCPI0ePdoMGjTIiAWmXCUKDNr+++9vNthgA7PeeuupmEs1kB06dFDCgqDgcg0tqrj/zTffbAYPHmzGjRuXUk9sVJDGL5OZ3OghHMfZZpttYDmO6DXOl19+6R4JhwyEI7PdmTNnjn5PhX/9619Oq1at9B4nn3yyuiDiQvrR/ZY7VFRUOMJFtT177723s2TJEvdI44b0xZImw7FQjvv166cc5auvvjJTp05VMREFzu3UqZPp3r27fk8FxJQ9LxXH4t633Xab2XrrrVVfSsVBM0GzZs3MlVdeaf70pz+Z4cOHm+bNm7tHmgCaCscC77//vtOmTRudwZtuuqkjg+8eiQYz/7PPPnNk8N2aYMyePdvp3LmzXn+PPfZwfv31V/dIXcyfP9/Zbrvt9Ny+ffsqV4xC3DYEAU4lhOz+1fjRpDiWtNdstdVWZt9999W/P/30UzNlyhT9ngrXXHON2XHHHdWHFAUh2mRYZtGiRZEcCwcnliOAy6XyYV133XXahlGjRrk18dGiRYuU4aVGh8bAscTaiz0jZ8yYoSEUabrqWmLxuUfCIaJEzxcCcObNm+fW1gXtsHrcH/7wh0iO+MUXXzg9evTQc//4xz86QojukbrgulZXEmPCrQ0HoaFrr73WkYngiBUcW3+jD9PRC/OFRsGx3nvvPXPUUUeZ++67L5aesv7665tjjjlGvwuRmXvuuUe/R0EGXj/Ri15++WX9HgS87zvttJN+h3NFcSFcHzhhgYjPSP1HjAJ1kwARsfoZhaefflq565gxY8xTTz0Vyy1BKOqGG25QVwb6Z4OjoTnWgQce6EjHafD3zTffdGuj8c477ziiaMfiFkBEpiNEo+eLEhzKHeEMIt6cCy+8UC3EKC767rvvOq1bt9ZrCqG7tcE47rjj9DzKs88+69YGg/tvttlmei5t5j5xMHPmTGejjTbSvtxnn30y0uVyhUbBsbB40FGYccOGDdMwTCrgm8IaYyb/73//M//+97/dI8HgfOl09XSjR4VxAOrx2F922WVm1113jeQUePJFIdfv1sMfBvxjOGy32GILs+2227q1wXj44YfNl19+qd+HDBlixEjR76lAG0jd6dmzp+qhcazgvKKhORbWkrDv5Iw++OCDI60xi0cffVR1LazEl156ya0NBj6s//znP8ot0tFZoiDErHqTEIxytygsXLjQefHFF9UqTKVL3nXXXcq9hRidV155Ja22LliwQP176HQNCThWAYQlM7NBg1b//e9/zX777adcoFWrVkaIxuy99956LIxr4IV+5plnVNfBw17fPh70tY8++kitVThFrjgEz/PEE08ohxswYECsjInGBumTpQ3OsZiRzOKLLrrIKSkpUa5Fot3PP//snpFbYOkxo9PhBL8jPcCxGlzHgiPhozn99NONKPJah2ed2GBcEGT+8MMPk7E0eTb99IPcKeJuf//732OnxdQnPvnkkzUnAbChOZYX0qnO3/72N+eBBx5QX04criImv3PEEUeolYjfB+4X9jtSj+WRndLSUmfatGlubV288MILzvHHH+98+umnbk1d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";function wn(t){let e,r,a,n,o,i,s,l,c,d,u;const p=t[8].default,h=dt(p,t,t[7],null);return{c(){e=Lt("div"),r=Lt("section"),h&&h.c(),a=zt(),n=Lt("div"),o=Lt("a"),i=zt(),s=Lt("button"),s.textContent="✕",Nt(r,"class","overflow-hidden h-full"),Nt(o,"target","_blank"),Nt(o,"href","https://github.com/drunkg00se/Pixiv-Downloader"),Nt(o,"class","w-5 fill-current"),Nt(s,"class","btn-icon btn-icon-sm bg-transparent font-bold hover:text-xl"),Nt(n,"class","absolute top-2 right-2 z-1 select-none flex items-center gap-1"),Nt(e,"data-theme","skeleton"),Nt(e,"class",l="relative rounded-container-token shadow-xl bg-scroll "+t[1])},m(l,p){It(l,e,p),_t(e,r),h&&h.m(r,null),_t(e,a),_t(e,n),_t(n,o),o.innerHTML='<svg viewBox="0 0 98 96" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z"/></svg>',_t(n,i),_t(n,s),c=!0,d||(u=Ot(s,"click",(function(){at(t[0].onClose)&&t[0].onClose.apply(this,arguments)})),d=!0)},p(r,a){t=r,h&&h.p&&(!c||128&a)&&ht(h,p,t,t[7],c?pt(p,t[7],a,null):ft(t[7]),null),(!c||2&a&&l!==(l="relative rounded-container-token shadow-xl bg-scroll "+t[1]))&&Nt(e,"class",l)},i(t){c||(De(h,t),c=!0)},o(t){ze(h,t),c=!1},d(t){t&&Tt(e),h&&h.d(t),d=!1,u()}}}function bn(t){let e,r,a=t[2][0]&&wn(t);return{c(){a&&a.c(),e=Ft()},m(t,n){a&&a.m(t,n),It(t,e,n),r=!0},p(t,[r]){t[2][0]?a?(a.p(t,r),4&r&&De(a,1)):(a=wn(t),a.c(),De(a,1),a.m(e.parentNode,e)):a&&(Le(),ze(a,1,1,(()=>{a=null})),Me())},i(t){r||(De(a),r=!0)},o(t){ze(a),r=!1},d(t){t&&Tt(e),a&&a.d(t)}}}function vn(t,e,r){let a,n,{$$slots:o={},$$scope:i}=e,{parent:s}=e,{padding:l="py-6 px-8"}=e,{width:c="w-full md:max-w-screen-sm lg:max-w-screen-md xl:max-w-screen-lg"}=e,{height:d=""}=e;const u=sr();return ct(t,u,(t=>r(2,n=t))),t.$$set=t=>{r(9,e=K(K({},e),gt(t))),"parent"in t&&r(0,s=t.parent),"padding"in t&&r(4,l=t.padding),"width"in t&&r(5,c=t.width),"height"in t&&r(6,d=t.height),"$$scope"in t&&r(7,i=t.$$scope)},t.$$.update=()=>{r(1,a=`${l} ${c} ${d} ${e.class??""}`)},e=gt(e),[s,a,n,u,l,c,d,i,o]}class yn extends Ke{constructor(t){super(),Je(this,t,vn,bn,nt,{parent:0,padding:4,width:5,height:6})}}function xn(t){let e,r,a,n,o,i,s,l,c,d,u,p,h,f,g,m,w,b,v,y,x,k,$,C,A=J("changelog.credit")+"",E=J("changelog.feedback")+"";return{c(){e=Lt("header"),e.textContent="Pixiv Downloader 1.5.0",r=zt(),a=Lt("article"),a.innerHTML='<ul class="list-disc list-inside leading-loose"><p>新的一年希望你爱的人和爱你的人都身体健康^_^</p> <li>新增：支持批量下载Rule34 Posts， Pools， My favorites。</li> <li>新增：支持批量下载Yande 投稿，图集，人气。</li> <li>新增：为Danbooru批量下载添加“排除网站黑名单”筛选器。</li> <li>新增：Danbooru网站“Show deleted posts”设置将适用于批量下载。</li> <li>新增：下载Pixiv作品时为作品点赞（批量下载不适用）。</li> <li>修复了若干问题。</li></ul>',n=zt(),o=Lt("footer"),i=Lt("div"),s=Lt("button"),l=Dt(A),c=zt(),d=Lt("a"),u=Dt(E),p=zt(),h=Lt("div"),f=Lt("div"),g=Lt("img"),w=zt(),b=Lt("p"),v=Lt("a"),v.textContent=`${J("changelog.give_me_a_star")}`,y=zt(),x=Lt("span"),x.textContent=`${J("changelog.buy_me_a_drink")}`,Nt(e,"class","modal-header text-2xl font-bold"),Nt(a,"class","modal-body mt-4"),Nt(s,"class",t[3]),Nt(d,"class",t[3]),Nt(d,"target","_blank"),Nt(d,"href","https://github.com/drunkg00se/Pixiv-Downloader/issues"),Nt(i,"class","flex justify-between items-center text-sm"),it(g.src,m=mn)||Nt(g,"src",m),Nt(g,"alt","credit"),Nt(g,"class","rounded-full"),Nt(v,"href","https://github.com/drunkg00se/Pixiv-Downloader"),Nt(v,"target","_blank"),Nt(v,"class","anchor"),Nt(b,"class","flex flex-col h-full justify-evenly"),Nt(f,"class","flex justify-center items-center min-h-0 gap-14 overflow-hidden"),Nt(h,"class",k="grid transition-[grid-template-rows] duration-[400ms] "+t[2]),Nt(o,"class","modal-footer mt-4")},m(m,k){It(m,e,k),It(m,r,k),It(m,a,k),It(m,n,k),It(m,o,k),_t(o,i),_t(i,s),_t(s,l),_t(i,c),_t(i,d),_t(d,u),_t(o,p),_t(o,h),_t(h,f),_t(f,g),_t(f,w),_t(f,b),_t(b,v),_t(b,y),_t(b,x),$||(C=Ot(s,"click",t[4]),$=!0)},p(t,e){4&e&&k!==(k="grid transition-[grid-template-rows] duration-[400ms] "+t[2])&&Nt(h,"class",k)},d(t){t&&(Tt(e),Tt(r),Tt(a),Tt(n),Tt(o)),$=!1,C()}}}function kn(t){let e,r;return e=new yn({props:{parent:t[0],$$slots:{default:[xn]},$$scope:{ctx:t}}}),{c(){Ye(e.$$.fragment)},m(t,a){Ve(e,t,a),r=!0},p(t,[r]){const a={};1&r&&(a.parent=t[0]),70&r&&(a.$$scope={dirty:r,ctx:t}),e.$set(a)},i(t){r||(De(e.$$.fragment,t),r=!0)},o(t){ze(e.$$.fragment,t),r=!1},d(t){Qe(e,t)}}}function $n(t,e,r){let a;let{parent:n}=e,o=!1;return t.$$set=t=>{"parent"in t&&r(0,n=t.parent)},t.$$.update=()=>{2&t.$$.dirty&&r(2,a=o?"grid-rows-[1fr] mt-2":"grid-rows-[0fr]")},[n,o,a,"leading-loose anchor underline-offset-2 focus:!outline-none focus:decoration-wavy",()=>r(1,o=!o)]}class Cn extends Ke{constructor(t){super(),Je(this,t,$n,kn,nt,{parent:0})}}const An='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>check</title><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" /></svg>',En=rr();function _n(t,e,r){const a=t.slice();return a[40]=e[r],a}function Sn(t,e,r){const a=t.slice();return a[40]=e[r],a}function Pn(t){let e;return{c(){e=Lt("input"),Nt(e,"type","text"),e.disabled=!0,Nt(e,"placeholder",t[11])},m(t,r){It(t,e,r)},p(t,r){2048&r[0]&&Nt(e,"placeholder",t[11])},d(t){t&&Tt(e)}}}function In(t){let e,r,a;return{c(){e=Lt("input"),Nt(e,"type","text"),Nt(e,"placeholder",t[11])},m(n,o){It(n,e,o),t[27](e),qt(e,t[4]),r||(a=Ot(e,"input",t[28]),r=!0)},p(t,r){2048&r[0]&&Nt(e,"placeholder",t[11]),16&r[0]&&e.value!==t[4]&&qt(e,t[4])},d(n){n&&Tt(e),t[27](null),r=!1,a()}}}function Tn(t){let e,r,a,n,o,i,s,l=t[40]+"";return{c(){e=Lt("button"),r=Lt("span"),a=Dt(l),n=zt(),Nt(e,"class","chip variant-soft hover:variant-filled"),e.disabled=o=!t[6]},m(o,l){It(o,e,l),_t(e,r),_t(r,a),_t(e,n),i||(s=Ot(e,"click",(function(){at(t[20](t[40]))&&t[20](t[40]).apply(this,arguments)})),i=!0)},p(r,n){t=r,8&n[0]&&l!==(l=t[40]+"")&&Wt(a,l),64&n[0]&&o!==(o=!t[6])&&(e.disabled=o)},d(t){t&&Tt(e),i=!1,s()}}}function Bn(t){let e,r,a,n,o,i,s,l,c,d,u,p,h,f,g;return p=new ya({props:{class:"shrink-0",$$slots:{default:[zn]},$$scope:{ctx:t}}}),{c(){e=Lt("li"),r=Lt("p"),r.textContent=`${J("setting.save_to.options.fsa_directory")}`,a=zt(),n=Lt("span"),o=Dt(t[10]),i=zt(),s=Lt("button"),s.textContent=`${J("setting.save_to.button.choose_fsa_directory")}`,l=zt(),c=Lt("li"),d=Lt("p"),d.textContent=`${J("setting.save_to.options.fsa_filename_conflict")}`,u=zt(),Ye(p.$$.fragment),Nt(r,"class","flex-auto"),Nt(n,"class","text-sm italic"),Nt(s,"class","btn btn-sm variant-filled"),Nt(d,"class","flex-auto")},m(m,w){It(m,e,w),_t(e,r),_t(e,a),_t(e,n),_t(n,o),_t(e,i),_t(e,s),It(m,l,w),It(m,c,w),_t(c,d),_t(c,u),Ve(p,c,null),h=!0,f||(g=Ot(s,"click",t[19]),f=!0)},p(t,e){(!h||1024&e[0])&&Wt(o,t[10]);const r={};128&e[0]|16384&e[1]&&(r.$$scope={dirty:e,ctx:t}),p.$set(r)},i(t){h||(De(p.$$.fragment,t),h=!0)},o(t){ze(p.$$.fragment,t),h=!1},d(t){t&&(Tt(e),Tt(l),Tt(c)),Qe(p),f=!1,g()}}}function Ln(t){let e,r=J("setting.save_to.radio.filename_conflict_option_uniquify")+"";return{c(){e=Dt(r)},m(t,r){It(t,e,r)},p:X,d(t){t&&Tt(e)}}}function Mn(t){let e,r=J("setting.save_to.radio.filename_conflict_option_overwrite")+"";return{c(){e=Dt(r)},m(t,r){It(t,e,r)},p:X,d(t){t&&Tt(e)}}}function Dn(t){let e,r=J("setting.save_to.radio.filename_conflict_option_prompt")+"";return{c(){e=Dt(r)},m(t,r){It(t,e,r)},p:X,d(t){t&&Tt(e)}}}function zn(t){let e,r,a,n,o,i,s,l,c;function d(e){t[30](e)}let u={name:"filenameConfigAction",class:"text-sm",value:C.UNIQUIFY,$$slots:{default:[Ln]},$$scope:{ctx:t}};function p(e){t[31](e)}void 0!==t[7].fileSystemFilenameConflictAction&&(u.group=t[7].fileSystemFilenameConflictAction),e=new $a({props:u}),ge.push((()=>Ge(e,"group",d)));let h={name:"filenameConfigAction",class:"text-sm",value:C.OVERWRITE,$$slots:{default:[Mn]},$$scope:{ctx:t}};function f(e){t[32](e)}void 0!==t[7].fileSystemFilenameConflictAction&&(h.group=t[7].fileSystemFilenameConflictAction),n=new $a({props:h}),ge.push((()=>Ge(n,"group",p)));let g={name:"filenameConfigAction",class:"text-sm",value:C.PROMPT,$$slots:{default:[Dn]},$$scope:{ctx:t}};return void 0!==t[7].fileSystemFilenameConflictAction&&(g.group=t[7].fileSystemFilenameConflictAction),s=new $a({props:g}),ge.push((()=>Ge(s,"group",f))),{c(){Ye(e.$$.fragment),a=zt(),Ye(n.$$.fragment),i=zt(),Ye(s.$$.fragment)},m(t,r){Ve(e,t,r),It(t,a,r),Ve(n,t,r),It(t,i,r),Ve(s,t,r),c=!0},p(t,a){const i={};16384&a[1]&&(i.$$scope={dirty:a,ctx:t}),!r&&128&a[0]&&(r=!0,i.group=t[7].fileSystemFilenameConflictAction,$e((()=>r=!1))),e.$set(i);const c={};16384&a[1]&&(c.$$scope={dirty:a,ctx:t}),!o&&128&a[0]&&(o=!0,c.group=t[7].fileSystemFilenameConflictAction,$e((()=>o=!1))),n.$set(c);const d={};16384&a[1]&&(d.$$scope={dirty:a,ctx:t}),!l&&128&a[0]&&(l=!0,d.group=t[7].fileSystemFilenameConflictAction,$e((()=>l=!1))),s.$set(d)},i(t){c||(De(e.$$.fragment,t),De(n.$$.fragment,t),De(s.$$.fragment,t),c=!0)},o(t){ze(e.$$.fragment,t),ze(n.$$.fragment,t),ze(s.$$.fragment,t),c=!1},d(t){t&&(Tt(a),Tt(i)),Qe(e,t),Qe(n,t),Qe(s,t)}}}function Fn(t){let e,r,a,n,o,i,s=t[40]+"";return{c(){e=Lt("button"),r=Lt("span"),a=Dt(s),n=zt(),Nt(e,"class","chip variant-soft hover:variant-filled")},m(s,l){It(s,e,l),_t(e,r),_t(r,a),_t(e,n),o||(i=Ot(e,"click",(function(){at(t[21](t[40]))&&t[21](t[40]).apply(this,arguments)})),o=!0)},p(e,r){t=e,8&r[0]&&s!==(s=t[40]+"")&&Wt(a,s)},d(t){t&&Tt(e),o=!1,i()}}}function On(t){let e;return{c(){e=Dt("日本語")},m(t,r){It(t,e,r)},d(t){t&&Tt(e)}}}function Nn(t){let e;return{c(){e=Dt("简中")},m(t,r){It(t,e,r)},d(t){t&&Tt(e)}}}function jn(t){let e;return{c(){e=Dt("繁中")},m(t,r){It(t,e,r)},d(t){t&&Tt(e)}}}function Rn(t){let e;return{c(){e=Dt("En")},m(t,r){It(t,e,r)},d(t){t&&Tt(e)}}}function Hn(t){let e,r,a,n,o,i,s,l,c,d,u,p;function h(e){t[35](e)}let f={name:"tagLang",class:"text-sm",value:A.JAPANESE,$$slots:{default:[On]},$$scope:{ctx:t}};function g(e){t[36](e)}void 0!==t[7].tagLang&&(f.group=t[7].tagLang),e=new $a({props:f}),ge.push((()=>Ge(e,"group",h)));let m={name:"tagLang",class:"text-sm",value:A.CHINESE,$$slots:{default:[Nn]},$$scope:{ctx:t}};function w(e){t[37](e)}void 0!==t[7].tagLang&&(m.group=t[7].tagLang),n=new $a({props:m}),ge.push((()=>Ge(n,"group",g)));let b={name:"tagLang",class:"text-sm",value:A.TRADITIONAL_CHINESE,$$slots:{default:[jn]},$$scope:{ctx:t}};function v(e){t[38](e)}void 0!==t[7].tagLang&&(b.group=t[7].tagLang),s=new $a({props:b}),ge.push((()=>Ge(s,"group",w)));let y={name:"tagLang",class:"text-sm",value:A.ENGLISH,$$slots:{default:[Rn]},$$scope:{ctx:t}};return void 0!==t[7].tagLang&&(y.group=t[7].tagLang),d=new $a({props:y}),ge.push((()=>Ge(d,"group",v))),{c(){Ye(e.$$.fragment),a=zt(),Ye(n.$$.fragment),i=zt(),Ye(s.$$.fragment),c=zt(),Ye(d.$$.fragment)},m(t,r){Ve(e,t,r),It(t,a,r),Ve(n,t,r),It(t,i,r),Ve(s,t,r),It(t,c,r),Ve(d,t,r),p=!0},p(t,a){const i={};16384&a[1]&&(i.$$scope={dirty:a,ctx:t}),!r&&128&a[0]&&(r=!0,i.group=t[7].tagLang,$e((()=>r=!1))),e.$set(i);const c={};16384&a[1]&&(c.$$scope={dirty:a,ctx:t}),!o&&128&a[0]&&(o=!0,c.group=t[7].tagLang,$e((()=>o=!1))),n.$set(c);const p={};16384&a[1]&&(p.$$scope={dirty:a,ctx:t}),!l&&128&a[0]&&(l=!0,p.group=t[7].tagLang,$e((()=>l=!1))),s.$set(p);const h={};16384&a[1]&&(h.$$scope={dirty:a,ctx:t}),!u&&128&a[0]&&(u=!0,h.group=t[7].tagLang,$e((()=>u=!1))),d.$set(h)},i(t){p||(De(e.$$.fragment,t),De(n.$$.fragment,t),De(s.$$.fragment,t),De(d.$$.fragment,t),p=!0)},o(t){ze(e.$$.fragment,t),ze(n.$$.fragment,t),ze(s.$$.fragment,t),ze(d.$$.fragment,t),p=!1},d(t){t&&(Tt(a),Tt(i),Tt(c)),Qe(e,t),Qe(n,t),Qe(s,t),Qe(d,t)}}}function Un(t){let e,r,a,n,o,i,s,l,c,d,u,p,h,f,g,m,w,b,v,y,k,$,C,A,E,_,S,P,I,T,B,L,M,D,z,F,O,N,j,R,H,U,W,q,G=J("setting.save_to.label.directory")+"",Y=J("setting.save_to.label.filename")+"",V=x.isPixiv();function Q(t,e){return t[6]?In:Pn}let X=Q(t),Z=X(t),K=He(t[3]),tt=[];for(let e=0;e<K.length;e+=1)tt[e]=Tn(Sn(t,K,e));function et(e){t[29](e)}let at={size:"sm",name:"fsa-enable",disabled:!x.isFileSystemAccessAvaliable()};void 0!==t[7].useFileSystemAccess&&(at.checked=t[7].useFileSystemAccess),k=new Na({props:at}),ge.push((()=>Ge(k,"checked",et)));let nt=t[7].useFileSystemAccess&&Bn(t),ot=He(t[3]),it=[];for(let e=0;e<ot.length;e+=1)it[e]=Fn(_n(t,ot,e));let st=V&&function(t){let e,r,a,n,o,i,s,l,c,d=J("setting.save_to.options.tag_language_tips")+"";return l=new ya({props:{class:" shrink-0",$$slots:{default:[Hn]},$$scope:{ctx:t}}}),{c(){e=Lt("li"),r=Lt("div"),a=Lt("p"),a.textContent=`${J("setting.save_to.options.tag_language")}`,n=zt(),o=Lt("p"),i=Dt(d),s=zt(),Ye(l.$$.fragment),Nt(o,"class",t[0]),Nt(r,"class","flex-auto")},m(t,d){It(t,e,d),_t(e,r),_t(r,a),_t(r,n),_t(r,o),_t(o,i),_t(e,s),Ve(l,e,null),c=!0},p(t,e){(!c||1&e[0])&&Nt(o,"class",t[0]);const r={};128&e[0]|16384&e[1]&&(r.$$scope={dirty:e,ctx:t}),l.$set(r)},i(t){c||(De(l.$$.fragment,t),c=!0)},o(t){ze(l.$$.fragment,t),c=!1},d(t){t&&Tt(e),Qe(l)}}}(t);return{c(){e=Lt("div"),r=Lt("section"),a=Lt("p"),n=Dt(G),o=zt(),i=Lt("ul"),s=Lt("li"),l=Lt("div"),c=Lt("button"),d=Lt("i"),u=zt(),Z.c(),p=zt(),h=Lt("button"),f=Lt("i"),g=zt(),m=Lt("div");for(let t=0;t<tt.length;t+=1)tt[t].c();w=zt(),b=Lt("li"),v=Lt("p"),v.textContent=`${J("setting.save_to.options.use_fsa")}`,y=zt(),Ye(k.$$.fragment),C=zt(),nt&&nt.c(),A=zt(),E=Lt("section"),_=Lt("p"),S=Dt(Y),P=zt(),I=Lt("ul"),T=Lt("li"),B=Lt("div"),L=Lt("button"),M=Lt("i"),D=zt(),z=Lt("input"),F=zt(),O=Lt("button"),N=Lt("i"),j=zt(),R=Lt("div");for(let t=0;t<it.length;t+=1)it[t].c();H=zt(),st&&st.c(),Nt(a,"class",t[2]),Nt(d,"class","w-6 fill-current"),Nt(c,"type","button"),Nt(c,"class","[&:not([disabled])]:variant-soft-primary"),c.disabled=t[13],Nt(f,"class","w-6 fill-current"),Nt(h,"type","button"),Nt(h,"class","variant-soft-surface [&:not([disabled])]:variant-soft-primary"),h.disabled=t[13],Nt(l,"class","input-group input-group-divider grid-cols-[auto_1fr_auto_auto]"),Nt(m,"class","self-start space-x-2"),Nt(s,"class","flex-col gap-3"),Nt(v,"class","flex-auto"),Nt(i,"class",t[14]),Nt(_,"class",t[2]),Nt(M,"class","w-6 fill-current"),Nt(L,"type","button"),Nt(L,"class","[&:not([disabled])]:variant-soft-primary"),L.disabled=t[12],Nt(z,"type","text"),z.required=!0,Nt(z,"placeholder",J("setting.save_to.placeholder.filename_requried")),Nt(N,"class","w-6 fill-current"),Nt(O,"type","button"),Nt(O,"class","variant-soft-surface dark:variant-fill-surface [&:not([disabled])]:variant-soft-primary"),O.disabled=t[12],Nt(B,"class","input-group input-group-divider grid-cols-[auto_1fr_auto]"),Nt(R,"class","self-start space-x-2"),Nt(T,"class","flex-col gap-3"),Nt(I,"class",t[14]),Nt(e,"class",t[1])},m(x,$){It(x,e,$),_t(e,r),_t(r,a),_t(a,n),_t(r,o),_t(r,i),_t(i,s),_t(s,l),_t(l,c),_t(c,d),d.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z" /></svg>',_t(l,u),Z.m(l,null),_t(l,p),_t(l,h),_t(h,f),f.innerHTML=An,_t(s,g),_t(s,m);for(let t=0;t<tt.length;t+=1)tt[t]&&tt[t].m(m,null);_t(i,w),_t(i,b),_t(b,v),_t(b,y),Ve(k,b,null),_t(i,C),nt&&nt.m(i,null),_t(e,A),_t(e,E),_t(E,_),_t(_,S),_t(E,P),_t(E,I),_t(I,T),_t(T,B),_t(B,L),_t(L,M),M.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z" /></svg>',_t(B,D),_t(B,z),t[33](z),qt(z,t[5]),_t(B,F),_t(B,O),_t(O,N),N.innerHTML=An,_t(T,j),_t(T,R);for(let t=0;t<it.length;t+=1)it[t]&&it[t].m(R,null);_t(I,H),st&&st.m(I,null),U=!0,W||(q=[Ot(c,"click",t[17]),Ot(h,"click",t[15]),Ot(L,"click",t[18]),Ot(z,"input",t[34]),Ot(O,"click",t[16])],W=!0)},p(t,r){if((!U||4&r[0])&&Nt(a,"class",t[2]),(!U||8192&r[0])&&(c.disabled=t[13]),X===(X=Q(t))&&Z?Z.p(t,r):(Z.d(1),Z=X(t),Z&&(Z.c(),Z.m(l,p))),(!U||8192&r[0])&&(h.disabled=t[13]),1048648&r[0]){let e;for(K=He(t[3]),e=0;e<K.length;e+=1){const a=Sn(t,K,e);tt[e]?tt[e].p(a,r):(tt[e]=Tn(a),tt[e].c(),tt[e].m(m,null))}for(;e<tt.length;e+=1)tt[e].d(1);tt.length=K.length}const n={};if(!$&&128&r[0]&&($=!0,n.checked=t[7].useFileSystemAccess,$e((()=>$=!1))),k.$set(n),t[7].useFileSystemAccess?nt?(nt.p(t,r),128&r[0]&&De(nt,1)):(nt=Bn(t),nt.c(),De(nt,1),nt.m(i,null)):nt&&(Le(),ze(nt,1,1,(()=>{nt=null})),Me()),(!U||16384&r[0])&&Nt(i,"class",t[14]),(!U||4&r[0])&&Nt(_,"class",t[2]),(!U||4096&r[0])&&(L.disabled=t[12]),32&r[0]&&z.value!==t[5]&&qt(z,t[5]),(!U||4096&r[0])&&(O.disabled=t[12]),2097160&r[0]){let e;for(ot=He(t[3]),e=0;e<ot.length;e+=1){const a=_n(t,ot,e);it[e]?it[e].p(a,r):(it[e]=Fn(a),it[e].c(),it[e].m(R,null))}for(;e<it.length;e+=1)it[e].d(1);it.length=ot.length}V&&st.p(t,r),(!U||16384&r[0])&&Nt(I,"class",t[14]),(!U||2&r[0])&&Nt(e,"class",t[1])},i(t){U||(De(k.$$.fragment,t),De(nt),De(st),U=!0)},o(t){ze(k.$$.fragment,t),ze(nt),ze(st),U=!1},d(r){r&&Tt(e),Z.d(),Bt(tt,r),Qe(k),nt&&nt.d(),t[33](null),Bt(it,r),st&&st.d(),W=!1,rt(q)}}}function Wn(t,e,r){let a,n,o,i,s,l;ct(t,En,(t=>r(7,l=t)));let c,d,{bg:u="bg-white/30 dark:bg-black/15"}=e,{border:p="divide-y-[1px] *:border-surface-300-600-token"}=e,{padding:f="px-4 *:py-4"}=e,{margin:g="mt-2 *:!m-0"}=e,{rounded:m="rounded-container-token *:!rounded-none"}=e,{descritionText:w="text-sm text-surface-400"}=e,{sectionSpace:b="space-y-4"}=e,{sectionTitle:v="font-bold"}=e,{templates:y=pe("filenameTemplate")}=e,k=l.folderPattern,$=l.filenamePattern,C=T.getCurrentFsaDirName();return t.$$set=t=>{r(39,e=K(K({},e),gt(t))),"bg"in t&&r(22,u=t.bg),"border"in t&&r(23,p=t.border),"padding"in t&&r(24,f=t.padding),"margin"in t&&r(25,g=t.margin),"rounded"in t&&r(26,m=t.rounded),"descritionText"in t&&r(0,w=t.descritionText),"sectionSpace"in t&&r(1,b=t.sectionSpace),"sectionTitle"in t&&r(2,v=t.sectionTitle),"templates"in t&&r(3,y=t.templates)},t.$$.update=()=>{r(14,a=`list *:items-center ${f} ${g} ${p} ${u} ${m} ${e.class??""}`),128&t.$$.dirty[0]&&r(6,n=l.useFileSystemAccess||x.isSupportSubpath()),144&t.$$.dirty[0]&&r(13,o=k===l.folderPattern),160&t.$$.dirty[0]&&r(12,i=$===l.filenamePattern),64&t.$$.dirty[0]&&r(11,s=n?J("setting.save_to.placeholder.sub_directory_unused"):x.isViolentmonkey()?J("setting.save_to.placeholder.vm_not_supported"):J("setting.save_to.placeholder.need_browser_api"))},e=gt(e),[w,b,v,y,k,$,n,l,c,d,C,s,i,o,a,function(){const t=k.split("/").map(h).filter((t=>!!t)).join("/");bt(En,l.folderPattern=r(4,k=t),l)},function(){const t=h($);""===t?r(5,$=l.filenamePattern):bt(En,l.filenamePattern=r(5,$=t),l)},async function(){r(4,k=l.folderPattern),await xe();const t=k.length;c.focus(),c.setSelectionRange(t,t)},async function(){r(5,$=l.filenamePattern),await xe();const t=$.length;d.focus(),d.setSelectionRange(t,t)},async function(){r(10,C=await T.updateDirHandle()),console.log(C)},function(t){return async()=>{const e=c.selectionStart,a=c.selectionEnd;r(4,k=k.slice(0,e)+t+k.slice(a)),await xe();const n=e+t.length;c.focus(),c.setSelectionRange(n,n)}},function(t){return async()=>{const e=d.selectionStart,a=d.selectionEnd;r(5,$=$.slice(0,e)+t+$.slice(a)),await xe();const n=e+t.length;d.focus(),d.setSelectionRange(n,n)}},u,p,f,g,m,function(t){ge[t?"unshift":"push"]((()=>{c=t,r(8,c)}))},function(){k=this.value,r(4,k)},function(e){t.$$.not_equal(l.useFileSystemAccess,e)&&(l.useFileSystemAccess=e,En.set(l))},function(e){t.$$.not_equal(l.fileSystemFilenameConflictAction,e)&&(l.fileSystemFilenameConflictAction=e,En.set(l))},function(e){t.$$.not_equal(l.fileSystemFilenameConflictAction,e)&&(l.fileSystemFilenameConflictAction=e,En.set(l))},function(e){t.$$.not_equal(l.fileSystemFilenameConflictAction,e)&&(l.fileSystemFilenameConflictAction=e,En.set(l))},function(t){ge[t?"unshift":"push"]((()=>{d=t,r(9,d)}))},function(){$=this.value,r(5,$)},function(e){t.$$.not_equal(l.tagLang,e)&&(l.tagLang=e,En.set(l))},function(e){t.$$.not_equal(l.tagLang,e)&&(l.tagLang=e,En.set(l))},function(e){t.$$.not_equal(l.tagLang,e)&&(l.tagLang=e,En.set(l))},function(e){t.$$.not_equal(l.tagLang,e)&&(l.tagLang=e,En.set(l))}]}class qn extends Ke{constructor(t){super(),Je(this,t,Wn,Un,nt,{bg:22,border:23,padding:24,margin:25,rounded:26,descritionText:0,sectionSpace:1,sectionTitle:2,templates:3},null,[-1,-1])}}const Gn=(t,e)=>{if(!(t instanceof HTMLInputElement)||"number"!==t.type)throw new Error('Node should be an HTMLInputElement with a `type` of "number".');const r=r=>{if("key"in e){const{key:t,store:a}=e;a.update((e=>"number"==typeof r?{...e,[t]:r}:e))}else e.update((e=>{if("number"==typeof r)return e===r&&(t.value=""+r),r;return(""===t.value?null:+t.value)!==e&&(t.value="number"==typeof e?""+e:""),e}))};return t.addEventListener("input",(t=>{const e=t.currentTarget,{min:a,max:n,value:o}=e,i=""===a?0:+a,s=""===n?null:+n;if(!e.checkValidity())if(/^[0-9]+$/.test(o)){const t=+o;t<i?r(i):s&&t>s&&r(s)}else r()})),t.addEventListener("blur",(t=>{const e=t.currentTarget,{min:a,value:n}=e;""===n&&r(""===a?0:+a)})),{}};function Yn(t,e,r){const a=t.slice();return a[27]=e[r],a}function Vn(t,e,r){const a=t.slice();return a[27]=e[r],a}function Qn(t){let e;return{c(){e=Dt("Zip")},m(t,r){It(t,e,r)},d(t){t&&Tt(e)}}}function Jn(t){let e;return{c(){e=Dt("Webm")},m(t,r){It(t,e,r)},d(t){t&&Tt(e)}}}function Xn(t){let e;return{c(){e=Dt("Mp4")},m(t,r){It(t,e,r)},d(t){t&&Tt(e)}}}function Zn(t){let e;return{c(){e=Dt("Webp")},m(t,r){It(t,e,r)},d(t){t&&Tt(e)}}}function Kn(t){let e;return{c(){e=Dt("Gif")},m(t,r){It(t,e,r)},d(t){t&&Tt(e)}}}function to(t){let e;return{c(){e=Dt("Png")},m(t,r){It(t,e,r)},d(t){t&&Tt(e)}}}function eo(t){let e,r,a,n,o,i,s,l,c,d,u,p,h,f,g,m,w,b;function v(e){t[13](e)}let y={name:"ugoiraFormat",class:"text-sm",value:$.ZIP,$$slots:{default:[Qn]},$$scope:{ctx:t}};function k(e){t[14](e)}void 0!==t[7].ugoiraFormat&&(y.group=t[7].ugoiraFormat),e=new $a({props:y}),ge.push((()=>Ge(e,"group",v)));let C={name:"ugoiraFormat",class:"text-sm",value:$.WEBM,$$slots:{default:[Jn]},$$scope:{ctx:t}};function A(e){t[15](e)}void 0!==t[7].ugoiraFormat&&(C.group=t[7].ugoiraFormat),n=new $a({props:C}),ge.push((()=>Ge(n,"group",k)));let E={disabled:!x.videoFrameSupported(),class:"text-sm",name:"ugoiraFormat",value:$.MP4,$$slots:{default:[Xn]},$$scope:{ctx:t}};function _(e){t[16](e)}void 0!==t[7].ugoiraFormat&&(E.group=t[7].ugoiraFormat),s=new $a({props:E}),ge.push((()=>Ge(s,"group",A)));let S={name:"ugoiraFormat",class:"text-sm",value:$.WEBP,$$slots:{default:[Zn]},$$scope:{ctx:t}};function P(e){t[17](e)}void 0!==t[7].ugoiraFormat&&(S.group=t[7].ugoiraFormat),d=new $a({props:S}),ge.push((()=>Ge(d,"group",_)));let I={name:"ugoiraFormat",class:"text-sm",value:$.GIF,$$slots:{default:[Kn]},$$scope:{ctx:t}};function T(e){t[18](e)}void 0!==t[7].ugoiraFormat&&(I.group=t[7].ugoiraFormat),h=new $a({props:I}),ge.push((()=>Ge(h,"group",P)));let B={name:"ugoiraFormat",class:"text-sm",value:$.PNG,$$slots:{default:[to]},$$scope:{ctx:t}};return void 0!==t[7].ugoiraFormat&&(B.group=t[7].ugoiraFormat),m=new $a({props:B}),ge.push((()=>Ge(m,"group",T))),{c(){Ye(e.$$.fragment),a=zt(),Ye(n.$$.fragment),i=zt(),Ye(s.$$.fragment),c=zt(),Ye(d.$$.fragment),p=zt(),Ye(h.$$.fragment),g=zt(),Ye(m.$$.fragment)},m(t,r){Ve(e,t,r),It(t,a,r),Ve(n,t,r),It(t,i,r),Ve(s,t,r),It(t,c,r),Ve(d,t,r),It(t,p,r),Ve(h,t,r),It(t,g,r),Ve(m,t,r),b=!0},p(t,a){const i={};2&a[1]&&(i.$$scope={dirty:a,ctx:t}),!r&&128&a[0]&&(r=!0,i.group=t[7].ugoiraFormat,$e((()=>r=!1))),e.$set(i);const c={};2&a[1]&&(c.$$scope={dirty:a,ctx:t}),!o&&128&a[0]&&(o=!0,c.group=t[7].ugoiraFormat,$e((()=>o=!1))),n.$set(c);const p={};2&a[1]&&(p.$$scope={dirty:a,ctx:t}),!l&&128&a[0]&&(l=!0,p.group=t[7].ugoiraFormat,$e((()=>l=!1))),s.$set(p);const g={};2&a[1]&&(g.$$scope={dirty:a,ctx:t}),!u&&128&a[0]&&(u=!0,g.group=t[7].ugoiraFormat,$e((()=>u=!1))),d.$set(g);const b={};2&a[1]&&(b.$$scope={dirty:a,ctx:t}),!f&&128&a[0]&&(f=!0,b.group=t[7].ugoiraFormat,$e((()=>f=!1))),h.$set(b);const v={};2&a[1]&&(v.$$scope={dirty:a,ctx:t}),!w&&128&a[0]&&(w=!0,v.group=t[7].ugoiraFormat,$e((()=>w=!1))),m.$set(v)},i(t){b||(De(e.$$.fragment,t),De(n.$$.fragment,t),De(s.$$.fragment,t),De(d.$$.fragment,t),De(h.$$.fragment,t),De(m.$$.fragment,t),b=!0)},o(t){ze(e.$$.fragment,t),ze(n.$$.fragment,t),ze(s.$$.fragment,t),ze(d.$$.fragment,t),ze(h.$$.fragment,t),ze(m.$$.fragment,t),b=!1},d(t){t&&(Tt(a),Tt(i),Tt(c),Tt(p),Tt(g)),Qe(e,t),Qe(n,t),Qe(s,t),Qe(d,t),Qe(h,t),Qe(m,t)}}}function ro(t){let e,r,a=t[27]+"";return{c(){e=Lt("option"),r=Dt(a),e.__value=t[27],qt(e,e.__value)},m(t,a){It(t,e,a),_t(e,r)},p:X,d(t){t&&Tt(e)}}}function ao(t){let e,r,a=t[27]+1+"";return{c(){e=Lt("option"),r=Dt(a),e.__value=t[27]+1,qt(e,e.__value)},m(t,a){It(t,e,a),_t(e,r)},p:X,d(t){t&&Tt(e)}}}function no(t){let e,r,a,n,o,i,s,l,c,d,u,p,h,f,g,m,w,b,v,y,x,k,$,C,A,E,_,S,P,I,T,B,L,M,D,z,F,O,N,j,R,H,U,W,q,G,Y,V,Q,X,Z,K,tt,et,at,nt,ot,it,st,lt,ct,dt,ut,pt,ht,ft,gt,mt,wt,bt,yt,xt,kt,$t,Ct,At,Et,St,Pt,Mt,Ft,jt,Rt,Ht,Wt,Gt,Vt,Qt,Jt,Xt=J("setting.ugoira.label.format")+"",Zt=J("setting.ugoira.label.quality")+"",Kt=J("setting.ugoira.options.webm_tips")+"",te=J("setting.ugoira.options.webp_quality_tips")+"",ee=J("setting.ugoira.options.webp_method_tips")+"",re=J("setting.ugoira.options.gif_tips")+"",ae=J("setting.ugoira.options.png_tips")+"";function ne(e){t[21](e)}d=new ya({props:{class:"shrink-0",$$slots:{default:[eo]},$$scope:{ctx:t}}});let oe={name:"lossless-webp",size:"sm"};void 0!==t[7].losslessWebp&&(oe.checked=t[7].losslessWebp),W=new Na({props:oe}),ge.push((()=>Ge(W,"checked",ne)));let ie=He(Array.from({length:7},oo)),se=[];for(let e=0;e<ie.length;e+=1)se[e]=ro(Vn(t,ie,e));let le=He(Array.from({length:20},io)),ce=[];for(let e=0;e<le.length;e+=1)ce[e]=ao(Yn(t,le,e));return{c(){e=Lt("div"),r=Lt("section"),a=Lt("p"),n=Dt(Xt),o=zt(),i=Lt("ul"),s=Lt("li"),l=Lt("p"),l.textContent=`${J("setting.ugoira.options.select_format")}`,c=zt(),Ye(d.$$.fragment),u=zt(),p=Lt("section"),h=Lt("p"),f=Dt(Zt),g=zt(),m=Lt("ul"),w=Lt("li"),b=Lt("div"),v=Lt("p"),v.textContent="Webm",y=zt(),x=Lt("p"),k=Dt(Kt),$=zt(),C=Lt("input"),E=zt(),_=Lt("li"),S=Lt("div"),P=Lt("p"),P.textContent="Mp4",I=zt(),T=Lt("p"),B=Dt("Bitrate (Mbps)"),L=zt(),M=Lt("input"),z=zt(),F=Lt("li"),O=Lt("p"),O.textContent="Webp",N=zt(),j=Lt("ul"),R=Lt("li"),H=Lt("p"),H.textContent=`${J("setting.ugoira.options.webp_lossy")}`,U=zt(),Ye(W.$$.fragment),G=zt(),Y=Lt("li"),V=Lt("div"),Q=Lt("p"),Q.textContent=`${J("setting.ugoira.options.webp_quality")}`,X=zt(),Z=Lt("p"),K=Dt(te),tt=zt(),et=Lt("input"),nt=zt(),ot=Lt("li"),it=Lt("div"),st=Lt("p"),st.textContent=`${J("setting.ugoira.options.webp_method")}`,lt=zt(),ct=Lt("p"),dt=Dt(ee),ut=zt(),pt=Lt("select");for(let t=0;t<se.length;t+=1)se[t].c();gt=zt(),mt=Lt("li"),wt=Lt("div"),bt=Lt("p"),bt.textContent="Gif",yt=zt(),xt=Lt("p"),kt=Dt(re),$t=zt(),Ct=Lt("select");for(let t=0;t<ce.length;t+=1)ce[t].c();Et=zt(),St=Lt("li"),Pt=Lt("div"),Mt=Lt("p"),Mt.textContent="Png",Ft=zt(),jt=Lt("p"),Rt=Dt(ae),Ht=zt(),Wt=Lt("input"),Nt(a,"class",t[4]),Nt(l,"class","flex-auto"),Nt(i,"class",t[6]),Nt(h,"class",t[4]),Nt(x,"class",t[2]),Nt(b,"class","flex-auto"),Nt(C,"type","number"),Nt(C,"class",A="input "+t[5]),Nt(C,"min","0"),Nt(C,"max","99"),Nt(C,"step","1"),Nt(T,"class",t[2]),Nt(S,"class","flex-auto"),Nt(M,"type","number"),Nt(M,"class",D="input "+t[5]),Nt(M,"min","1"),Nt(M,"max","99"),Nt(M,"step","1"),Nt(H,"class","flex-auto"),Nt(R,"class","items-center"),Nt(Z,"class",t[2]),Nt(V,"class","flex-auto"),Nt(et,"type","number"),Nt(et,"class",at="input "+t[5]),Nt(et,"min","0"),Nt(et,"max","100"),Nt(et,"step","1"),Nt(Y,"class","items-center"),Nt(ct,"class",t[2]),Nt(it,"class","flex-auto"),Nt(pt,"class",ht="select "+t[5]),void 0===t[7].webpMehtod&&ke((()=>t[23].call(pt))),Nt(ot,"class","items-center"),Nt(j,"class",ft="list "+t[0]+" "+t[1]+" [&:not(:last-child)]:*:py-4 [&:last-child]:*:pt-4"),Nt(F,"class","flex-col !items-stretch"),Nt(xt,"class",t[2]),Nt(wt,"class","flex-auto"),Nt(Ct,"class",At="select "+t[5]),void 0===t[7].gifQuality&&ke((()=>t[24].call(Ct))),Nt(jt,"class",t[2]),Nt(Pt,"class","flex-auto"),Nt(Wt,"type","number"),Nt(Wt,"class",Gt="input "+t[5]),Nt(Wt,"min","0"),Nt(Wt,"max","256"),Nt(Wt,"step","1"),Nt(m,"class",t[6]),Nt(e,"class",t[3])},m(A,D){It(A,e,D),_t(e,r),_t(r,a),_t(a,n),_t(r,o),_t(r,i),_t(i,s),_t(s,l),_t(s,c),Ve(d,s,null),_t(e,u),_t(e,p),_t(p,h),_t(h,f),_t(p,g),_t(p,m),_t(m,w),_t(w,b),_t(b,v),_t(b,y),_t(b,x),_t(x,k),_t(w,$),_t(w,C),qt(C,t[7].webmQuality),_t(m,E),_t(m,_),_t(_,S),_t(S,P),_t(S,I),_t(S,T),_t(T,B),_t(_,L),_t(_,M),qt(M,t[7].mp4Bitrate),_t(m,z),_t(m,F),_t(F,O),_t(F,N),_t(F,j),_t(j,R),_t(R,H),_t(R,U),Ve(W,R,null),_t(j,G),_t(j,Y),_t(Y,V),_t(V,Q),_t(V,X),_t(V,Z),_t(Z,K),_t(Y,tt),_t(Y,et),qt(et,t[7].webpQuality),_t(j,nt),_t(j,ot),_t(ot,it),_t(it,st),_t(it,lt),_t(it,ct),_t(ct,dt),_t(ot,ut),_t(ot,pt);for(let t=0;t<se.length;t+=1)se[t]&&se[t].m(pt,null);Yt(pt,t[7].webpMehtod,!0),_t(m,gt),_t(m,mt),_t(mt,wt),_t(wt,bt),_t(wt,yt),_t(wt,xt),_t(xt,kt),_t(mt,$t),_t(mt,Ct);for(let t=0;t<ce.length;t+=1)ce[t]&&ce[t].m(Ct,null);Yt(Ct,t[7].gifQuality,!0),_t(m,Et),_t(m,St),_t(St,Pt),_t(Pt,Mt),_t(Pt,Ft),_t(Pt,jt),_t(jt,Rt),_t(St,Ht),_t(St,Wt),qt(Wt,t[7].pngColor),Vt=!0,Qt||(Jt=[vt(Gn.call(null,C,{store:En,key:"webmQuality"})),Ot(C,"input",t[19]),vt(Gn.call(null,M,{store:En,key:"mp4Bitrate"})),Ot(M,"input",t[20]),vt(Gn.call(null,et,{store:En,key:"webpQuality"})),Ot(et,"input",t[22]),Ot(pt,"change",t[23]),Ot(Ct,"change",t[24]),vt(Gn.call(null,Wt,{store:En,key:"pngColor"})),Ot(Wt,"input",t[25])],Qt=!0)},p(t,r){(!Vt||16&r[0])&&Nt(a,"class",t[4]);const n={};128&r[0]|2&r[1]&&(n.$$scope={dirty:r,ctx:t}),d.$set(n),(!Vt||64&r[0])&&Nt(i,"class",t[6]),(!Vt||16&r[0])&&Nt(h,"class",t[4]),(!Vt||4&r[0])&&Nt(x,"class",t[2]),(!Vt||32&r[0]&&A!==(A="input "+t[5]))&&Nt(C,"class",A),128&r[0]&&Ut(C.value)!==t[7].webmQuality&&qt(C,t[7].webmQuality),(!Vt||4&r[0])&&Nt(T,"class",t[2]),(!Vt||32&r[0]&&D!==(D="input "+t[5]))&&Nt(M,"class",D),128&r[0]&&Ut(M.value)!==t[7].mp4Bitrate&&qt(M,t[7].mp4Bitrate);const o={};!q&&128&r[0]&&(q=!0,o.checked=t[7].losslessWebp,$e((()=>q=!1))),W.$set(o),(!Vt||4&r[0])&&Nt(Z,"class",t[2]),(!Vt||32&r[0]&&at!==(at="input "+t[5]))&&Nt(et,"class",at),128&r[0]&&Ut(et.value)!==t[7].webpQuality&&qt(et,t[7].webpQuality),(!Vt||4&r[0])&&Nt(ct,"class",t[2]),(!Vt||32&r[0]&&ht!==(ht="select "+t[5]))&&Nt(pt,"class",ht),128&r[0]&&Yt(pt,t[7].webpMehtod),(!Vt||3&r[0]&&ft!==(ft="list "+t[0]+" "+t[1]+" [&:not(:last-child)]:*:py-4 [&:last-child]:*:pt-4"))&&Nt(j,"class",ft),(!Vt||4&r[0])&&Nt(xt,"class",t[2]),(!Vt||32&r[0]&&At!==(At="select "+t[5]))&&Nt(Ct,"class",At),128&r[0]&&Yt(Ct,t[7].gifQuality),(!Vt||4&r[0])&&Nt(jt,"class",t[2]),(!Vt||32&r[0]&&Gt!==(Gt="input "+t[5]))&&Nt(Wt,"class",Gt),128&r[0]&&Ut(Wt.value)!==t[7].pngColor&&qt(Wt,t[7].pngColor),(!Vt||64&r[0])&&Nt(m,"class",t[6]),(!Vt||8&r[0])&&Nt(e,"class",t[3])},i(t){Vt||(De(d.$$.fragment,t),De(W.$$.fragment,t),Vt=!0)},o(t){ze(d.$$.fragment,t),ze(W.$$.fragment,t),Vt=!1},d(t){t&&Tt(e),Qe(d),Qe(W),Bt(se,t),Bt(ce,t),Qt=!1,rt(Jt)}}}const oo=(t,e)=>e,io=(t,e)=>e;function so(t,e,r){let a,n,o;ct(t,En,(t=>r(7,o=t)));let{bg:i="bg-white/30 dark:bg-black/15"}=e,{border:s="divide-y-[1px] *:border-surface-300-600-token"}=e,{padding:l="px-4 *:py-4"}=e,{margin:c="mt-2 *:!m-0"}=e,{rounded:d="rounded-container-token *:!rounded-none"}=e,{descriptionText:u="text-sm text-surface-400"}=e,{inputRounded:p="rounded-full"}=e,{inputWidth:h="w-32"}=e,{sectionSpace:f="space-y-4"}=e,{sectionTitle:g="font-bold"}=e;return t.$$set=t=>{r(26,e=K(K({},e),gt(t))),"bg"in t&&r(8,i=t.bg),"border"in t&&r(0,s=t.border),"padding"in t&&r(9,l=t.padding),"margin"in t&&r(10,c=t.margin),"rounded"in t&&r(1,d=t.rounded),"descriptionText"in t&&r(2,u=t.descriptionText),"inputRounded"in t&&r(11,p=t.inputRounded),"inputWidth"in t&&r(12,h=t.inputWidth),"sectionSpace"in t&&r(3,f=t.sectionSpace),"sectionTitle"in t&&r(4,g=t.sectionTitle)},t.$$.update=()=>{r(6,a=`list *:items-center ${l} ${c} ${s} ${i} ${d} ${e.class??""}`),6144&t.$$.dirty[0]&&r(5,n=`${h} ${p} shrink-0`)},e=gt(e),[s,d,u,f,g,n,a,o,i,l,c,p,h,function(e){t.$$.not_equal(o.ugoiraFormat,e)&&(o.ugoiraFormat=e,En.set(o))},function(e){t.$$.not_equal(o.ugoiraFormat,e)&&(o.ugoiraFormat=e,En.set(o))},function(e){t.$$.not_equal(o.ugoiraFormat,e)&&(o.ugoiraFormat=e,En.set(o))},function(e){t.$$.not_equal(o.ugoiraFormat,e)&&(o.ugoiraFormat=e,En.set(o))},function(e){t.$$.not_equal(o.ugoiraFormat,e)&&(o.ugoiraFormat=e,En.set(o))},function(e){t.$$.not_equal(o.ugoiraFormat,e)&&(o.ugoiraFormat=e,En.set(o))},function(){o.webmQuality=Ut(this.value),En.set(o)},function(){o.mp4Bitrate=Ut(this.value),En.set(o)},function(e){t.$$.not_equal(o.losslessWebp,e)&&(o.losslessWebp=e,En.set(o))},function(){o.webpQuality=Ut(this.value),En.set(o)},function(){o.webpMehtod=Qt(this),En.set(o)},function(){o.gifQuality=Qt(this),En.set(o)},function(){o.pngColor=Ut(this.value),En.set(o)}]}class lo extends Ke{constructor(t){super(),Je(this,t,so,no,nt,{bg:8,border:0,padding:9,margin:10,rounded:1,descriptionText:2,inputRounded:11,inputWidth:12,sectionSpace:3,sectionTitle:4},null,[-1,-1])}}function co(t){return function(t,e){return new Promise((r=>{if(e.type!==t)throw new Error("Invalid file");const a=new FileReader;a.readAsText(e),a.onload=t=>{var e;const a=null==(e=t.target)?void 0:e.result;if("string"!=typeof a)throw new Error("Invalid file");const n=JSON.parse(a);if(!(n instanceof Array))throw new Error("Invalid file");r(n)}}))}("application/json",t).then((t=>M.import(t)))}function uo(){return M.getAll().then((t=>{const e=JSON.stringify(t);w(new Blob([e],{type:"application/json"}),`Pixiv Downloader_${location.hostname}_${(new Date).toLocaleString()}.json`)}))}function po(){return M.generateCsv().then((t=>{w(t,`Pixiv Downloader_${location.hostname}_${(new Date).toLocaleString()}.csv`)}))}function ho(){const t=_.get("historyBackupInterval");if(t===E.NEVER)return;const e=_.get("lastHistoryBackup"),r=(new Date).getTime();(!e||e+1e3*t<r)&&(uo(),_.set("lastHistoryBackup",r))}function fo(){return{importJSON:co,exportAsJSON:uo,exportAsCSV:po,scheduleBackup:ho}}function go(t){let e,r;return e=new wa({props:{stroke:80,width:"w-5",meter:"stroke-primary-500",track:"stroke-primary-500/30"}}),{c(){Ye(e.$$.fragment)},m(t,a){Ve(e,t,a),r=!0},i(t){r||(De(e.$$.fragment,t),r=!0)},o(t){ze(e.$$.fragment,t),r=!1},d(t){Qe(e,t)}}}function mo(t){let e,r;return e=new wa({props:{stroke:80,width:"w-5",meter:"stroke-primary-500",track:"stroke-primary-500/30"}}),{c(){Ye(e.$$.fragment)},m(t,a){Ve(e,t,a),r=!0},i(t){r||(De(e.$$.fragment,t),r=!0)},o(t){ze(e.$$.fragment,t),r=!1},d(t){Qe(e,t)}}}function wo(t){let e,r;return e=new wa({props:{stroke:80,width:"w-5",meter:"stroke-primary-500",track:"stroke-primary-500/30"}}),{c(){Ye(e.$$.fragment)},m(t,a){Ve(e,t,a),r=!0},i(t){r||(De(e.$$.fragment,t),r=!0)},o(t){ze(e.$$.fragment,t),r=!1},d(t){Qe(e,t)}}}function bo(t){let e,r,a,n=t[7]&&wo();return{c(){n&&n.c(),e=zt(),r=Lt("span"),r.textContent=`${J("setting.history.button.import")}`},m(t,o){n&&n.m(t,o),It(t,e,o),It(t,r,o),a=!0},p(t,r){t[7]?n?128&r[0]&&De(n,1):(n=wo(),n.c(),De(n,1),n.m(e.parentNode,e)):n&&(Le(),ze(n,1,1,(()=>{n=null})),Me())},i(t){a||(De(n),a=!0)},o(t){ze(n),a=!1},d(t){t&&(Tt(e),Tt(r)),n&&n.d(t)}}}function vo(t){let e,r;return e=new wa({props:{stroke:80,width:"w-5",meter:"stroke-primary-500",track:"stroke-primary-500/30"}}),{c(){Ye(e.$$.fragment)},m(t,a){Ve(e,t,a),r=!0},i(t){r||(De(e.$$.fragment,t),r=!0)},o(t){ze(e.$$.fragment,t),r=!1},d(t){Qe(e,t)}}}function yo(t){let e,r,a,n,o,i,s,l,c,d,u,p,h,f,g,m,w,b,v,y,x,k,$,C,A,_,S,P,I,T,B,L,M,D,z,F,O,N,j,R,H,U,W,q,G,Y,V,Q,X,Z,K,tt,et,at,nt,ot,it,st,lt,ct,dt=J("setting.history.label.scheduled_backups")+"",ut=J("setting.history.label.export")+"",pt=J("setting.history.label.import")+"",ht=J("setting.history.label.clear")+"",ft=t[5]&&go(),gt=t[6]&&mo();function mt(e){t[25](e)}let wt={name:"import-file",accept:".json",$$slots:{default:[bo]},$$scope:{ctx:t}};void 0!==t[7]&&(wt.disabled=t[7]),q=new Fr({props:wt}),ge.push((()=>Ge(q,"disabled",mt))),q.$on("change",t[10]);let bt=t[8]&&vo();return{c(){e=Lt("div"),r=Lt("section"),a=Lt("p"),n=Dt(dt),o=zt(),i=Lt("ul"),s=Lt("li"),l=Lt("p"),l.textContent=`${J("setting.history.options.scheduled_backups")}`,c=zt(),d=Lt("select"),u=Lt("option"),u.textContent=`${J("setting.history.select.backup_interval_never")}`,p=Lt("option"),p.textContent=`${J("setting.history.select.backup_interval_every_day")}`,h=Lt("option"),h.textContent=`${J("setting.history.select.backup_interval_every_7_day")}`,f=Lt("option"),f.textContent=`${J("setting.history.select.backup_interval_every_30_day")}`,m=zt(),w=Lt("section"),b=Lt("p"),v=Dt(ut),y=zt(),x=Lt("ul"),k=Lt("li"),$=Lt("p"),$.textContent=`${J("setting.history.options.export_as_json")}`,C=zt(),A=Lt("button"),ft&&ft.c(),_=zt(),S=Lt("span"),S.textContent=`${J("setting.history.button.export")}`,P=zt(),I=Lt("li"),T=Lt("p"),T.textContent=`${J("setting.history.options.export_as_csv")}`,B=zt(),L=Lt("button"),gt&&gt.c(),M=zt(),D=Lt("span"),D.textContent=`${J("setting.history.button.export")}`,z=zt(),F=Lt("section"),O=Lt("p"),N=Dt(pt),j=zt(),R=Lt("ul"),H=Lt("li"),U=Lt("p"),U.textContent=`${J("setting.history.options.import_json")}`,W=zt(),Ye(q.$$.fragment),Y=zt(),V=Lt("section"),Q=Lt("p"),X=Dt(ht),Z=zt(),K=Lt("ul"),tt=Lt("li"),et=Lt("p"),et.textContent=`${J("setting.history.options.clear_history")}`,at=zt(),nt=Lt("button"),bt&&bt.c(),ot=zt(),it=Lt("span"),it.textContent=`${J("setting.history.button.clear")}`,Nt(a,"class",t[1]),Nt(l,"class","flex-auto"),u.__value=E.NEVER,qt(u,u.__value),p.__value=E.EVERY_DAY,qt(p,p.__value),h.__value=E.EVERY_7_DAY,qt(h,h.__value),f.__value=E.EVERY_30_DAY,qt(f,f.__value),Nt(d,"class",g="select "+t[2]),void 0===t[4].historyBackupInterval&&ke((()=>t[24].call(d))),Nt(i,"class",t[3]),Nt(b,"class",t[1]),Nt($,"class","flex-auto"),A.disabled=t[5],Nt(A,"class","btn variant-filled"),Nt(T,"class","flex-auto"),L.disabled=t[6],Nt(L,"class","btn variant-filled"),Nt(x,"class",t[3]),Nt(O,"class",t[1]),Nt(U,"class","flex-auto"),Nt(R,"class",t[3]),Nt(Q,"class",t[1]),Nt(et,"class","flex-auto"),nt.disabled=t[8],Nt(nt,"class","btn variant-filled"),Nt(K,"class",t[3]),Nt(e,"class",t[0])},m(g,E){It(g,e,E),_t(e,r),_t(r,a),_t(a,n),_t(r,o),_t(r,i),_t(i,s),_t(s,l),_t(s,c),_t(s,d),_t(d,u),_t(d,p),_t(d,h),_t(d,f),Yt(d,t[4].historyBackupInterval,!0),_t(e,m),_t(e,w),_t(w,b),_t(b,v),_t(w,y),_t(w,x),_t(x,k),_t(k,$),_t(k,C),_t(k,A),ft&&ft.m(A,null),_t(A,_),_t(A,S),_t(x,P),_t(x,I),_t(I,T),_t(I,B),_t(I,L),gt&&gt.m(L,null),_t(L,M),_t(L,D),_t(e,z),_t(e,F),_t(F,O),_t(O,N),_t(F,j),_t(F,R),_t(R,H),_t(H,U),_t(H,W),Ve(q,H,null),_t(e,Y),_t(e,V),_t(V,Q),_t(Q,X),_t(V,Z),_t(V,K),_t(K,tt),_t(tt,et),_t(tt,at),_t(tt,nt),bt&&bt.m(nt,null),_t(nt,ot),_t(nt,it),st=!0,lt||(ct=[Ot(d,"change",t[24]),Ot(A,"click",t[14]),Ot(L,"click",t[16]),Ot(nt,"click",t[12])],lt=!0)},p(t,r){(!st||2&r[0])&&Nt(a,"class",t[1]),(!st||4&r[0]&&g!==(g="select "+t[2]))&&Nt(d,"class",g),16&r[0]&&Yt(d,t[4].historyBackupInterval),(!st||8&r[0])&&Nt(i,"class",t[3]),(!st||2&r[0])&&Nt(b,"class",t[1]),t[5]?ft?32&r[0]&&De(ft,1):(ft=go(),ft.c(),De(ft,1),ft.m(A,_)):ft&&(Le(),ze(ft,1,1,(()=>{ft=null})),Me()),(!st||32&r[0])&&(A.disabled=t[5]),t[6]?gt?64&r[0]&&De(gt,1):(gt=mo(),gt.c(),De(gt,1),gt.m(L,M)):gt&&(Le(),ze(gt,1,1,(()=>{gt=null})),Me()),(!st||64&r[0])&&(L.disabled=t[6]),(!st||8&r[0])&&Nt(x,"class",t[3]),(!st||2&r[0])&&Nt(O,"class",t[1]);const n={};128&r[0]|4&r[1]&&(n.$$scope={dirty:r,ctx:t}),!G&&128&r[0]&&(G=!0,n.disabled=t[7],$e((()=>G=!1))),q.$set(n),(!st||8&r[0])&&Nt(R,"class",t[3]),(!st||2&r[0])&&Nt(Q,"class",t[1]),t[8]?bt?256&r[0]&&De(bt,1):(bt=vo(),bt.c(),De(bt,1),bt.m(nt,ot)):bt&&(Le(),ze(bt,1,1,(()=>{bt=null})),Me()),(!st||256&r[0])&&(nt.disabled=t[8]),(!st||8&r[0])&&Nt(K,"class",t[3]),(!st||1&r[0])&&Nt(e,"class",t[0])},i(t){st||(De(ft),De(gt),De(q.$$.fragment,t),De(bt),st=!0)},o(t){ze(ft),ze(gt),ze(q.$$.fragment,t),ze(bt),st=!1},d(t){t&&Tt(e),ft&&ft.d(),gt&&gt.d(),Qe(q),bt&&bt.d(),lt=!1,rt(ct)}}}function xo(t,e,r){let a,n,o,i,s,l,c;ct(t,En,(t=>r(4,o=t)));let{bg:d="bg-white/30 dark:bg-black/15"}=e,{border:p="divide-y-[1px] *:border-surface-300-600-token"}=e,{padding:h="px-4 *:py-4"}=e,{margin:f="mt-2 *:!m-0"}=e,{rounded:g="rounded-container-token *:!rounded-none"}=e,{inputRounded:m="rounded-full"}=e,{inputWidth:w="w-32"}=e,{sectionSpace:b="space-y-4"}=e,{sectionTitle:v="font-bold"}=e;function y(t){const e=rr(!1);return{store:e,wrapFn:async(...r)=>{e.set(!0);const a=await t(...r);return e.set(!1),a}}}const{importJSON:x,exportAsJSON:k,exportAsCSV:$}=fo(),{store:C,wrapFn:A}=y((async function(t){var e;const r=null==(e=t.currentTarget.files)?void 0:e[0];if(r)try{await x(r)}catch(t){u.error(t),alert(t)}}));ct(t,C,(t=>r(7,l=t)));const{store:E,wrapFn:_}=y((function(){if(confirm(J("setting.history.text.confirm_clear_history")))return M.clear()}));ct(t,E,(t=>r(8,c=t)));const{store:S,wrapFn:P}=y(k);ct(t,S,(t=>r(5,i=t)));const{store:I,wrapFn:T}=y($);return ct(t,I,(t=>r(6,s=t))),t.$$set=t=>{r(32,e=K(K({},e),gt(t))),"bg"in t&&r(17,d=t.bg),"border"in t&&r(18,p=t.border),"padding"in t&&r(19,h=t.padding),"margin"in t&&r(20,f=t.margin),"rounded"in t&&r(21,g=t.rounded),"inputRounded"in t&&r(22,m=t.inputRounded),"inputWidth"in t&&r(23,w=t.inputWidth),"sectionSpace"in t&&r(0,b=t.sectionSpace),"sectionTitle"in t&&r(1,v=t.sectionTitle)},t.$$.update=()=>{r(3,a=`list *:items-center ${h} ${f} ${p} ${d} ${g} ${e.class??""}`),12582912&t.$$.dirty[0]&&r(2,n=`${w} ${m} shrink-0`)},e=gt(e),[b,v,n,a,o,i,s,l,c,C,A,E,_,S,P,I,T,d,p,h,f,g,m,w,function(){o.historyBackupInterval=Qt(this),En.set(o)},function(t){l=t,C.set(l)}]}class ko extends Ke{constructor(t){super(),Je(this,t,xo,yo,nt,{bg:17,border:18,padding:19,margin:20,rounded:21,inputRounded:22,inputWidth:23,sectionSpace:0,sectionTitle:1},null,[-1,-1])}}function $o(t){let e,r,a,n,o,i,s;return{c(){e=Lt("div"),r=Lt("p"),r.textContent=`${J("setting.button_position.options.horizon_position")}`,a=zt(),n=Lt("div"),o=Dt(t[3]),i=Dt(" / "),s=Dt(So),Nt(n,"class","text-xs"),Nt(e,"class","flex justify-between items-center")},m(t,l){It(t,e,l),_t(e,r),_t(e,a),_t(e,n),_t(n,o),_t(n,i),_t(n,s)},p(t,e){8&e&&Wt(o,t[3])},d(t){t&&Tt(e)}}}function Co(t){let e,r,a,n,o,i,s;return{c(){e=Lt("div"),r=Lt("p"),r.textContent=`${J("setting.button_position.options.vertical_position")}`,a=zt(),n=Lt("div"),o=Dt(t[4]),i=Dt(" / "),s=Dt(So),Nt(n,"class","text-xs"),Nt(e,"class","flex justify-between items-center")},m(t,l){It(t,e,l),_t(e,r),_t(e,a),_t(e,n),_t(n,o),_t(n,i),_t(n,s)},p(t,e){16&e&&Wt(o,t[4])},d(t){t&&Tt(e)}}}function Ao(t){let e,r,a,n,o,i,s;return{c(){e=Lt("div"),r=Lt("p"),r.textContent=`${J("setting.button_position.options.horizon_position")}`,a=zt(),n=Lt("div"),o=Dt(t[5]),i=Dt(" / "),s=Dt(So),Nt(n,"class","text-xs"),Nt(e,"class","flex justify-between items-center")},m(t,l){It(t,e,l),_t(e,r),_t(e,a),_t(e,n),_t(n,o),_t(n,i),_t(n,s)},p(t,e){32&e&&Wt(o,t[5])},d(t){t&&Tt(e)}}}function Eo(t){let e,r,a,n,o,i,s;return{c(){e=Lt("div"),r=Lt("p"),r.textContent=`${J("setting.button_position.options.vertical_position")}`,a=zt(),n=Lt("div"),o=Dt(t[6]),i=Dt(" / "),s=Dt(So),Nt(n,"class","text-xs"),Nt(e,"class","flex justify-between items-center")},m(t,l){It(t,e,l),_t(e,r),_t(e,a),_t(e,n),_t(n,o),_t(n,i),_t(n,s)},p(t,e){64&e&&Wt(o,t[6])},d(t){t&&Tt(e)}}}function _o(t){let e,r,a,n,o,i,s,l,c,d,u,p,h,f,g,m,w,b,v=J("setting.button_position.label.common")+"",y=x.isPixiv();function k(e){t[15](e)}let $={name:"pdl-btn-left",step:Po,max:So,ticked:!0,class:"flex-grow",$$slots:{default:[$o]},$$scope:{ctx:t}};function C(e){t[17](e)}void 0!==t[3]&&($.value=t[3]),p=new Da({props:$}),ge.push((()=>Ge(p,"value",k))),p.$on("change",t[16]);let A={name:"pdl-btn-top",step:Po,max:So,ticked:!0,class:"flex-grow",$$slots:{default:[Co]},$$scope:{ctx:t}};void 0!==t[4]&&(A.value=t[4]),g=new Da({props:A}),ge.push((()=>Ge(g,"value",C))),g.$on("change",t[18]);let E=y&&function(t){let e,r,a,n,o,i,s,l,c,d,u,p,h=J("setting.button_position.label.my_bookmark")+"";function f(e){t[19](e)}let g={name:"pdl-bookmark-btn-left",step:Po,max:So,ticked:!0,class:"flex-grow",$$slots:{default:[Ao]},$$scope:{ctx:t}};function m(e){t[21](e)}void 0!==t[5]&&(g.value=t[5]),s=new Da({props:g}),ge.push((()=>Ge(s,"value",f))),s.$on("change",t[20]);let w={name:"pdl-bookmark-btn-top",step:Po,max:So,ticked:!0,class:"flex-grow",$$slots:{default:[Eo]},$$scope:{ctx:t}};return void 0!==t[6]&&(w.value=t[6]),d=new Da({props:w}),ge.push((()=>Ge(d,"value",m))),d.$on("change",t[22]),{c(){e=Lt("section"),r=Lt("p"),a=Dt(h),n=zt(),o=Lt("ul"),i=Lt("li"),Ye(s.$$.fragment),c=zt(),Ye(d.$$.fragment),Nt(r,"class",t[2]),Nt(i,"class","flex-col !items-stretch md:flex-row md:!items-baseline gap-4 *:!m-0"),Nt(o,"class",t[8])},m(t,l){It(t,e,l),_t(e,r),_t(r,a),_t(e,n),_t(e,o),_t(o,i),Ve(s,i,null),_t(i,c),Ve(d,i,null),p=!0},p(t,e){(!p||4&e)&&Nt(r,"class",t[2]);const a={};33554464&e&&(a.$$scope={dirty:e,ctx:t}),!l&&32&e&&(l=!0,a.value=t[5],$e((()=>l=!1))),s.$set(a);const n={};33554496&e&&(n.$$scope={dirty:e,ctx:t}),!u&&64&e&&(u=!0,n.value=t[6],$e((()=>u=!1))),d.$set(n),(!p||256&e)&&Nt(o,"class",t[8])},i(t){p||(De(s.$$.fragment,t),De(d.$$.fragment,t),p=!0)},o(t){ze(s.$$.fragment,t),ze(d.$$.fragment,t),p=!1},d(t){t&&Tt(e),Qe(s),Qe(d)}}}(t);return{c(){e=Lt("div"),r=Lt("div"),a=Lt("div"),o=zt(),i=Lt("section"),s=Lt("p"),l=Dt(v),c=zt(),d=Lt("ul"),u=Lt("li"),Ye(p.$$.fragment),f=zt(),Ye(g.$$.fragment),w=zt(),E&&E.c(),Nt(a,"class",n="w-48 h-48 backdrop-blur-sm rounded-lg relative "+t[0]),Nt(r,"class","flex items-center justify-center"),Nt(s,"class",t[2]),Nt(u,"class","flex-col !items-stretch md:flex-row md:!items-baseline gap-4 *:!m-0"),Nt(d,"class",t[8]),Nt(e,"class",t[1])},m(n,h){It(n,e,h),_t(e,r),_t(r,a),t[14](a),_t(e,o),_t(e,i),_t(i,s),_t(s,l),_t(i,c),_t(i,d),_t(d,u),Ve(p,u,null),_t(u,f),Ve(g,u,null),_t(e,w),E&&E.m(e,null),b=!0},p(t,[r]){(!b||1&r&&n!==(n="w-48 h-48 backdrop-blur-sm rounded-lg relative "+t[0]))&&Nt(a,"class",n),(!b||4&r)&&Nt(s,"class",t[2]);const o={};33554440&r&&(o.$$scope={dirty:r,ctx:t}),!h&&8&r&&(h=!0,o.value=t[3],$e((()=>h=!1))),p.$set(o);const i={};33554448&r&&(i.$$scope={dirty:r,ctx:t}),!m&&16&r&&(m=!0,i.value=t[4],$e((()=>m=!1))),g.$set(i),(!b||256&r)&&Nt(d,"class",t[8]),y&&E.p(t,r),(!b||2&r)&&Nt(e,"class",t[1])},i(t){b||(De(p.$$.fragment,t),De(g.$$.fragment,t),De(E),b=!0)},o(t){ze(p.$$.fragment,t),ze(g.$$.fragment,t),ze(E),b=!1},d(r){r&&Tt(e),t[14](null),Qe(p),Qe(g),E&&E.d()}}}const So=100,Po=4;function Io(t,e){document.documentElement.style.setProperty(t,String(e))}function To(t,e,r){let a,n;ct(t,En,(t=>r(23,n=t)));let o,{bg:i="bg-white/30 dark:bg-black/15"}=e,{border:s="divide-y-[1px] *:border-surface-300-600-token"}=e,{padding:l="px-4 *:py-4"}=e,{margin:c="mt-2 *:!m-0"}=e,{rounded:d="rounded-container-token *:!rounded-none"}=e,{sectionSpace:u="space-y-4"}=e,{sectionTitle:p="font-bold"}=e,h=n["pdl-btn-left"],f=n["pdl-btn-top"],g=n["pdl-btn-self-bookmark-left"],m=n["pdl-btn-self-bookmark-top"];function w(t,e){bt(En,n[t]=e,n)}le((()=>{const t=new R({id:"0",shouldObserveDb:!1,onClick:()=>{}});if(t.setAttribute("disabled",""),o.appendChild(t),!x.isPixiv())return;const e=new R({id:"0",type:j.PixivMyBookmark,shouldObserveDb:!1,onClick:()=>{}});e.setAttribute("disabled",""),e.setStatus(N.Complete),o.appendChild(e)}));return t.$$set=t=>{r(24,e=K(K({},e),gt(t))),"bg"in t&&r(0,i=t.bg),"border"in t&&r(10,s=t.border),"padding"in t&&r(11,l=t.padding),"margin"in t&&r(12,c=t.margin),"rounded"in t&&r(13,d=t.rounded),"sectionSpace"in t&&r(1,u=t.sectionSpace),"sectionTitle"in t&&r(2,p=t.sectionTitle)},t.$$.update=()=>{r(8,a=`list *:items-center ${l} ${c} ${s} ${i} ${d} ${e.class??""}`),8&t.$$.dirty&&Io("--pdl-btn-left",h),16&t.$$.dirty&&Io("--pdl-btn-top",f),32&t.$$.dirty&&Io("--pdl-btn-self-bookmark-left",g),64&t.$$.dirty&&Io("--pdl-btn-self-bookmark-top",m)},e=gt(e),[i,u,p,h,f,g,m,o,a,w,s,l,c,d,function(t){ge[t?"unshift":"push"]((()=>{o=t,r(7,o)}))},function(t){h=t,r(3,h)},()=>w("pdl-btn-left",h),function(t){f=t,r(4,f)},()=>w("pdl-btn-top",f),function(t){g=t,r(5,g)},()=>w("pdl-btn-self-bookmark-left",g),function(t){m=t,r(6,m)},()=>w("pdl-btn-self-bookmark-top",m)]}class Bo extends Ke{constructor(t){super(),Je(this,t,To,_o,nt,{bg:0,border:10,padding:11,margin:12,rounded:13,sectionSpace:1,sectionTitle:2})}}function Lo(t){let e,r,a,n,o,i,s,l,c,d,u,p,h,f,g,m;function w(e){t[15](e)}let b={name:"fsa-enable",size:"sm"};function v(e){t[16](e)}void 0!==t[6].addBookmarkWithTags&&(b.checked=t[6].addBookmarkWithTags),i=new Na({props:b}),ge.push((()=>Ge(i,"checked",w)));let y={name:"fsa-enable",size:"sm"};return void 0!==t[6].privateR18&&(y.checked=t[6].privateR18),h=new Na({props:y}),ge.push((()=>Ge(h,"checked",v))),{c(){e=Lt("ul"),r=Lt("li"),a=Lt("label"),n=Lt("p"),n.textContent=`${J("setting.others.options.add_bookmark_with_tags")}`,o=zt(),Ye(i.$$.fragment),l=zt(),c=Lt("li"),d=Lt("label"),u=Lt("p"),u.textContent=`${J("setting.others.options.add_bookmark_private_r18")}`,p=zt(),Ye(h.$$.fragment),Nt(n,"class","flex-auto"),Nt(a,"class","label flex flex-grow items-center justify-center"),Nt(u,"class","flex-auto"),Nt(d,"class","label flex flex-grow items-center justify-center"),Nt(e,"class",g="list "+t[0]+" "+t[1]+" [&:not(:last-child)]:*:py-4 [&:last-child]:*:pt-4")},m(t,s){It(t,e,s),_t(e,r),_t(r,a),_t(a,n),_t(a,o),Ve(i,a,null),_t(e,l),_t(e,c),_t(c,d),_t(d,u),_t(d,p),Ve(h,d,null),m=!0},p(t,r){const a={};!s&&64&r&&(s=!0,a.checked=t[6].addBookmarkWithTags,$e((()=>s=!1))),i.$set(a);const n={};!f&&64&r&&(f=!0,n.checked=t[6].privateR18,$e((()=>f=!1))),h.$set(n),(!m||3&r&&g!==(g="list "+t[0]+" "+t[1]+" [&:not(:last-child)]:*:py-4 [&:last-child]:*:pt-4"))&&Nt(e,"class",g)},i(t){m||(De(i.$$.fragment,t),De(h.$$.fragment,t),m=!0)},o(t){ze(i.$$.fragment,t),ze(h.$$.fragment,t),m=!1},d(t){t&&Tt(e),Qe(i),Qe(h)}}}function Mo(t){let e,r,a,n,o,i,s,l,c,d,u,p,h=x.isPixiv(),f=!x.isYande(),g=x.isPixiv(),m=x.isRule34();function w(e){t[10](e)}let b={name:"show-popup-button",size:"sm"};void 0!==t[6].showPopupButton&&(b.checked=t[6].showPopupButton),i=new Na({props:b}),ge.push((()=>Ge(i,"checked",w)));let v=h&&function(t){let e,r,a,n,o,i,s,l,c,d,u,p,h,f,g,m,w,b,v,y,x,k,$=J("setting.others.options.option_does_not_apply_to_batch_download")+"";function C(e){t[11](e)}let A={name:"bundle-illusts",size:"sm"};function E(e){t[12](e)}void 0!==t[6].bundleIllusts&&(A.checked=t[6].bundleIllusts),n=new Na({props:A}),ge.push((()=>Ge(n,"checked",C)));let _={name:"bundle-manga",size:"sm"};function S(e){t[13](e)}void 0!==t[6].bundleManga&&(_.checked=t[6].bundleManga),d=new Na({props:_}),ge.push((()=>Ge(d,"checked",E)));let P={name:"bundle-manga",size:"sm"};return void 0!==t[6].likeIllust&&(P.checked=t[6].likeIllust),y=new Na({props:P}),ge.push((()=>Ge(y,"checked",S))),{c(){e=Lt("li"),r=Lt("p"),r.textContent=`${J("setting.others.options.bundle_multipage_illust")}`,a=zt(),Ye(n.$$.fragment),i=zt(),s=Lt("li"),l=Lt("p"),l.textContent=`${J("setting.others.options.bundle_manga")}`,c=zt(),Ye(d.$$.fragment),p=zt(),h=Lt("li"),f=Lt("div"),g=Lt("p"),g.textContent=`${J("setting.others.options.like_illust_when_downloading")}`,m=zt(),w=Lt("p"),b=Dt($),v=zt(),Ye(y.$$.fragment),Nt(r,"class","flex-auto"),Nt(l,"class","flex-auto"),Nt(w,"class",t[2]),Nt(f,"class","flex-auto")},m(t,o){It(t,e,o),_t(e,r),_t(e,a),Ve(n,e,null),It(t,i,o),It(t,s,o),_t(s,l),_t(s,c),Ve(d,s,null),It(t,p,o),It(t,h,o),_t(h,f),_t(f,g),_t(f,m),_t(f,w),_t(w,b),_t(h,v),Ve(y,h,null),k=!0},p(t,e){const r={};!o&&64&e&&(o=!0,r.checked=t[6].bundleIllusts,$e((()=>o=!1))),n.$set(r);const a={};!u&&64&e&&(u=!0,a.checked=t[6].bundleManga,$e((()=>u=!1))),d.$set(a),(!k||4&e)&&Nt(w,"class",t[2]);const i={};!x&&64&e&&(x=!0,i.checked=t[6].likeIllust,$e((()=>x=!1))),y.$set(i)},i(t){k||(De(n.$$.fragment,t),De(d.$$.fragment,t),De(y.$$.fragment,t),k=!0)},o(t){ze(n.$$.fragment,t),ze(d.$$.fragment,t),ze(y.$$.fragment,t),k=!1},d(t){t&&(Tt(e),Tt(i),Tt(s),Tt(p),Tt(h)),Qe(n),Qe(d),Qe(y)}}}(t),y=f&&function(t){let e,r,a,n,o,i,s,l,c,d,u,p,h=J("setting.others.options.option_does_not_apply_to_batch_download")+"",f=t[6].addBookmark&&x.isPixiv();function g(e){t[14](e)}let m={name:"fsa-enable",size:"sm"};void 0!==t[6].addBookmark&&(m.checked=t[6].addBookmark),c=new Na({props:m}),ge.push((()=>Ge(c,"checked",g)));let w=f&&Lo(t);return{c(){e=Lt("li"),r=Lt("div"),a=Lt("div"),n=Lt("p"),n.textContent=`${J("setting.others.options.add_bookmark_when_downloading")}`,o=zt(),i=Lt("p"),s=Dt(h),l=zt(),Ye(c.$$.fragment),u=zt(),w&&w.c(),Nt(i,"class",t[2]),Nt(a,"class","flex-auto"),Nt(r,"class","flex items-center"),Nt(e,"class","flex-col !items-stretch")},m(t,d){It(t,e,d),_t(e,r),_t(r,a),_t(a,n),_t(a,o),_t(a,i),_t(i,s),_t(r,l),Ve(c,r,null),_t(e,u),w&&w.m(e,null),p=!0},p(t,r){(!p||4&r)&&Nt(i,"class",t[2]);const a={};!d&&64&r&&(d=!0,a.checked=t[6].addBookmark,$e((()=>d=!1))),c.$set(a),64&r&&(f=t[6].addBookmark&&x.isPixiv()),f?w?(w.p(t,r),64&r&&De(w,1)):(w=Lo(t),w.c(),De(w,1),w.m(e,null)):w&&(Le(),ze(w,1,1,(()=>{w=null})),Me())},i(t){p||(De(c.$$.fragment,t),De(w),p=!0)},o(t){ze(c.$$.fragment,t),ze(w),p=!1},d(t){t&&Tt(e),Qe(c),w&&w.d()}}}(t),k=g&&function(t){let e,r,a,n,o,i,s,l,c,d,u,p,h,f,g,m;function w(e){t[17](e)}let b={name:"mix-effect",size:"sm"};return void 0!==t[6].mixEffect&&(b.checked=t[6].mixEffect),f=new Na({props:b}),ge.push((()=>Ge(f,"checked",w))),{c(){e=Lt("section"),r=Lt("p"),a=Dt("实验性功能"),n=zt(),o=Lt("ul"),i=Lt("li"),s=Lt("div"),l=Lt("p"),l.textContent="为单页插图增加 #pixivGlow2024 效果",c=zt(),d=Lt("p"),u=Dt("* 转换至动图格式。如果插图尺寸过大，可能占用大量内存 / 转换失败"),h=zt(),Ye(f.$$.fragment),Nt(r,"class",t[4]),Nt(d,"class",p=t[2]+" !text-error-500"),Nt(s,"class","flex-auto"),Nt(o,"class",t[5])},m(t,p){It(t,e,p),_t(e,r),_t(r,a),_t(e,n),_t(e,o),_t(o,i),_t(i,s),_t(s,l),_t(s,c),_t(s,d),_t(d,u),_t(i,h),Ve(f,i,null),m=!0},p(t,e){(!m||16&e)&&Nt(r,"class",t[4]),(!m||4&e&&p!==(p=t[2]+" !text-error-500"))&&Nt(d,"class",p);const a={};!g&&64&e&&(g=!0,a.checked=t[6].mixEffect,$e((()=>g=!1))),f.$set(a),(!m||32&e)&&Nt(o,"class",t[5])},i(t){m||(De(f.$$.fragment,t),m=!0)},o(t){ze(f.$$.fragment,t),m=!1},d(t){t&&Tt(e),Qe(f)}}}(t),$=m&&function(t){let e,r,a,n,o,i,s,l,c,d,u,p;return{c(){e=Lt("section"),r=Lt("p"),a=Dt("cf_clearance"),n=zt(),o=Lt("ul"),i=Lt("li"),s=Lt("input"),l=zt(),c=Lt("p"),d=Dt("如果无法正常下载，可尝试填入cf_clearance cookie"),Nt(r,"class",t[4]),Nt(s,"type","text"),Nt(s,"class","input"),Nt(s,"name","cf_clearance"),Nt(c,"class",t[2]),Nt(i,"class","flex-col !items-start gap-2"),Nt(o,"class",t[5])},m(h,f){It(h,e,f),_t(e,r),_t(r,a),_t(e,n),_t(e,o),_t(o,i),_t(i,s),qt(s,t[6].token),_t(i,l),_t(i,c),_t(c,d),u||(p=Ot(s,"input",t[18]),u=!0)},p(t,e){16&e&&Nt(r,"class",t[4]),64&e&&s.value!==t[6].token&&qt(s,t[6].token),4&e&&Nt(c,"class",t[2]),32&e&&Nt(o,"class",t[5])},d(t){t&&Tt(e),u=!1,p()}}}(t);return{c(){e=Lt("div"),r=Lt("ul"),a=Lt("li"),n=Lt("p"),n.textContent=`${J("setting.others.options.show_setting_button")}`,o=zt(),Ye(i.$$.fragment),l=zt(),v&&v.c(),c=zt(),y&&y.c(),d=zt(),k&&k.c(),u=zt(),$&&$.c(),Nt(n,"class","flex-auto"),Nt(r,"class",t[5]),Nt(e,"class",t[3])},m(t,s){It(t,e,s),_t(e,r),_t(r,a),_t(a,n),_t(a,o),Ve(i,a,null),_t(r,l),v&&v.m(r,null),_t(r,c),y&&y.m(r,null),_t(e,d),k&&k.m(e,null),_t(e,u),$&&$.m(e,null),p=!0},p(t,[a]){const n={};!s&&64&a&&(s=!0,n.checked=t[6].showPopupButton,$e((()=>s=!1))),i.$set(n),h&&v.p(t,a),f&&y.p(t,a),(!p||32&a)&&Nt(r,"class",t[5]),g&&k.p(t,a),m&&$.p(t,a),(!p||8&a)&&Nt(e,"class",t[3])},i(t){p||(De(i.$$.fragment,t),De(v),De(y),De(k),p=!0)},o(t){ze(i.$$.fragment,t),ze(v),ze(y),ze(k),p=!1},d(t){t&&Tt(e),Qe(i),v&&v.d(),y&&y.d(),k&&k.d(),$&&$.d()}}}function Do(t,e,r){let a,n;ct(t,En,(t=>r(6,n=t)));let{bg:o="bg-white/30 dark:bg-black/15"}=e,{border:i="divide-y-[1px] *:border-surface-300-600-token"}=e,{padding:s="px-4 *:py-4"}=e,{margin:l="mt-2 *:!m-0"}=e,{rounded:c="rounded-container-token *:!rounded-none"}=e,{descritionText:d="text-sm text-surface-400"}=e,{sectionSpace:u="space-y-4"}=e,{sectionTitle:p="font-bold"}=e;return t.$$set=t=>{r(19,e=K(K({},e),gt(t))),"bg"in t&&r(7,o=t.bg),"border"in t&&r(0,i=t.border),"padding"in t&&r(8,s=t.padding),"margin"in t&&r(9,l=t.margin),"rounded"in t&&r(1,c=t.rounded),"descritionText"in t&&r(2,d=t.descritionText),"sectionSpace"in t&&r(3,u=t.sectionSpace),"sectionTitle"in t&&r(4,p=t.sectionTitle)},t.$$.update=()=>{r(5,a=`list *:items-center ${s} ${l} ${i} ${o} ${c} ${e.class??""}`)},e=gt(e),[i,c,d,u,p,a,n,o,s,l,function(e){t.$$.not_equal(n.showPopupButton,e)&&(n.showPopupButton=e,En.set(n))},function(e){t.$$.not_equal(n.bundleIllusts,e)&&(n.bundleIllusts=e,En.set(n))},function(e){t.$$.not_equal(n.bundleManga,e)&&(n.bundleManga=e,En.set(n))},function(e){t.$$.not_equal(n.likeIllust,e)&&(n.likeIllust=e,En.set(n))},function(e){t.$$.not_equal(n.addBookmark,e)&&(n.addBookmark=e,En.set(n))},function(e){t.$$.not_equal(n.addBookmarkWithTags,e)&&(n.addBookmarkWithTags=e,En.set(n))},function(e){t.$$.not_equal(n.privateR18,e)&&(n.privateR18=e,En.set(n))},function(e){t.$$.not_equal(n.mixEffect,e)&&(n.mixEffect=e,En.set(n))},function(){n.token=this.value,En.set(n)}]}class zo extends Ke{constructor(t){super(),Je(this,t,Do,Mo,nt,{bg:7,border:0,padding:8,margin:9,rounded:1,descritionText:2,sectionSpace:3,sectionTitle:4})}}function Fo(t){let e,r,a,n,o,i,s,l,c,d,u,p,h,f,g,m,w,b,v,y,x,k,$,C=J("setting.feedback.label.feedback")+"",A=J("setting.feedback.text.feedback_desc")+"",E=J("setting.feedback.label.donate")+"",_=J("setting.feedback.text.give_me_a_star")+"";return{c(){e=Lt("div"),r=Lt("section"),a=Lt("p"),n=Dt(C),o=zt(),i=Lt("ul"),s=Lt("li"),l=Lt("span"),c=zt(),d=Lt("section"),u=Lt("p"),p=Dt(E),h=zt(),f=Lt("ul"),g=Lt("li"),m=Lt("p"),w=zt(),b=Lt("li"),v=Lt("figure"),y=Lt("img"),k=zt(),$=Lt("figcaption"),$.textContent=`${J("setting.feedback.text.donate_desc")}`,Nt(a,"class",t[1]),Nt(i,"class",t[2]),Nt(u,"class",t[1]),it(y.src,x=mn)||Nt(y,"src",x),Nt(y,"alt","credit"),Nt(y,"class","rounded-full m-auto"),Nt($,"class","mt-4"),Nt(b,"class","justify-center"),Nt(f,"class",t[2]),Nt(e,"class",t[0])},m(t,x){It(t,e,x),_t(e,r),_t(r,a),_t(a,n),_t(r,o),_t(r,i),_t(i,s),_t(s,l),l.innerHTML=A,_t(e,c),_t(e,d),_t(d,u),_t(u,p),_t(d,h),_t(d,f),_t(f,g),_t(g,m),m.innerHTML=_,_t(f,w),_t(f,b),_t(b,v),_t(v,y),_t(v,k),_t(v,$)},p(t,[r]){2&r&&Nt(a,"class",t[1]),4&r&&Nt(i,"class",t[2]),2&r&&Nt(u,"class",t[1]),4&r&&Nt(f,"class",t[2]),1&r&&Nt(e,"class",t[0])},i:X,o:X,d(t){t&&Tt(e)}}}function Oo(t,e,r){let a,{bg:n="bg-white/30 dark:bg-black/15"}=e,{border:o="divide-y-[1px] *:border-surface-300-600-token"}=e,{padding:i="px-4 *:py-4"}=e,{margin:s="mt-2 *:!m-0"}=e,{rounded:l="rounded-container-token *:!rounded-none"}=e,{sectionSpace:c="space-y-4"}=e,{sectionTitle:d="font-bold"}=e;return t.$$set=t=>{r(8,e=K(K({},e),gt(t))),"bg"in t&&r(3,n=t.bg),"border"in t&&r(4,o=t.border),"padding"in t&&r(5,i=t.padding),"margin"in t&&r(6,s=t.margin),"rounded"in t&&r(7,l=t.rounded),"sectionSpace"in t&&r(0,c=t.sectionSpace),"sectionTitle"in t&&r(1,d=t.sectionTitle)},t.$$.update=()=>{r(2,a=`list *:items-center ${i} ${s} ${o} ${n} ${l} ${e.class??""}`)},e=gt(e),[c,d,a,n,o,i,s,l]}class No extends Ke{constructor(t){super(),Je(this,t,Oo,Fo,nt,{bg:3,border:4,padding:5,margin:6,rounded:7,sectionSpace:0,sectionTitle:1})}}function jo(t,e,r){const a=t.slice();return a[8]=e[r],a[10]=r,a}function Ro(t){let e,r=t[8].name+"";return{c(){e=Dt(r)},m(t,r){It(t,e,r)},p:X,d(t){t&&Tt(e)}}}function Ho(t){let e,r,a=(!("show"in t[8])||t[8].show)&&function(t){let e,r,a;function n(e){t[6](e)}let o={name:"option",value:t[10],class:"rounded-token",$$slots:{default:[Ro]},$$scope:{ctx:t}};return void 0!==t[2]&&(o.group=t[2]),e=new sa({props:o}),ge.push((()=>Ge(e,"group",n))),{c(){Ye(e.$$.fragment)},m(t,r){Ve(e,t,r),a=!0},p(t,a){const n={};2048&a&&(n.$$scope={dirty:a,ctx:t}),!r&&4&a&&(r=!0,n.group=t[2],$e((()=>r=!1))),e.$set(n)},i(t){a||(De(e.$$.fragment,t),a=!0)},o(t){ze(e.$$.fragment,t),a=!1},d(t){Qe(e,t)}}}(t);return{c(){a&&a.c(),e=Ft()},m(t,n){a&&a.m(t,n),It(t,e,n),r=!0},p(t,e){"show"in t[8]&&!t[8].show||a.p(t,e)},i(t){r||(De(a),r=!0)},o(t){ze(a),r=!1},d(t){t&&Tt(e),a&&a.d(t)}}}function Uo(t){let e,r,a=He(t[5]),n=[];for(let e=0;e<a.length;e+=1)n[e]=Ho(jo(t,a,e));const o=t=>ze(n[t],1,1,(()=>{n[t]=null}));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=Ft()},m(t,a){for(let e=0;e<n.length;e+=1)n[e]&&n[e].m(t,a);It(t,e,a),r=!0},p(t,r){if(36&r){let i;for(a=He(t[5]),i=0;i<a.length;i+=1){const o=jo(t,a,i);n[i]?(n[i].p(o,r),De(n[i],1)):(n[i]=Ho(o),n[i].c(),De(n[i],1),n[i].m(e.parentNode,e))}for(Le(),i=a.length;i<n.length;i+=1)o(i);Me()}},i(t){if(!r){for(let t=0;t<a.length;t+=1)De(n[t]);r=!0}},o(t){n=n.filter(Boolean);for(let t=0;t<n.length;t+=1)ze(n[t]);r=!1},d(t){t&&Tt(e),Bt(n,t)}}}function Wo(t){let e,r,a=(t[5][t[2]].name||"设置")+"";return{c(){e=Lt("h3"),r=Dt(a),Nt(e,"class","h3")},m(t,a){It(t,e,a),_t(e,r)},p(t,e){4&e&&a!==(a=(t[5][t[2]].name||"设置")+"")&&Wt(r,a)},d(t){t&&Tt(e)}}}function qo(t){let e,r;return{c(){e=new Zt(!1),r=Ft(),e.a=r},m(t,a){e.m('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21,15.61L19.59,17L14.58,12L19.59,7L21,8.39L17.44,12L21,15.61M3,6H16V8H3V6M3,13V11H13V13H3M3,18V16H16V18H3Z" /></svg>',t,a),It(t,r,a)},d(t){t&&(Tt(r),e.d())}}}function Go(t){let e,r;return{c(){e=new Zt(!1),r=Ft(),e.a=r},m(t,a){e.m('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6H13V8H3V6M3 16H13V18H3V16M3 11H15V13H3V11M16 7L14.58 8.39L18.14 12L14.58 15.61L16 17L21 12L16 7Z" /></svg>',t,a),It(t,r,a)},d(t){t&&(Tt(r),e.d())}}}function Yo(t){let e,r,a,n;function o(t,e){return t[1]?Go:qo}let i=o(t),s=i(t);return{c(){e=Lt("button"),r=Lt("i"),s.c(),Nt(r,"class","w-8 fill-current"),Nt(e,"type","button"),Nt(e,"class","btn-icon hover:variant-soft-surface ml-1")},m(o,i){It(o,e,i),_t(e,r),s.m(r,null),a||(n=Ot(e,"click",t[7]),a=!0)},p(t,e){i!==(i=o(t))&&(s.d(1),s=i(t),s&&(s.c(),s.m(r,null)))},d(t){t&&Tt(e),s.d(),a=!1,n()}}}function Vo(t){let e,r,a,n,o,i,s,l,c;r=new Qr({props:{class:"pt-4 pr-6 row-start-1 row-span-2 "+Jo+" transition-[transform] "+t[3],$$slots:{default:[Uo]},$$scope:{ctx:t}}}),n=new Mr({props:{padding:"py-2",background:"bg-transparent",class:"mr-6 border-b border-surface-800-100-token",$$slots:{lead:[Yo],default:[Wo]},$$scope:{ctx:t}}});var d=t[5][t[2]].component;return d&&(s=Kt(d,{props:{bg:"bg-white/30 dark:bg-surface-500/20 backdrop-blur-sm"}})),{c(){e=Lt("div"),Ye(r.$$.fragment),a=zt(),Ye(n.$$.fragment),o=zt(),i=Lt("div"),s&&Ye(s.$$.fragment),Nt(i,"class","mt-4 pr-4 scrollbar-track-transparent scrollbar-thumb-slate-400/50 scrollbar-corner-transparent scrollbar-thin overflow-y-auto"),Gt(i,"scrollbar-gutter","stable"),Nt(e,"class",l="h-full pt-4 pb-6 pl-6 grid grid-rows-[auto_1fr] transition-[grid-template-columns] "+t[4])},m(t,l){It(t,e,l),Ve(r,e,null),_t(e,a),Ve(n,e,null),_t(e,o),_t(e,i),s&&Ve(s,i,null),c=!0},p(t,a){const o={};8&a&&(o.class="pt-4 pr-6 row-start-1 row-span-2 "+Jo+" transition-[transform] "+t[3]),2052&a&&(o.$$scope={dirty:a,ctx:t}),r.$set(o);const u={};if(2054&a&&(u.$$scope={dirty:a,ctx:t}),n.$set(u),4&a&&d!==(d=t[5][t[2]].component)){if(s){Le();const t=s;ze(t.$$.fragment,1,0,(()=>{Qe(t,1)})),Me()}d?(s=Kt(d,{props:{bg:"bg-white/30 dark:bg-surface-500/20 backdrop-blur-sm"}}),Ye(s.$$.fragment),De(s.$$.fragment,1),Ve(s,i,null)):s=null}(!c||16&a&&l!==(l="h-full pt-4 pb-6 pl-6 grid grid-rows-[auto_1fr] transition-[grid-template-columns] "+t[4]))&&Nt(e,"class",l)},i(t){c||(De(r.$$.fragment,t),De(n.$$.fragment,t),s&&De(s.$$.fragment,t),c=!0)},o(t){ze(r.$$.fragment,t),ze(n.$$.fragment,t),s&&ze(s.$$.fragment,t),c=!1},d(t){t&&Tt(e),Qe(r),Qe(n),s&&Qe(s)}}}function Qo(t){let e,r;return e=new yn({props:{parent:t[0],height:"h-screen md:h-[600px]",width:"w-screen md:max-w-screen-md xl:max-w-screen-lg",padding:"",$$slots:{default:[Vo]},$$scope:{ctx:t}}}),{c(){Ye(e.$$.fragment)},m(t,a){Ve(e,t,a),r=!0},p(t,[r]){const a={};1&r&&(a.parent=t[0]),2078&r&&(a.$$scope={dirty:r,ctx:t}),e.$set(a)},i(t){r||(De(e.$$.fragment,t),r=!0)},o(t){ze(e.$$.fragment,t),r=!1},d(t){Qe(e,t)}}}const Jo="w-[140px]";function Xo(t,e,r){let a,n,{parent:o}=e,i=0;const s=[{name:J("setting.save_to.title"),component:qn},{name:J("setting.ugoira.title"),component:lo,show:x.isPixiv()},{name:J("setting.history.title"),component:ko},{name:J("setting.button_position.title"),component:Bo},{name:J("setting.others.title"),component:zo},{name:J("setting.feedback.title"),component:No}];let l=!0;return t.$$set=t=>{"parent"in t&&r(0,o=t.parent)},t.$$.update=()=>{2&t.$$.dirty&&r(4,a=l?"grid-cols-[140px_1fr]":"grid-cols-[0px_1fr]"),2&t.$$.dirty&&r(3,n=l?"translate-x-0":"-translate-x-full")},[o,l,i,n,a,s,function(t){i=t,r(2,i)},()=>r(1,l=!l)]}class Zo extends Ke{constructor(t){super(),Je(this,t,Xo,Qo,nt,{parent:0})}}const Ko={selectedFilters:null,blacklistTag:[],whitelistTag:[],downloadAllPages:!0,pageStart:1,pageEnd:1,retryFailed:!1},ti="pdl-downloader_option",ei=localStorage.getItem(ti);const ri=function(t){const e={};for(const r in Ko)e[r]=rr(r in t?t[r]:Ko[r]);return e}(ei?JSON.parse(ei):Ko);ar(Object.values(ri),(t=>{const e={};return Object.keys(ri).forEach(((r,a)=>{e[r]=t[a]})),e})).subscribe((t=>{localStorage.setItem(ti,JSON.stringify(t))}));const ai="Masked.";function ni(t){const e=rr(0),r=rr([]),a=rr([]),n=rr([]),o=rr(!1),i=rr(),{requestDownload:s,cancelDownloadRequest:l,processNextDownload:c}=function(){const t=String(Math.random()),e=new BroadcastChannel("pdl_batch-download"),r=[];let a,n,o=!1,i=!1;return e.addEventListener("message",(n=>{const{data:s}=n;switch(s.type){case 5:u.info("channel receive: QUERY"),o&&e.postMessage({type:0,value:null});break;case 0:u.info("channel receive: SET_PENDING"),!i&&(i=!0);break;case 1:u.info("channel receive: SET_IDLE"),i&&(i=!1);break;case 2:u.info("channel receive: ADD_QUEUE"),o&&r.push(s.value);break;case 3:if(u.info("channel receive: REMOVE_QUEUE"),o){const t=r.findIndex((t=>t===s.value));-1!==t&&r.splice(t,1)}break;case 4:if(u.info("channel receive: PROCESS_NEXT",t,s.value),s.value[0]!==t)return;r.push(...s.value.slice(1)),i=!1,o=!0,a()}})),window.addEventListener("unload",(()=>{i?e.postMessage({type:3,value:t}):o&&(r.length?e.postMessage({type:4,value:r}):e.postMessage({type:1,value:null}))})),e.postMessage({type:5,value:null}),{async requestDownload(){if(!i)return o=!0,e.postMessage({type:0,value:null}),void u.info("channel post: SET_PENDING");const r=new Promise(((t,e)=>{a=t,n=e}));return e.postMessage({type:2,value:t}),u.info("channel post: ADD_QUEUE",t),r},cancelDownloadRequest(r){i&&(e.postMessage({type:3,value:t}),u.info("channel post: REMOVE_QUEUE",t),n(r))},processNextDownload(){o&&(o=!1,r.length?(i=!0,e.postMessage({type:4,value:r}),r.length=0,u.info("channel post: PROCESS_NEXT")):(e.postMessage({type:1,value:null}),u.info("channel post: SET_IDLE")))}}}(),d=[],h=[],f=[],g=[],m=[];let w,y,x,k,$,C,A=[],E=[],_=!1;const S=[],P=[],{selectedFilters:I,blacklistTag:T,whitelistTag:B,downloadAllPages:L,pageStart:M,pageEnd:D,retryFailed:z}=ri;ar([L,M,D],(t=>t)).subscribe((([t,e,r])=>{C=t,k=e,$=r})),I.subscribe((e=>{e&&(S.length=0,P.length=0,e.forEach((e=>{const r=t.filterOption.filters.find((t=>t.id===e));r&&("include"===r.type?S.push(r.fn):P.push(r.fn))})))})),T.subscribe((t=>{A=[...t]})),B.subscribe((t=>{E=[...t]})),z.subscribe((t=>{_=t}));function F(t){return"string"==typeof t[0]}function O(t){o.update((e=>{if(e&&t)throw new Error("Already downloading.");return t}))}function N(t){a.update((e=>{let r,a;if(Array.isArray(t)){e.push(...t);const n=t[t.length-1];r=n.id,a=n.reason}else e.push(t),r=t.id,a=t.reason;return(a instanceof Error||"string"==typeof a)&&R("Fail",r,a),e}))}function j(t){n.update((e=>{if(Array.isArray(t))F(t)?e.push(...t):e.push(...t.map((t=>t.id))),R("Info",t.length+" task"+(t.length>1?"s were":" was")+" excluded...");else{const r="string"==typeof t?t:t.id;e.push(r),R("Info",`${r} was excluded...`)}return e}))}function R(t,e,r){const a={type:t,message:""};switch(t){case"Error":if(!(e instanceof Error))throw new TypeError("error` is expected to be error, but got "+typeof e);a.message=`[${e.name}] ${e.message}`;break;case"Fail":if("string"!=typeof e)throw new TypeError("`id` is expected to be string, but got "+typeof e);a.message="string"==typeof r?`[Fail] ${e}...${r}`:`[Fail] ${e}...${r?r.name+":"+r.message:""}`;break;default:a.message=`[${t}] ${e}`}i.set(a)}function H(t,e){if(!("tags"in t)||!Array.isArray(t.tags))return!0;return e??(e=(t,e)=>t.some((t=>e.includes(t)))),E.length?e(E,t.tags):!A.length||!e(A,t.tags)}async function U(e){try{const{enableTagFilter:r}=t.filterOption;if(!0===r){if(!H(e))return!1}else if(r&&!H(e,r))return!1;if(!S.length)return!1;for(let t=0;t<P.length;t++){const r=P[t];if(await r(e))return!1}for(let t=0;t<S.length;t++){const r=S[t];if(await r(e))return!0}}catch(t){console.error(t)}return!1}async function W(a,n,o){o.throwIfAborted();const i=new Promise(((t,e)=>{y=t,x=e})),{parseMetaByArtworkId:s,downloadByArtworkId:l}=t,c=[];let w,v=!1;const k=t=>e=>{if(o.aborted)return;let r=!1;e&&(r=e!==ai,e instanceof b&&429===e.status&&(v=!0),u.error(e)),"string"==typeof t?(N({id:t,reason:e}),r&&h.push(t)):(N({id:t.id,reason:e}),r&&g.push(t))};for(;(w=await Promise.race([a.next(),i]))&&!w.done;){const{total:t,avaliable:a,invalid:h,unavaliable:g}=w.value;u.info(t,a,h,g),o.throwIfAborted(),$=t,e.set($),h.length&&j(h),g.length&&(F(g)?(N(g.map((t=>({id:t,reason:ai})))),f.push(...g)):(N(g.map((t=>({id:t.id,reason:ai})))),m.push(...g))),a.length||await Promise.race([p(1500),i]);for(const t of a){let e,a,u;if(v&&(R("Error",new Error("Http status: 429, wait for 30 seconds.")),await Promise.race([p(3e4),i]),v=!1),"string"==typeof t){if(a=t,e=await s(a).catch(k(a)),o.throwIfAborted(),!e)continue;if(!n){if(!await U(e)){j(a),await Promise.race([p(1e3),i]);continue}}u=q(a)}else e=t,a=e.id,u=q(a);R("Add",a),d.push(u);const h=l(e,u).then((function(){var t;!o.aborted&&(t=a,r.update((e=>(Array.isArray(t)?(e.push(...t),R("Complete",t[t.length-1])):(e.push(t),R("Complete",t)),e))))}),k(t)).finally((function(){const t=d.findIndex((t=>t===u));-1!==t&&d.splice(t,1)}));c.push(h),c.length>=5?(await Promise.race([...c,i]),c.length=0):await Promise.race([p(1e3),i])}}var $;return i}function q(t){return t+"_"+Math.random().toString(36).slice(2)}function G(){return Y}ar([e,r,a,n],(([t,e,r,a])=>t===e.length+r.length+a.length)).subscribe((t=>{t&&(null==y||y())}));const Y={artworkCount:nr(e),successd:nr(r),failed:nr(a),excluded:nr(n),downloading:nr(o),log:nr(i),batchDownload:async function(o,...i){let u;O(!0),R("Info","Download start..."),e.set(0),r.set([]),a.set([]),n.set([]),d.length=0,h.length=0,f.length=0,g.length=0,m.length=0,w=null,y=()=>{},x=()=>{},R("Info","Reset store.");const{beforeDownload:p,afterDownload:b}=t;let v,A;w=new AbortController;const E=w.signal;E.addEventListener("abort",(()=>{l(E.reason),null==x||x(E.reason),t.onDownloadAbort(d)}),{once:!0});try{const r=function(e){const{pageOption:r}=t;for(const t in r)if(t===e)return r[t]}(o);if(!r||!("fn"in r))throw new Error("Invalid generator id: "+o);const{filterInGenerator:n,beforeDownload:l,afterDownload:c}=r;v=c,"function"==typeof p&&await p(),"function"==typeof l&&await l(),A=function(t,...e){let r;if(!C&&$<k)throw new Error("End page must not be less than the start page.");const a=C?null:[k,$];r="filterInGenerator"in t&&!t.filterInGenerator?t.fn(a,...e):t.fn(a,U,...e);return r}(r,...i),R("Info","Waiting for other downloads to finish..."),await s(),R("Info","Starting..."),await W(A,n,E),_&&(h.length||g.length)&&(h.length?(A=function*(t,e,r){yield{total:t,page:0,avaliable:e,invalid:[],unavaliable:r}}(lt(e),h.slice(),f.slice()),h.length=0,f.length=0):g.length&&(A=function*(t,e,r){yield{total:t,page:0,avaliable:e,invalid:[],unavaliable:r}}(lt(e),g.slice(),m.slice()),g.length=0,m.length=0),a.set([]),R("Info","Retry..."),await W(A,n,E)),R("Info","Download complete.")}catch(t){u=t,null==A||A.return(),E.aborted||w.abort(t),t instanceof Error&&R("Error",t)}if("function"==typeof v&&v(),"function"==typeof b&&b(),O(!1),c(),u)throw u},abort:function(){w&&w.abort(new v)},overwrite:function(e){for(const r in e){const a=e[r];void 0!==a&&(t[r]=a)}return G}};return G}const oi='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm-32-316v116h-67c-10.7 0-16 12.9-8.5 20.5l99 99c4.7 4.7 12.3 4.7 17 0l99-99c7.6-7.6 2.2-20.5-8.5-20.5h-67V140c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12z"></path></svg>';function ii(t,e,r){const a=t.slice();return a[80]=e[r][0],a[81]=e[r][1],a}function si(t,e,r){const a=t.slice();return a[80]=e[r].id,a[84]=e[r].name,a}function li(t){let e,r,a,n,o,i,s,l=!t[5]&&ci(t);const c=[Ai,Ci],d=[];function u(t,e){return t[5]?1:0}return n=u(t),o=d[n]=c[n](t),{c(){e=Lt("div"),l&&l.c(),r=zt(),a=Lt("div"),o.c(),Nt(a,"class","flex relative my-4"),Nt(e,"data-theme","skeleton"),Nt(e,"class","card px-4 fixed right-20 top-36 w-[600px] *:text-sm shadow-xl bg-scroll")},m(t,o){It(t,e,o),l&&l.m(e,null),_t(e,r),_t(e,a),d[n].m(a,null),s=!0},p(t,i){t[5]?l&&(Le(),ze(l,1,1,(()=>{l=null})),Me()):l?(l.p(t,i),32&i[0]&&De(l,1)):(l=ci(t),l.c(),De(l,1),l.m(e,r));let s=n;n=u(t),n===s?d[n].p(t,i):(Le(),ze(d[s],1,1,(()=>{d[s]=null})),Me(),o=d[n],o?o.p(t,i):(o=d[n]=c[n](t),o.c()),De(o,1),o.m(a,null))},i(t){s||(De(l),De(o),t&&ke((()=>{s&&(i||(i=je(e,vr,{x:50,opacity:0},!0)),i.run(1))})),s=!0)},o(t){ze(l),ze(o),t&&(i||(i=je(e,vr,{x:50,opacity:0},!1)),i.run(0)),s=!1},d(t){t&&Tt(e),l&&l.d(),d[n].d(),t&&i&&i.end()}}}function ci(t){let e,r,a,n,o,i;return r=new qa({props:{regionList:"text-surface-700-200-token",class:"text-sm",$$slots:{panel:[$i],default:[fi]},$$scope:{ctx:t}}}),{c(){e=Lt("div"),Ye(r.$$.fragment),a=zt(),n=Lt("hr"),Nt(n,"class","!border-t-1 my-4"),Nt(e,"class","downloader-filter")},m(t,o){It(t,e,o),Ve(r,e,null),_t(e,a),_t(e,n),i=!0},p(t,e){const a={};8327169&e[0]|33554432&e[2]&&(a.$$scope={dirty:e,ctx:t}),r.$set(a)},i(t){i||(De(r.$$.fragment,t),t&&ke((()=>{i&&(o||(o=je(e,yr,{},!0)),o.run(1))})),i=!0)},o(t){ze(r.$$.fragment,t),t&&(o||(o=je(e,yr,{},!1)),o.run(0)),i=!1},d(t){t&&Tt(e),Qe(r),t&&o&&o.end()}}}function di(t){let e,r=J("downloader.category.tab_name")+"";return{c(){e=Dt(r)},m(t,r){It(t,e,r)},p:X,d(t){t&&Tt(e)}}}function ui(t){let e,r,a;function n(e){t[53](e)}let o={name:"tag_filter",value:1,$$slots:{default:[pi]},$$scope:{ctx:t}};return void 0!==t[12]&&(o.group=t[12]),e=new Xa({props:o}),ge.push((()=>Ge(e,"group",n))),{c(){Ye(e.$$.fragment)},m(t,r){Ve(e,t,r),a=!0},p(t,a){const n={};33554432&a[2]&&(n.$$scope={dirty:a,ctx:t}),!r&&4096&a[0]&&(r=!0,n.group=t[12],$e((()=>r=!1))),e.$set(n)},i(t){a||(De(e.$$.fragment,t),a=!0)},o(t){ze(e.$$.fragment,t),a=!1},d(t){Qe(e,t)}}}function pi(t){let e,r=J("downloader.tag_filter.tab_name")+"";return{c(){e=Dt(r)},m(t,r){It(t,e,r)},p:X,d(t){t&&Tt(e)}}}function hi(t){let e,r=J("downloader.others.tab_name")+"";return{c(){e=Dt(r)},m(t,r){It(t,e,r)},p:X,d(t){t&&Tt(e)}}}function fi(t){let e,r,a,n,o,i,s;function l(e){t[52](e)}let c={name:"category",value:0,$$slots:{default:[di]},$$scope:{ctx:t}};void 0!==t[12]&&(c.group=t[12]),e=new Xa({props:c}),ge.push((()=>Ge(e,"group",l)));let d=!!t[0].filterOption.enableTagFilter&&ui(t);function u(e){t[54](e)}let p={name:"tag_filter",value:2,$$slots:{default:[hi]},$$scope:{ctx:t}};return void 0!==t[12]&&(p.group=t[12]),o=new Xa({props:p}),ge.push((()=>Ge(o,"group",u))),{c(){Ye(e.$$.fragment),a=zt(),d&&d.c(),n=zt(),Ye(o.$$.fragment)},m(t,r){Ve(e,t,r),It(t,a,r),d&&d.m(t,r),It(t,n,r),Ve(o,t,r),s=!0},p(t,a){const s={};33554432&a[2]&&(s.$$scope={dirty:a,ctx:t}),!r&&4096&a[0]&&(r=!0,s.group=t[12],$e((()=>r=!1))),e.$set(s),t[0].filterOption.enableTagFilter?d?(d.p(t,a),1&a[0]&&De(d,1)):(d=ui(t),d.c(),De(d,1),d.m(n.parentNode,n)):d&&(Le(),ze(d,1,1,(()=>{d=null})),Me());const l={};33554432&a[2]&&(l.$$scope={dirty:a,ctx:t}),!i&&4096&a[0]&&(i=!0,l.group=t[12],$e((()=>i=!1))),o.$set(l)},i(t){s||(De(e.$$.fragment,t),De(d),De(o.$$.fragment,t),s=!0)},o(t){ze(e.$$.fragment,t),ze(d),ze(o.$$.fragment,t),s=!1},d(t){t&&(Tt(a),Tt(n)),Qe(e,t),d&&d.d(t),Qe(o,t)}}}function gi(t){let e,r,a,n,o,i;function s(e){t[51](e)}let l={size:"sm",name:"download-retry"};return void 0!==t[22]&&(l.checked=t[22]),n=new Na({props:l}),ge.push((()=>Ge(n,"checked",s))),{c(){e=Lt("div"),r=Lt("p"),r.textContent=`${J("downloader.others.options.retry_failed")}`,a=zt(),Ye(n.$$.fragment),Nt(e,"class","flex justify-between items-center text-base text-surface-700-200-token")},m(t,o){It(t,e,o),_t(e,r),_t(e,a),Ve(n,e,null),i=!0},p(t,e){const r={};!o&&4194304&e[0]&&(o=!0,r.checked=t[22],$e((()=>o=!1))),n.$set(r)},i(t){i||(De(n.$$.fragment,t),i=!0)},o(t){ze(n.$$.fragment,t),i=!1},d(t){t&&Tt(e),Qe(n)}}}function mi(t){let e,r,a,n,o,i;function s(e){t[49](e)}let l={allowUpperCase:!0,name:"blacklist",chips:"variant-filled-primary",placeholder:J("downloader.tag_filter.placeholder.blacklist_tag")};function c(e){t[50](e)}void 0!==t[20]&&(l.value=t[20]),e=new Gr({props:l}),ge.push((()=>Ge(e,"value",s)));let d={allowUpperCase:!0,name:"whitelist",chips:"variant-filled-primary",placeholder:J("downloader.tag_filter.placeholder.whitelist_tag"),class:"my-4"};return void 0!==t[21]&&(d.value=t[21]),n=new Gr({props:d}),ge.push((()=>Ge(n,"value",c))),{c(){Ye(e.$$.fragment),a=zt(),Ye(n.$$.fragment)},m(t,r){Ve(e,t,r),It(t,a,r),Ve(n,t,r),i=!0},p(t,a){const i={};!r&&1048576&a[0]&&(r=!0,i.value=t[20],$e((()=>r=!1))),e.$set(i);const s={};!o&&2097152&a[0]&&(o=!0,s.value=t[21],$e((()=>o=!1))),n.$set(s)},i(t){i||(De(e.$$.fragment,t),De(n.$$.fragment,t),i=!0)},o(t){ze(e.$$.fragment,t),ze(n.$$.fragment,t),i=!1},d(t){t&&Tt(a),Qe(e,t),Qe(n,t)}}}function wi(t){let e,r,a,n,o,i,s,l,c,d,u,p,h,f,g,m,w,b,v,y,x=t[0].filterOption.filters.length&&bi(t);return n=new ya({props:{regionLabel:"text-surface-700-200-token",active:"variant-filled-primary",background:"bg-surface-400/20 dark:bg-surface-500/20",border:"",display:"flex",$$slots:{default:[ki]},$$scope:{ctx:t}}}),{c(){x&&x.c(),e=zt(),r=Lt("div"),a=Lt("div"),Ye(n.$$.fragment),o=zt(),i=Lt("div"),s=Lt("label"),l=Lt("div"),c=Lt("i"),d=zt(),u=Lt("input"),p=zt(),h=Lt("label"),f=Lt("div"),g=Lt("i"),m=zt(),w=Lt("input"),Nt(a,"class","flex-grow w-full"),Nt(c,"class","w-6 fill-current"),Nt(l,"class","input-group-shim !px-1 flex-none"),Nt(u,"class","w-20 pr-0 text-surface-700-200-token text-sm"),Nt(u,"type","number"),Nt(u,"min","1"),Nt(u,"step","1"),u.disabled=t[17],Nt(s,"class","input-group input-group-divider flex [&>input]:!min-w-0 [&>input]:!border-transparent border-surface-400/20 dark:border-surface-500/20 bg-surface-400/20 dark:bg-surface-500/20"),Nt(g,"class","w-6 fill-current"),Nt(f,"class","input-group-shim !px-1 flex-none"),Nt(w,"class","w-20 pr-0 text-surface-700-200-token text-sm"),Nt(w,"type","number"),Nt(w,"min","1"),Nt(w,"step","1"),w.disabled=t[17],Nt(h,"class","input-group input-group-divider flex [&>input]:!min-w-0 [&>input]:!border-transparent border-surface-400/20 dark:border-surface-500/20 bg-surface-400/20 dark:bg-surface-500/20"),Nt(i,"class","flex justify-between items-center gap-4 w-full"),Nt(r,"class","flex justify-between items-center my-4 gap-4")},m(k,$){x&&x.m(k,$),It(k,e,$),It(k,r,$),_t(r,a),Ve(n,a,null),_t(r,o),_t(r,i),_t(i,s),_t(s,l),_t(l,c),c.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M10,16.5L16,12L10,7.5V16.5Z" /></svg>',_t(s,d),_t(s,u),qt(u,t[18]),_t(i,p),_t(i,h),_t(h,f),_t(f,g),g.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4M9,9V15H15V9" /></svg>',_t(h,m),_t(h,w),qt(w,t[19]),b=!0,v||(y=[vt(Gn.call(null,u,t[29])),Ot(u,"input",t[47]),vt(Gn.call(null,w,t[30])),Ot(w,"input",t[48])],v=!0)},p(t,r){t[0].filterOption.filters.length?x?x.p(t,r):(x=bi(t),x.c(),x.m(e.parentNode,e)):x&&(x.d(1),x=null);const a={};131072&r[0]|33554432&r[2]&&(a.$$scope={dirty:r,ctx:t}),n.$set(a),(!b||131072&r[0])&&(u.disabled=t[17]),262144&r[0]&&Ut(u.value)!==t[18]&&qt(u,t[18]),(!b||131072&r[0])&&(w.disabled=t[17]),524288&r[0]&&Ut(w.value)!==t[19]&&qt(w,t[19])},i(t){b||(De(n.$$.fragment,t),b=!0)},o(t){ze(n.$$.fragment,t),b=!1},d(t){t&&(Tt(e),Tt(r)),x&&x.d(t),Qe(n),v=!1,rt(y)}}}function bi(t){let e,r,a=He(t[0].filterOption.filters),n=[];for(let e=0;e<a.length;e+=1)n[e]=vi(si(t,a,e));return{c(){e=Lt("div"),r=Lt("div");for(let t=0;t<n.length;t+=1)n[t].c();Nt(r,"class","btn-group w-full"),Nt(e,"class","flex justify-end items-center my-4")},m(t,a){It(t,e,a),_t(e,r);for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(r,null)},p(t,e){if(65537&e[0]){let o;for(a=He(t[0].filterOption.filters),o=0;o<a.length;o+=1){const i=si(t,a,o);n[o]?n[o].p(i,e):(n[o]=vi(i),n[o].c(),n[o].m(r,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=a.length}},d(t){t&&Tt(e),Bt(n,t)}}}function vi(t){let e,r,a,n,o,i,s,l,c,d,u,p=!1,h=t[84]+"";return c=Ht(t[44][0]),{c(){e=Lt("label"),r=Lt("div"),a=Lt("input"),o=zt(),i=Lt("div"),s=Dt(h),l=zt(),Nt(a,"type","checkbox"),a.__value=n=t[80],qt(a,a.__value),Nt(r,"class","w-0 h-0 overflow-hidden hidden"),Nt(i,"class","!m-0"),Nt(e,"class","btn !py-2 rounded-none !transform-none cursor-pointer variant-soft-surface has-[:checked]:!variant-filled-primary text-sm w-full"),c.p(a)},m(n,c){It(n,e,c),_t(e,r),_t(r,a),a.checked=~(t[16]||[]).indexOf(a.__value),_t(e,o),_t(e,i),_t(i,s),_t(e,l),d||(u=Ot(a,"change",t[43]),d=!0)},p(t,e){1&e[0]&&n!==(n=t[80])&&(a.__value=n,qt(a,a.__value),p=!0),(p||65537&e[0])&&(a.checked=~(t[16]||[]).indexOf(a.__value)),1&e[0]&&h!==(h=t[84]+"")&&Wt(s,h)},d(t){t&&Tt(e),c.r(),d=!1,u()}}}function yi(t){let e,r=J("downloader.category.filter.download_all_pages")+"";return{c(){e=Dt(r)},m(t,r){It(t,e,r)},p:X,d(t){t&&Tt(e)}}}function xi(t){let e,r=J("downloader.category.filter.download_selected_pages")+"";return{c(){e=Dt(r)},m(t,r){It(t,e,r)},p:X,d(t){t&&Tt(e)}}}function ki(t){let e,r,a,n,o,i;function s(e){t[45](e)}let l={class:"text-sm !py-[7px]",name:"justify",value:!0,$$slots:{default:[yi]},$$scope:{ctx:t}};function c(e){t[46](e)}void 0!==t[17]&&(l.group=t[17]),e=new $a({props:l}),ge.push((()=>Ge(e,"group",s)));let d={class:"text-sm !py-[7px]",name:"justify",value:!1,$$slots:{default:[xi]},$$scope:{ctx:t}};return void 0!==t[17]&&(d.group=t[17]),n=new $a({props:d}),ge.push((()=>Ge(n,"group",c))),{c(){Ye(e.$$.fragment),a=zt(),Ye(n.$$.fragment)},m(t,r){Ve(e,t,r),It(t,a,r),Ve(n,t,r),i=!0},p(t,a){const i={};33554432&a[2]&&(i.$$scope={dirty:a,ctx:t}),!r&&131072&a[0]&&(r=!0,i.group=t[17],$e((()=>r=!1))),e.$set(i);const s={};33554432&a[2]&&(s.$$scope={dirty:a,ctx:t}),!o&&131072&a[0]&&(o=!0,s.group=t[17],$e((()=>o=!1))),n.$set(s)},i(t){i||(De(e.$$.fragment,t),De(n.$$.fragment,t),i=!0)},o(t){ze(e.$$.fragment,t),ze(n.$$.fragment,t),i=!1},d(t){t&&Tt(a),Qe(e,t),Qe(n,t)}}}function $i(t){let e,r,a,n;const o=[wi,mi,gi],i=[];function s(t,e){return 0===t[12]?0:1===t[12]?1:2===t[12]?2:-1}return~(e=s(t))&&(r=i[e]=o[e](t)),{c(){r&&r.c(),a=Ft()},m(t,r){~e&&i[e].m(t,r),It(t,a,r),n=!0},p(t,n){let l=e;e=s(t),e===l?~e&&i[e].p(t,n):(r&&(Le(),ze(i[l],1,1,(()=>{i[l]=null})),Me()),~e?(r=i[e],r?r.p(t,n):(r=i[e]=o[e](t),r.c()),De(r,1),r.m(a.parentNode,a)):r=null)},i(t){n||(De(r),n=!0)},o(t){ze(r),n=!1},d(t){t&&Tt(a),~e&&i[e].d(t)}}}function Ci(t){var e;let r,a,n,o,i,s,l,c,d,u,p,h,f,g,m,w,b,v,y,x=((null==(e=t[23])?void 0:e.message)??"")+"",k=t[4]?`${t[2]} / ${t[4]}`:"";return n=new da({props:{height:"h-4",rounded:"rounded-md",meter:"bg-primary-500",track:"bg-primary-500/30",max:100,value:t[15]}}),{c(){var e;r=Lt("div"),a=Lt("div"),Ye(n.$$.fragment),o=zt(),i=Lt("div"),s=Lt("p"),l=Dt(x),c=zt(),d=Lt("p"),u=Dt(k),p=zt(),h=Lt("button"),f=Lt("i"),g=zt(),m=Lt("span"),m.textContent=`${J("downloader.download_type.stop")}`,Nt(s,"class","truncate"),Jt(s,"text-error-500","Error"===(null==(e=t[23])?void 0:e.type)),Nt(d,"class","flex-none"),Nt(i,"class","flex items-center justify-between gap-4 basis-0 text-surface-700-200-token"),Nt(a,"class","flex flex-grow flex-col justify-between h-full overflow-hidden"),Nt(f,"class","w-5"),Nt(h,"class","btn variant-filled-primary"),Nt(r,"class","flex flex-grow w-full gap-6 items-center")},m(e,w){It(e,r,w),_t(r,a),Ve(n,a,null),_t(a,o),_t(a,i),_t(i,s),_t(s,l),_t(i,c),_t(i,d),_t(d,u),_t(r,p),_t(r,h),_t(h,f),f.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm101.8-262.2L295.6 256l62.2 62.2c4.7 4.7 4.7 12.3 0 17l-22.6 22.6c-4.7 4.7-12.3 4.7-17 0L256 295.6l-62.2 62.2c-4.7 4.7-12.3 4.7-17 0l-22.6-22.6c-4.7-4.7-4.7-12.3 0-17l62.2-62.2-62.2-62.2c-4.7-4.7-4.7-12.3 0-17l22.6-22.6c4.7-4.7 12.3-4.7 17 0l62.2 62.2 62.2-62.2c4.7-4.7 12.3-4.7 17 0l22.6 22.6c4.7 4.7 4.7 12.3 0 17z"></path></svg>\n',_t(h,g),_t(h,m),t[61](r),b=!0,v||(y=[Ot(h,"click",t[60]),Ot(r,"introstart",t[62]),Ot(r,"outrostart",t[63])],v=!0)},p(t,e){var r,a;const o={};32768&e[0]&&(o.value=t[15]),n.$set(o),(!b||8388608&e[0])&&x!==(x=((null==(r=t[23])?void 0:r.message)??"")+"")&&Wt(l,x),(!b||8388608&e[0])&&Jt(s,"text-error-500","Error"===(null==(a=t[23])?void 0:a.type)),(!b||20&e[0])&&k!==(k=t[4]?`${t[2]} / ${t[4]}`:"")&&Wt(u,k)},i(t){b||(De(n.$$.fragment,t),t&&ke((()=>{b&&(w||(w=je(r,br,{duration:250},!0)),w.run(1))})),b=!0)},o(t){ze(n.$$.fragment,t),t&&(w||(w=je(r,br,{duration:250},!1)),w.run(0)),b=!1},d(e){e&&Tt(r),Qe(n),t[61](null),e&&w&&w.end(),v=!1,rt(y)}}}function Ai(t){var e;let r,a,n,o,i,s,l,c,d,u,p,h,f=((null==(e=t[23])?void 0:e.message)??"")+"";function g(t,e){return t[1]&&t[1].length>1?_i:t[1]&&"fn"in t[1][0][1]?Ei:void 0}let m=g(t),w=m&&m(t);return{c(){var e;r=Lt("div"),a=Lt("div"),n=Lt("p"),o=Dt(t[14]),i=zt(),s=Lt("p"),l=Dt(f),c=zt(),w&&w.c(),Nt(n,"class","truncate"),Nt(s,"class","break-words"),Jt(s,"text-error-500","Error"===(null==(e=t[23])?void 0:e.type)),Nt(a,"class","flex flex-grow flex-col justify-between overflow-hidden text-surface-700-200-token"),Nt(r,"class","flex justify-end flex-grow w-full gap-4")},m(e,d){It(e,r,d),_t(r,a),_t(a,n),_t(n,o),_t(a,i),_t(a,s),_t(s,l),_t(r,c),w&&w.m(r,null),t[57](r),u=!0,p||(h=[Ot(r,"introstart",t[58]),Ot(r,"outrostart",t[59])],p=!0)},p(t,e){var a,n;(!u||16384&e[0])&&Wt(o,t[14]),(!u||8388608&e[0])&&f!==(f=((null==(a=t[23])?void 0:a.message)??"")+"")&&Wt(l,f),(!u||8388608&e[0])&&Jt(s,"text-error-500","Error"===(null==(n=t[23])?void 0:n.type)),m===(m=g(t))&&w?w.p(t,e):(w&&w.d(1),w=m&&m(t),w&&(w.c(),w.m(r,null)))},i(t){u||(t&&ke((()=>{u&&(d||(d=je(r,br,{duration:250},!0)),d.run(1))})),u=!0)},o(t){t&&(d||(d=je(r,br,{duration:250},!1)),d.run(0)),u=!1},d(e){e&&Tt(r),w&&w.d(),t[57](null),e&&d&&d.end(),p=!1,rt(h)}}}function Ei(t){let e,r,a,n,o,i,s,l=t[1][0][1].name+"";return{c(){e=Lt("button"),r=Lt("i"),a=zt(),n=Lt("span"),o=Dt(l),Nt(r,"class","w-5"),Nt(e,"class","btn variant-filled-primary self-start")},m(l,c){It(l,e,c),_t(e,r),r.innerHTML=oi,_t(e,a),_t(e,n),_t(n,o),i||(s=Ot(e,"click",t[56]),i=!0)},p(t,e){2&e[0]&&l!==(l=t[1][0][1].name+"")&&Wt(o,l)},d(t){t&&Tt(e),i=!1,s()}}}function _i(t){let e,r=He(t[1]),a=[];for(let e=0;e<r.length;e+=1)a[e]=Pi(ii(t,r,e));return{c(){e=Lt("div");for(let t=0;t<a.length;t+=1)a[t].c();Nt(e,"class","flex-none btn-group self-start")},m(t,r){It(t,e,r);for(let t=0;t<a.length;t+=1)a[t]&&a[t].m(e,null)},p(t,n){if(16777218&n[0]){let o;for(r=He(t[1]),o=0;o<r.length;o+=1){const i=ii(t,r,o);a[o]?a[o].p(i,n):(a[o]=Pi(i),a[o].c(),a[o].m(e,null))}for(;o<a.length;o+=1)a[o].d(1);a.length=r.length}},d(t){t&&Tt(e),Bt(a,t)}}}function Si(t){let e,r,a,n,o,i,s,l,c=t[81].name+"";function d(){return t[55](t[80])}return{c(){e=Lt("button"),r=Lt("i"),a=zt(),n=Lt("span"),o=Dt(c),i=zt(),Nt(r,"class","w-5"),Nt(e,"class","btn rounded-none !transform-none !variant-filled-primary")},m(t,c){It(t,e,c),_t(e,r),r.innerHTML=oi,_t(e,a),_t(e,n),_t(n,o),_t(e,i),s||(l=Ot(e,"click",d),s=!0)},p(e,r){t=e,2&r[0]&&c!==(c=t[81].name+"")&&Wt(o,c)},d(t){t&&Tt(e),s=!1,l()}}}function Pi(t){let e,r="fn"in t[81]&&Si(t);return{c(){r&&r.c(),e=Ft()},m(t,a){r&&r.m(t,a),It(t,e,a)},p(t,a){"fn"in t[81]?r?r.p(t,a):(r=Si(t),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null)},d(t){t&&Tt(e),r&&r.d(t)}}}function Ii(t){let e,r,a,n,o,i,s,l,c,d,u,p,h={ctx:t,current:null,token:null,hasCatch:!1,pending:Mi,then:Bi,catch:Ti,value:79};Re(a=t[11],h);let f=t[5]&&!t[13]&&Di(t);const g=[Fi,zi],m=[];function w(t,e){return t[5]&&t[4]&&!t[13]?0:t[13]?-1:1}return~(s=w(t))&&(l=m[s]=g[s](t)),{c(){e=Lt("div"),r=Lt("div"),h.block.c(),n=zt(),f&&f.c(),o=zt(),i=Lt("div"),l&&l.c(),Nt(r,"data-theme","skeleton"),Nt(r,"class","avatar absolute -z-10 size-14 rounded-full overflow-hidden bg-scroll transition-opacity duration-[250ms]"),Jt(r,"opacity-70",!t[13]),Jt(r,"blur-[1px]",!t[13]),Nt(i,"class","size-14 flex justify-center items-center relative"),Nt(e,"class","size-14 rounded-full fixed right-4 top-36 drop-shadow-xl cursor-pointer hover:brightness-110 backdrop-blur-sm")},m(a,l){It(a,e,l),_t(e,r),h.block.m(r,h.anchor=null),h.mount=()=>r,h.anchor=null,_t(e,n),f&&f.m(e,null),_t(e,o),_t(e,i),~s&&m[s].m(i,null),d=!0,u||(p=Ot(e,"click",t[71]),u=!0)},p(n,c){t=n,h.ctx=t,2048&c[0]&&a!==(a=t[11])&&Re(a,h)||function(t,e,r){const a=e.slice(),{resolved:n}=t;t.current===t.then&&(a[t.value]=n),t.current===t.catch&&(a[t.error]=n),t.block.p(a,r)}(h,t,c),(!d||8192&c[0])&&Jt(r,"opacity-70",!t[13]),(!d||8192&c[0])&&Jt(r,"blur-[1px]",!t[13]),t[5]&&!t[13]?f?(f.p(t,c),8224&c[0]&&De(f,1)):(f=Di(t),f.c(),De(f,1),f.m(e,o)):f&&(Le(),ze(f,1,1,(()=>{f=null})),Me());let u=s;s=w(t),s===u?~s&&m[s].p(t,c):(l&&(Le(),ze(m[u],1,1,(()=>{m[u]=null})),Me()),~s?(l=m[s],l?l.p(t,c):(l=m[s]=g[s](t),l.c()),De(l,1),l.m(i,null)):l=null)},i(t){d||(De(f),De(l),t&&ke((()=>{d&&(c||(c=je(e,vr,{opacity:0,x:50},!0)),c.run(1))})),d=!0)},o(t){ze(f),ze(l),t&&(c||(c=je(e,vr,{opacity:0,x:50},!1)),c.run(0)),d=!1},d(t){t&&Tt(e),h.block.d(),h.token=null,h=null,f&&f.d(),~s&&m[s].d(),t&&c&&c.end(),u=!1,p()}}}function Ti(t){return{c:X,m:X,p:X,d:X}}function Bi(t){let e,r=t[79]&&Li(t);return{c(){r&&r.c(),e=Ft()},m(t,a){r&&r.m(t,a),It(t,e,a)},p(t,a){t[79]?r?r.p(t,a):(r=Li(t),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null)},d(t){t&&Tt(e),r&&r.d(t)}}}function Li(t){let e,r;return{c(){e=Lt("img"),it(e.src,r=t[79])||Nt(e,"src",r),Nt(e,"alt","batch download"),Nt(e,"class","object-cover object-center size-full")},m(r,a){It(r,e,a),t[64](e)},p(t,a){2048&a[0]&&!it(e.src,r=t[79])&&Nt(e,"src",r)},d(r){r&&Tt(e),t[64](null)}}}function Mi(t){return{c:X,m:X,p:X,d:X}}function Di(t){let e,r,a,n;return r=new wa({props:{width:"w-16",stroke:32,meter:"stroke-primary-500",track:"stroke-primary-500/30",fill:"fill-primary-500",strokeLinecap:"butt",value:t[15]}}),{c(){e=Lt("div"),Ye(r.$$.fragment),Nt(e,"class","!absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2")},m(t,a){It(t,e,a),Ve(r,e,null),n=!0},p(t,e){const a={};32768&e[0]&&(a.value=t[15]),r.$set(a)},i(t){n||(De(r.$$.fragment,t),t&&ke((()=>{n&&(a||(a=je(e,br,{duration:250},!0)),a.run(1))})),n=!0)},o(t){ze(r.$$.fragment,t),t&&(a||(a=je(e,br,{duration:250},!1)),a.run(0)),n=!1},d(t){t&&Tt(e),Qe(r),t&&a&&a.end()}}}function zi(t){let e,r,a,n,o;return{c(){e=Lt("i"),Nt(e,"class","w-6 fill-slate-700 dark:fill-slate-200 mix-blend-hard-light mt-4")},m(r,i){It(r,e,i),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9,1V7H5L12,14L19,7H15V1H9M5,16V18H19V16H5M5,20V22H19V20H5Z" /></svg>',t[68](e),a=!0,n||(o=[Ot(e,"introstart",t[69]),Ot(e,"outrostart",t[70])],n=!0)},p:X,i(t){a||(t&&ke((()=>{a&&(r||(r=je(e,br,{duration:250},!0)),r.run(1))})),a=!0)},o(t){t&&(r||(r=je(e,br,{duration:250},!1)),r.run(0)),a=!1},d(a){a&&Tt(e),t[68](null),a&&r&&r.end(),n=!1,rt(o)}}}function Fi(t){let e,r,a,n,o,i,s,l,c,d,u,p;return{c(){e=Lt("div"),r=Lt("span"),a=Dt(t[2]),n=zt(),o=Lt("hr"),i=zt(),s=Lt("span"),l=Dt(t[4]),Nt(r,"class","truncate max-w-full"),Nt(o,"class","!border-t-1 my-[1px] self-stretch !border-surface-700 dark:!border-surface-200"),Nt(s,"class","truncate max-w-full"),Nt(e,"class","flex flex-col justify-center items-center px-3 font-bold text-[12px] leading-[14px] overflow-hidden text-surface-700-200-token")},m(c,h){It(c,e,h),_t(e,r),_t(r,a),_t(e,n),_t(e,o),_t(e,i),_t(e,s),_t(s,l),t[65](e),d=!0,u||(p=[Ot(e,"introstart",t[66]),Ot(e,"outrostart",t[67])],u=!0)},p(t,e){(!d||4&e[0])&&Wt(a,t[2]),(!d||16&e[0])&&Wt(l,t[4])},i(t){d||(t&&ke((()=>{d&&(c||(c=je(e,br,{duration:250},!0)),c.run(1))})),d=!0)},o(t){t&&(c||(c=je(e,br,{duration:250},!1)),c.run(0)),d=!1},d(r){r&&Tt(e),t[65](null),r&&c&&c.end(),u=!1,rt(p)}}}function Oi(t){let e,r,a,n=t[13]&&t[3]&&li(t),o=t[3]&&Ii(t);return{c(){n&&n.c(),e=zt(),o&&o.c(),r=Ft()},m(t,i){n&&n.m(t,i),It(t,e,i),o&&o.m(t,i),It(t,r,i),a=!0},p(t,a){t[13]&&t[3]?n?(n.p(t,a),8200&a[0]&&De(n,1)):(n=li(t),n.c(),De(n,1),n.m(e.parentNode,e)):n&&(Le(),ze(n,1,1,(()=>{n=null})),Me()),t[3]?o?(o.p(t,a),8&a[0]&&De(o,1)):(o=Ii(t),o.c(),De(o,1),o.m(r.parentNode,r)):o&&(Le(),ze(o,1,1,(()=>{o=null})),Me())},i(t){a||(De(n),De(o),a=!0)},o(t){ze(n),ze(o),a=!1},d(t){t&&(Tt(e),Tt(r)),n&&n.d(t),o&&o.d(t)}}}function Ni(t){t.preventDefault(),t.returnValue=!0}function ji(t,e,r){let a,n,o,i,s,l,c,d,p,h,f,g,m,w,b,v,y;async function x(t){if(!A.avatar)return;if(p&&void 0!==j)return void(R=t);let e,a;if("string"==typeof A.avatar?e=A.avatar:t in N?e=N[t]:(e=await A.avatar(t),N[t]=e),!e||z&&z.src===e)return;r(11,j=new Promise((t=>{a=t})));const n=document.createElement("img");n.src=e,n.onload=()=>{a(e)}}function k(t){if(u.info("Navigating to ",t),!A)return;const{pageOption:e}=A,a=[];for(const r in e){const n=e[r],{match:o}=n;"string"==typeof o?t.match(o)&&a.push([r,n]):"function"==typeof o?o(t)&&a.push([r,n]):o.test(t)&&a.push([r,n])}a.length?(r(1,C=a),x(t)):(r(1,C=null),R="")}async function $(t){try{await J(t)}catch(t){u.error(t)}}let C,{downloaderConfig:A}=e,{useBatchDownload:E}=e;const{selectedFilters:_,blacklistTag:S,whitelistTag:P,downloadAllPages:I,pageStart:T,pageEnd:B,retryFailed:L}=ri;let M,D,z,F,O;ct(t,_,(t=>r(16,h=t))),ct(t,S,(t=>r(20,w=t))),ct(t,P,(t=>r(21,b=t))),ct(t,I,(t=>r(17,f=t))),ct(t,T,(t=>r(18,g=t))),ct(t,B,(t=>r(19,m=t))),ct(t,L,(t=>r(22,v=t)));const N={};let j,R,H=0,U=!1;Array.isArray(h)||bt(_,h=A.filterOption.filters.filter((t=>t.checked)).map((t=>t.id)),h);const{artworkCount:W,successd:q,failed:G,excluded:Y,downloading:V,log:Q,batchDownload:J,abort:X}=E();ct(t,W,(t=>r(4,d=t))),ct(t,q,(t=>r(42,c=t))),ct(t,G,(t=>r(41,l=t))),ct(t,Y,(t=>r(40,s=t))),ct(t,V,(t=>r(5,p=t))),ct(t,Q,(t=>r(23,y=t))),function(){if("navigation"in window){let t,e;navigation.addEventListener("navigatesuccess",(()=>{t!==e&&k(e)})),navigation.addEventListener("navigate",(r=>{t=location.href,e=r.destination.url}))}else{const t=t=>{const e=history[t];return function(...t){const r=location.href,a=e.apply(this,t),n=location.href;return r!==n&&k(n),a}};history.pushState=t("pushState"),history.replaceState=t("replaceState")}}(),k(location.href),V.subscribe((t=>{t?(j||x(location.href),window.addEventListener("beforeunload",Ni)):(window.removeEventListener("beforeunload",Ni),R&&C&&x(R))}));const Z=[[]];return t.$$set=t=>{"downloaderConfig"in t&&r(0,A=t.downloaderConfig),"useBatchDownload"in t&&r(39,E=t.useBatchDownload)},t.$$.update=()=>{34&t.$$.dirty[0]&&r(3,a=p||!!C),8&t.$$.dirty[0]&&(a||r(13,U=!1)),3584&t.$$.dirty[1]&&r(2,n=c.length+l.length+s.length),20&t.$$.dirty[0]&&r(15,o=d?n/d*100:void 0),48&t.$$.dirty[0]|3584&t.$$.dirty[1]&&r(14,i=!p&&d?`Completed: ${c.length}. Failed: ${l.length}. Excluded: ${s.length}.`:"")},[A,C,n,a,d,p,M,D,z,F,O,j,H,U,i,o,h,f,g,m,w,b,v,y,$,_,S,P,I,T,B,L,W,q,G,Y,V,Q,X,E,s,l,c,function(){h=function(t,e,r){const a=new Set;for(let e=0;e<t.length;e+=1)t[e].checked&&a.add(t[e].__value);return r||a.delete(e),Array.from(a)}(Z[0],this.__value,this.checked),_.set(h)},Z,function(t){f=t,I.set(f)},function(t){f=t,I.set(f)},function(){g=Ut(this.value),T.set(g)},function(){m=Ut(this.value),B.set(m)},function(t){w=t,S.set(w)},function(t){b=t,P.set(b)},function(t){v=t,L.set(v)},function(t){H=t,r(12,H)},function(t){H=t,r(12,H)},function(t){H=t,r(12,H)},t=>{$(t)},()=>{$((null==C?void 0:C[0][0])??"")},function(t){ge[t?"unshift":"push"]((()=>{M=t,r(6,M)}))},()=>M.classList.remove("absolute"),()=>M.classList.add("absolute"),()=>{X()},function(t){ge[t?"unshift":"push"]((()=>{D=t,r(7,D)}))},()=>D.classList.remove("absolute"),()=>D.classList.add("absolute"),function(t){ge[t?"unshift":"push"]((()=>{z=t,r(8,z)}))},function(t){ge[t?"unshift":"push"]((()=>{F=t,r(9,F)}))},()=>F.classList.remove("absolute"),()=>F.classList.add("absolute"),function(t){ge[t?"unshift":"push"]((()=>{O=t,r(10,O)}))},()=>O.classList.remove("absolute"),()=>O.classList.add("absolute"),()=>{r(13,U=!U)}]}class Ri extends Ke{constructor(t){super(),Je(this,t,ji,Oi,nt,{downloaderConfig:0,useBatchDownload:39},null,[-1,-1,-1])}}function Hi(t){let e,r;return e=new Ri({props:{downloaderConfig:t[0],useBatchDownload:t[1]}}),{c(){Ye(e.$$.fragment)},m(t,a){Ve(e,t,a),r=!0},p(t,r){const a={};1&r&&(a.downloaderConfig=t[0]),2&r&&(a.useBatchDownload=t[1]),e.$set(a)},i(t){r||(De(e.$$.fragment,t),r=!0)},o(t){ze(e.$$.fragment,t),r=!1},d(t){Qe(e,t)}}}function Ui(t){let e,r,a,n,o,i;return{c(){e=Lt("button"),r=Lt("i"),a=zt(),n=Lt("span"),n.textContent=`${J("button.setting")}`,Nt(r,"class","text-sm w-6 fill-current"),Nt(n,"class","text-sm"),Nt(e,"type","button"),Nt(e,"class","btn btn-sm variant-filled fixed bottom-24 rounded-none rounded-s-full opacity-40 hover:opacity-100 right-0 translate-x-[calc(100%-44px)] hover:translate-x-0 delay-100")},m(s,l){It(s,e,l),_t(e,r),r.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z" /></svg>',_t(e,a),_t(e,n),o||(i=Ot(e,"click",t[16]),o=!0)},p:X,d(t){t&&Tt(e),o=!1,i()}}}function Wi(t){let e,r,a,n,o,i,s,l;r=new gn({props:{components:t[7],class:"!p-0"}});let c=t[0]&&t[1]&&Hi(t),d=t[4].showPopupButton&&Ui(t);return{c(){e=Lt("div"),Ye(r.$$.fragment),a=zt(),c&&c.c(),n=zt(),d&&d.c(),Nt(e,"class",o="contents "+t[3]),Nt(e,"data-theme","skeleton")},m(o,u){var p;It(o,e,u),Ve(r,e,null),_t(e,a),c&&c.m(e,null),_t(e,n),d&&d.m(e,null),t[17](e),i=!0,s||(l=[Ot(window,"keydown",t[9],!0),Ot(e,"keydown",(p=t[15],function(t){return t.stopPropagation(),p.call(this,t)})),Ot(e,"mousedown",qi,!0),Ot(e,"mouseup",qi,!0)],s=!0)},p(t,[r]){t[0]&&t[1]?c?(c.p(t,r),3&r&&De(c,1)):(c=Hi(t),c.c(),De(c,1),c.m(e,n)):c&&(Le(),ze(c,1,1,(()=>{c=null})),Me()),t[4].showPopupButton?d?d.p(t,r):(d=Ui(t),d.c(),d.m(e,null)):d&&(d.d(1),d=null),(!i||8&r&&o!==(o="contents "+t[3]))&&Nt(e,"class",o)},i(t){i||(De(r.$$.fragment,t),De(c),i=!0)},o(t){ze(r.$$.fragment,t),ze(c),i=!1},d(a){a&&Tt(e),Qe(r),c&&c.d(),d&&d.d(),t[17](null),s=!1,rt(l)}}}function qi(t){if(!(t.target instanceof Element))return;const e=t.target.classList;(e.contains("modal-backdrop")||e.contains("modal-transition"))&&t.stopPropagation()}function Gi(t,e,r){let a,n,{dark:o=!1}=e,{updated:i=!1}=e,{filenameTemplate:s=[]}=e,{downloaderConfig:l}=e,{useBatchDownload:c}=e;ue("filenameTemplate",s),lr(),dr(),or();const d=function(){const t=_.getAll();return En.set(t),En.subscribe(_.update),En}();ct(t,d,(t=>r(4,n=t)));const u=sr();let p;const h={changelog:{ref:Cn},setting:{ref:Zo}},f={type:"component",component:"changelog"},m={type:"component",component:"setting"};function w(){u.trigger(f)}le((async()=>{const t=p.getRootNode();g(t),t.host.setAttribute("style","position:fixed; z-index:99999"),i&&w()}));return t.$$set=t=>{"dark"in t&&r(10,o=t.dark),"updated"in t&&r(11,i=t.updated),"filenameTemplate"in t&&r(12,s=t.filenameTemplate),"downloaderConfig"in t&&r(0,l=t.downloaderConfig),"useBatchDownload"in t&&r(1,c=t.useBatchDownload)},t.$$.update=()=>{1024&t.$$.dirty&&r(3,a=o?"dark":"")},[l,c,p,a,n,d,u,h,m,function(t){(null==p?void 0:p.querySelector(".modal-backdrop"))&&("Escape"!==t.code?t.ctrlKey||t.shiftKey||t.composedPath().includes(p)||(t.stopImmediatePropagation(),t.preventDefault()):u.close())},o,i,s,w,function(){u.trigger(m)},function(e){he.call(this,t,e)},()=>u.trigger(m),function(t){ge[t?"unshift":"push"]((()=>{p=t,r(2,p)}))}]}const Yi=function(t,e,r,a,n,o){let i=class extends Xe{constructor(){super(t,r,n),this.$$p_d=e}static get observedAttributes(){return Object.keys(e).map((t=>(e[t].attribute||t).toLowerCase()))}};return Object.keys(e).forEach((t=>{Object.defineProperty(i.prototype,t,{get(){return this.$$c&&t in this.$$c?this.$$c[t]:this.$$d[t]},set(r){var a;r=Ze(t,r,e),this.$$d[t]=r,null==(a=this.$$c)||a.$set({[t]:r})}})})),a.forEach((t=>{Object.defineProperty(i.prototype,t,{get(){var e;return null==(e=this.$$c)?void 0:e[t]}})})),o&&(i=o(i)),t.element=i,i}(class extends Ke{constructor(t){super(),Je(this,t,Gi,Wi,nt,{dark:10,updated:11,filenameTemplate:12,downloaderConfig:0,useBatchDownload:1,showChangelog:13,showSetting:14})}get showChangelog(){return this.$$.ctx[13]}get showSetting(){return this.$$.ctx[14]}},{dark:{type:"Boolean"},updated:{type:"Boolean"},filenameTemplate:{},downloaderConfig:{},useBatchDownload:{}},[],["showChangelog","showSetting"],!0,(t=>class extends t{constructor(t){super(),this.filenameTemplate=t.filenameTemplate,this.updated=t.updated??!1}initBatchDownloader(t){this.downloaderConfig=t;return this.useBatchDownload=ni(t)}}));customElements.define("pdl-app",Yi);class Vi{constructor(){o(this,"app"),o(this,"config"),o(this,"useBatchDownload"),this.config=function(t={}){if(_)throw new Error("`config` has already been defined.");const e=Object.freeze({version:"1.5.0",ugoiraFormat:"zip",folderPattern:"",filenamePattern:"{id}",tagLang:"ja",showMsg:!0,mixEffect:!1,bundleIllusts:!1,bundleManga:!1,addBookmark:!1,addBookmarkWithTags:!1,privateR18:!1,likeIllust:!1,useFileSystemAccess:!1,fileSystemFilenameConflictAction:"uniquify",showPopupButton:!0,gifQuality:10,webmQuality:95,mp4Bitrate:20,losslessWebp:!1,webpQuality:95,webpMehtod:4,pngColor:256,historyBackupInterval:0,lastHistoryBackup:0,token:"","pdl-btn-self-bookmark-left":100,"pdl-btn-self-bookmark-top":76,"pdl-btn-left":0,"pdl-btn-top":100,...t});let r;if(localStorage.pdlSetting)try{r=JSON.parse(localStorage.pdlSetting)}catch(t){u.error("Use default config because: ",t),r=Object.assign({},e)}else r=Object.assign({},e);return r.version!==e.version&&(r={...e,...r,version:e.version,showMsg:!0},localStorage.pdlSetting=JSON.stringify(r)),_={get:t=>r[t]??e[t],set(t,e){r[t]!==e&&(r[t]=e,localStorage.pdlSetting=JSON.stringify(r),u.info("Config set:",t,e))},getAll:()=>({...r}),update(t){r={...t},localStorage.pdlSetting=JSON.stringify(r)}}}(this.getCustomConfig()||void 0),this.app=this.createApp()}static get hostname(){throw new Error("`hostname` should be overwritten by a subclass.")}createApp(){const t=this.config.get("showMsg");t&&this.config.set("showMsg",!1);return new Yi({updated:t,filenameTemplate:this.getFilenameTemplate()})}injectStyle(){["pdl-btn-self-bookmark-left","pdl-btn-self-bookmark-top","pdl-btn-left","pdl-btn-top"].forEach((t=>{let e;void 0!==(e=this.config.get(t))&&document.documentElement.style.setProperty("--"+t,e)}))}runScheduledTask(){fo().scheduleBackup()}setAppDarkMode(){this.app.setAttribute("dark","")}setAppLightMode(){this.app.removeAttribute("dark")}observeColorScheme(){const t=window.matchMedia("(prefers-color-scheme: dark)");t.matches&&this.setAppDarkMode(),t.addEventListener("change",(t=>{t.matches?this.setAppDarkMode():this.setAppLightMode()}))}inject(){this.observeColorScheme(),this.injectStyle(),l(J("button.setting"),(()=>{var t;(null==(t=this.app.shadowRoot)?void 0:t.querySelector(".modal"))||this.app.showSetting()}),"s"),document.body.append(this.app),this.runScheduledTask()}}class Qi extends HTMLElement{constructor(t){super(),o(this,"props"),this.props=t}static get tagNameLowerCase(){return"pdl-artwork-button"}render(){if(this.shadowRoot)return;const t=this.attachShadow({mode:"open"}),e={...this.props};t.innerHTML=`<style>.button-wrapper{position:absolute;right:8px;top:0;bottom:0;margin-top:40px}.button-wrapper.rule34{bottom:calc(1em + 22px)}.button-wrapper.yande{right:calc(5em + 8px)}</style><div class="button-wrapper${e.site?" "+e.site:""}"></div>`,delete e.site;const r=new R({type:j.Gallery,...e});t.querySelector(".button-wrapper").appendChild(r)}connectedCallback(){this.render()}}customElements.define(Qi.tagNameLowerCase,Qi);class Ji extends Vi{constructor(){super(...arguments),o(this,"useBatchDownload",this.app.initBatchDownloader({metaType:{},avatar:"/images/r34chibi.png",filterOption:{filters:[{id:"exclude_downloaded",type:"exclude",name:J("downloader.category.filter.exclude_downloaded"),checked:!1,fn:t=>!!t.id&&M.has(t.id)},{id:"allow_image",type:"include",name:J("downloader.category.filter.image"),checked:!0,fn:t=>!!t.tags&&!t.tags.includes("video")},{id:"allow_video",type:"include",name:J("downloader.category.filter.video"),checked:!0,fn:t=>!!t.tags&&t.tags.includes("video")}],enableTagFilter:!0},pageOption:{favorites:{name:"Favorites",match:/(?=.*page=favorites)(?=.*s=view)(?=.*id=[0-9]+)/,filterInGenerator:!0,fn:(t,e,r)=>(r??(r=new RegExp("(?<=id=)[0-9]+").exec(location.search)[0]),F.favoriteGenerator(t,e,r))},pools:{name:"Pools",match:/(?=.*page=pool)(?=.*s=show)(?=.*id=[0-9]+)/,filterInGenerator:!0,fn:(t,e,r)=>(r??(r=new RegExp("(?<=id=)[0-9]+").exec(location.search)[0]),F.poolGenerator(t,e,r))},posts:{name:"Posts",match:/(?=.*page=post)(?=.*s=list)/,filterInGenerator:!0,fn:(t,e,r)=>(r??(r=new URLSearchParams(location.search).get("tags")??"all"),F.postGenerator(t,e,r))}},parseMetaByArtworkId:t=>F.parse(t),async downloadByArtworkId(t,e){T.dirHandleCheck();const{id:r,tags:a,artist:n,title:o,source:i,rating:s}=t,l=new W(t).getDownloadConfig();l.taskId=e,await T.download(l),M.add({pid:Number(r),user:n,title:o,tags:a,source:i,rating:s})},onDownloadAbort(t){T.abort(t)}}))}inject(){super.inject();const t=location.search;if(!t)return;const e=new URLSearchParams(t),r=e.get("page"),a=e.get("s");if("post"===r&&"view"===a){if(!document.querySelector("#image, #gelcomVideoPlayer"))return;const t=e.get("id");this.createArtworkBtn(t)}else this.createThumbnailBtn()}createThumbnailBtn(){const t=document.querySelectorAll(".thumb > a:first-child:not(:has(.blacklist-img))");t.length&&t.forEach((t=>{t.setAttribute("style","position: relative; align-self: center; width: auto; height: auto;");const e=t.querySelector("img"),r=()=>{e.naturalHeight/e.naturalWidth>1&&(t.style.height="inherit")};r(),e.onload=r;const a=new RegExp("(?<=&id=)\\d+").exec(t.href);if(!a)return;const n=a[0];t.appendChild(new R({id:n,onClick:q}))}))}createArtworkBtn(t){const e=document.querySelector("div.flexi > div");e.style.position="relative",e.appendChild(new Qi({id:t,site:"rule34",onClick:q}))}getCustomConfig(){return{folderPattern:"rule34/{artist}",filenamePattern:"{id}_{artist}_{character}"}}getFilenameTemplate(){return["{artist}","{character}","{id}","{date}"]}getBlacklistTags(){const[t]=new RegExp("(?<=tag_blacklist=).*?(?=;|$)").exec(document.cookie)??[];if(!t)return[];return decodeURIComponent(decodeURIComponent(t)).split(" ")}static get hostname(){return"rule34.xxx"}}const Xi=new class extends D{async getJSON(t,e){u.info("Fetch url:",t);const r=await fetch(t,e);if(r.status>=500)throw new b(r.url,r.status);const a=await r.json();if("success"in a&&!a.success){const{error:t,message:e}=a;throw new y(t+", "+e)}return a}async getPool(t){return await this.getJSON(`/pools/${t}.json`)}async getPost(t){return await this.getJSON(`/posts/${t}.json`)}async getPostList(t){const{tags:e=[],limit:r=0,page:a=0}=t??{},n=new URLSearchParams;return(null==e?void 0:e.length)&&n.append("tags",e.join(" ")),r&&n.append("limit",String(r)),a&&n.append("page",String(a)),await this.getJSON(`/posts.json?${n.toString()}`)}async getArtistCommentary(t){return await this.getJSON(`/posts/${t}/artist_commentary.json`)}async getFavoriteGroups(t){return await this.getJSON(`/favorite_groups/${t}.json`)}async getProfile(){return await this.getJSON("/profile.json")}async addFavorite(t,e){const r=await fetch(`/favorites?post_id=${t}`,{method:"POST",headers:{"X-Csrf-Token":e}});if(!r.ok)throw new b(r.url,r.status);return await r.text()}},Zi={async parse(t,e){const{type:r}=e;return"html"===r?this.parseIdByHtml(t):this.parseIdByApi(t)},_parseBlacklistItem(t){const e=t.split(" "),r=[],a=[],n=[];let o=null;return e.forEach((t=>{if("-"===t.charAt(0))a.push(t.slice(1));else if("~"===t.charAt(0))n.push(t.slice(1));else if(t.match(/^score:<.+/)){const e=t.match(/^score:<(.+)/)[1];o=Number.parseInt(e)}else r.push(t)})),{tags:t,require:r,exclude:a,optional:n,min_score:o}},_getMatchTags(t){const{tag_string:e,rating:r,uploader_id:a,is_deleted:n,is_flagged:o,is_pending:i}=t,s=e.match(/\S+/g)??[];return s.push("rating:"+r),s.push("uploaderid:"+a),n&&s.push("status:deleted"),o&&s.push("status:flagged"),i&&s.push("status:pending"),s},_getMatchTagsByEl(t){const e=/\S+/g,{tags:r="",pools:a,rating:n,uploaderId:o,flags:i}=t.dataset,s=r.match(e)??[];if(a&&s.push(...a.match(e)??[]),n&&s.push("rating:"+n),o&&s.push("uploaderid:"+o),i){const t=i.match(e);t&&t.forEach((t=>s.push("status:"+t)))}return s},async parseBlacklist(t,e){var r;let a,n;if("html"===t?(a=(null==(r=document.querySelector('meta[name="blacklisted-tags"]'))?void 0:r.content)??"",n=/,/):"api"===t?(a=(await Xi.getProfile()).blacklisted_tags??"",n=/\n+/):(a="string"==typeof e?e:"",n=/\n+/),!a)return[];return a.replace(/(rating:\w)\w+/gi,"$1").toLowerCase().split(n).filter((t=>""!==t.trim())).map(this._parseBlacklistItem)},isBlacklisted(t,e){const r=/score:(-?[0-9]+)/,a=(t.find((t=>r.test(t)))??"").match(r),n=a?+a[1]:a;return e.some((e=>{const{require:r,exclude:a,optional:o,min_score:i}=e,s=e=>t.includes(e),l=null===i||null===n||n<i;return r.every(s)&&l&&(!o.length||function(t,e){const r=new Set(t),a=[];return e.forEach((t=>{r.has(t)&&a.push(t)})),a}(t,o).length)&&!a.some(s)}))},async parseIdByHtml(t){var e,r;const a=await Xi.getDoc("/posts/"+t),n=null==(e=a.querySelector("a[download]"))?void 0:e.href;if(!n)throw new Error("Can not get media src");const o=a.querySelector('meta[property="og:image"]').getAttribute("content"),i=o.slice(o.lastIndexOf("/")+1).split(".")[0],s=(a.querySelector('meta[property="og:video:type"]')||a.querySelector('meta[property="og:image:type"]')).getAttribute("content"),l=s.slice(s.lastIndexOf("/")+1),c=[],d=[],u=[],p=a.querySelectorAll('section#tag-list  ul[class*="-tag-list"]');p.length&&p.forEach((t=>{const e=/[a-zA-Z]+(?=-tag-list)/.exec(t.className);if(!e)throw new Error("Unknown tag: "+t.className);const r=e[0],a=t.children;let n;"artist"===r?n=c:"character"===r&&(n=d);for(let t=0;t<a.length;t++){const e=a[t].getAttribute("data-tag-name");e&&(n&&n.push(e),u.push(r+":"+e))}}));const h=(null==(r=a.querySelector("time"))?void 0:r.getAttribute("datetime"))??"";let f="";const g=a.querySelector("#original-artist-commentary");g&&(f=m(g));const w=a.querySelector("section.image-container"),{source:b="",rating:v=""}=w.dataset;return{id:t,src:n,extendName:l,artist:c.join(",")||"UnknownArtist",character:d.join(",")||"UnknownCharacter",title:i,comment:f,tags:u,createDate:h,source:b,rating:v,matchTags:this._getMatchTagsByEl(w)}},async parseIdByApi(t){const[e,r]=await Promise.allSettled([Xi.getPost(t),Xi.getArtistCommentary(t)]);if("rejected"===e.status)throw e.reason;if("rejected"===r.status&&!(r.reason instanceof y))throw r.reason;const{created_at:a,file_ext:n,file_url:o,md5:i,tag_string_artist:s,tag_string_character:l,tag_string_copyright:c,tag_string_general:d,tag_string_meta:u,source:p,rating:h}=e.value,{original_title:f="",original_description:g=""}="value"in r?r.value:{},m=(t,e)=>e.split(" ").map((e=>t+":"+e)),w=[...m("artist",s),...m("character",l),...m("copyright",c),...m("general",d),...m("meta",u)],b=f&&g?f+"\n"+g:f||g;return{id:t,src:o??"",extendName:n,artist:s.replaceAll(" ",",")||"UnknownArtist",character:l.replaceAll(" ",",")||"UnknownCharacter",title:i,comment:b,tags:w,createDate:a,rating:h??"",source:p,matchTags:this._getMatchTags(e.value)}},async*poolAndGroupGenerator(t,e,r,a){const n="pool"===r?await Xi.getPool(e):await Xi.getFavoriteGroups(e);a??(a=(await Xi.getProfile()).per_page);const{post_ids:o}=n,[i=null,s=null]=t??[],l=[],c=o.length;for(let t=0;t<c;t+=a){const e=o.slice(t,t+a).map((t=>String(t)));l.push(e)}const d=l.length,u=i??1,p=s?s>d?d:s:d,h=p===d?(p-u)*a+l[d-1].length:(p-u+1)*a;if(u>d)throw new RangeError(`Page ${u} exceeds the limit.`);for(let t=u-1;t<p;t++)yield{total:h,page:t,avaliable:l[t],invalid:[],unavaliable:[]}},async*postListGenerator(t,e,r,a,n){n||(r&&r.includes("status:deleted")&&(n=!0),n??(n=(await Xi.getProfile()).show_deleted_posts));const[o=1,i=0]=t??[];let s=o,l=await Xi.getPostList({page:s,tags:r,limit:a}),c=l.length,d=null;if(0===c)throw new Error(`There is no post in page ${s}.`);do{let t=null;if(s!==i)try{t=await Xi.getPostList({page:s+1,tags:r,limit:a}),t.length?c+=t.length:t=null}catch(e){d=e,t=null}const o=[],u=[],p=[];for(let t=0;t<l.length;t++){const{id:r,file_ext:a,tag_string:i,is_deleted:s,file_url:c}=l[t],d=String(r);if(s&&!n){u.push(d);continue}c||p.push(d);const h={id:d,extendName:a,tags:i.split(" "),matchTags:this._getMatchTags(l[t])};await e(h)?o.push(d):u.push(d)}yield{total:c,page:s,avaliable:o,invalid:u,unavaliable:p},s++,l=t}while(l);if(d)throw d}};function Ki(t){if(t)return function(e){t.setProgress(e)}}class ts extends H{constructor(t){super(t),this.meta=t}getDownloadConfig(t){if(!this.meta.src)throw new Error(`You need a gold account to see this image. ID: ${this.meta.id}`);return{taskId:this.generateTaskId(),src:this.meta.src,path:this.buildFilePath(),source:this.meta,timeout:this.isImage()?6e4:void 0,onProgress:Ki(t)}}buildFilePath(){return super.buildFilePath().replaceAll("{character}",this.normalizeString(this.meta.character))}}class es extends R{constructor(t){super({...t,shouldObserveDb:!1}),o(this,"downloading"),this.downloading=t.downloading}static get tagNameLowerCase(){return"pdl-danbooru-pool-button"}connectedCallback(){super.connectedCallback(),this.unsubscriber=this.downloading.subscribe((t=>{t?this.setAttribute("disabled",""):this.removeAttribute("disabled")}))}}async function rs(t){var e;try{const r=null==(e=document.head.querySelector('meta[name="csrf-token"]'))?void 0:e.content;if(!r)throw new Error("Can not get csrf-token");const a=await Xi.addFavorite(t,r),n=new RegExp("(?<=^\\/posts\\/)\\d+").exec(location.pathname);n&&t!==n[0]?d.Danbooru.Utility.notice("You have favorited "+t):function(t){const e=document.createElement("script");e.text=t,document.head.appendChild(e).parentNode.removeChild(e)}(a)}catch(t){u.error(t)}}customElements.define(es.tagNameLowerCase,es);class as extends Vi{constructor(){super(...arguments),o(this,"profile",null),o(this,"blacklist",null),o(this,"useBatchDownload",this.app.initBatchDownloader({metaType:{},avatar:"/packs/static/danbooru-logo-128x128-ea111b6658173e847734.png",filterOption:{filters:[{id:"exclude_downloaded",type:"exclude",name:J("downloader.category.filter.exclude_downloaded"),checked:!1,fn:t=>!!t.id&&M.has(t.id)},{id:"exclude_blacklist",type:"exclude",name:J("downloader.category.filter.exclude_blacklist"),checked:!0,fn:async t=>!!t.matchTags&&Zi.isBlacklisted(t.matchTags,this.blacklist??(this.blacklist=await Zi.parseBlacklist("api")))},{id:"allow_image",type:"include",name:J("downloader.category.filter.image"),checked:!0,fn:t=>!!t.extendName&&/bmp|jp(e)?g|png|tif|gif|exif|svg|webp/i.test(t.extendName)},{id:"allow_video",type:"include",name:J("downloader.category.filter.video"),checked:!0,fn:t=>!!t.extendName&&/mp4|avi|mov|mkv|flv|wmv|webm|mpeg|mpg|m4v/i.test(t.extendName)}],enableTagFilter:(t,e)=>{const r=e.map((t=>{var e;return(null==(e=new RegExp("(?<=[a-z]+:).+").exec(t))?void 0:e[0])??""}));return t.some((t=>r.includes(t)))}},pageOption:{pool:{name:"Pool",match:new RegExp("(?<=\\/pools\\/)[0-9]+"),filterInGenerator:!1,fn:t=>{var e,r;const a=null==(e=new RegExp("(?<=\\/pools\\/)[0-9]+").exec(location.pathname))?void 0:e[0];if(!a)throw new Error("Invalid pool id");return Zi.poolAndGroupGenerator(t,a,"pool",null==(r=this.profile)?void 0:r.per_page)}},favorite_groups:{name:"FavoriteGroups",match:new RegExp("(?<=\\/favorite_groups\\/)[0-9]+"),filterInGenerator:!1,fn:t=>{var e,r;const a=null==(e=new RegExp("(?<=\\/favorite_groups\\/)[0-9]+").exec(location.pathname))?void 0:e[0];if(!a)throw new Error("Invalid pool id");return Zi.poolAndGroupGenerator(t,a,"favoriteGroup",null==(r=this.profile)?void 0:r.per_page)}},post_list:{name:"Post",match:()=>"/"===location.pathname||"/posts"===location.pathname,filterInGenerator:!0,fn:(t,e)=>{var r,a;const n=new URLSearchParams(new URL(location.href).search),o=null==(r=n.get("tags"))?void 0:r.split(" "),i=n.get("limit"),s=i?Number(i):void 0;return Zi.postListGenerator(t,e,o,s,null==(a=this.profile)?void 0:a.show_deleted_posts)}},pool_gallery_button:{name:"pool_gallery_button",match:()=>!1,filterInGenerator:!1,fn:(t,e)=>{var r;if(!e)throw new Error("Invalid pool id");return Zi.poolAndGroupGenerator(t,e,"pool",null==(r=this.profile)?void 0:r.per_page)}},show_downloader_in_pool_gallery:{name:"pool_gallery",match:/\/pools\/gallery/}},parseMetaByArtworkId:t=>Zi.parseIdByApi(t),async downloadByArtworkId(t,e){T.dirHandleCheck();const r=new ts(t).getDownloadConfig();r.taskId=e,await T.download(r);const{id:a,tags:n,artist:o,title:i,comment:s,source:l,rating:c}=t;M.add({pid:Number(a),user:o,title:i,comment:s,tags:n,source:l,rating:c})},beforeDownload:async()=>{this.profile=await Xi.getProfile(),this.blacklist=await Zi.parseBlacklist("profile",this.profile.blacklisted_tags??"")},onDownloadAbort(t){T.abort(t)},afterDownload:()=>{this.profile=null,this.blacklist=null}}))}static get hostname(){return"danbooru.donmai.us"}inject(){super.inject(),this.downloadArtwork=this.downloadArtwork.bind(this);const t=location.pathname;if(/^\/posts\/\d+/.test(t)){const t=document.querySelector("section.image-container:not(.blacklisted-active)");if(!t)return;const e=t.getAttribute("data-id");this.createArtworkBtn(e),this.createThumbnailBtn()}else/^\/pools\/gallery/.test(t)?this.createPoolThumbnailBtn():this.createThumbnailBtn()}createThumbnailBtn(){const t=document.querySelectorAll("article a.post-preview-link");t.length&&t.forEach((t=>{var e;const r=null==(e=new RegExp("(?<=\\/posts\\/)\\d+").exec(t.href))?void 0:e[0];if(!r)return;const a=new R({id:r,onClick:this.downloadArtwork});t.appendChild(a)}))}createArtworkBtn(t){const e=document.querySelector("section.image-container:has(picture)");null==e||e.appendChild(new Qi({id:t,onClick:this.downloadArtwork}))}createPoolThumbnailBtn(){const t=document.querySelectorAll("article a.post-preview-link");if(!t.length)return;const{downloading:e,batchDownload:r}=this.useBatchDownload(),a=t=>{const e=t.dataset.id;return r("pool_gallery_button",e)};t.forEach((t=>{var r;const n=null==(r=new RegExp("(?<=\\/pools\\/)\\d+").exec(t.href))?void 0:r[0];if(!n)return;const o=new es({id:n,downloading:e,onClick:a});t.appendChild(o)}))}observeColorScheme(){const t=window.matchMedia("(prefers-color-scheme: dark)");let e=t.matches;const r=document.body.getAttribute("data-current-user-theme");("dark"===r||"auto"===r&&e)&&this.setAppDarkMode(),"auto"===r&&t.addEventListener("change",(t=>{e=t.matches,e?this.setAppDarkMode():this.setAppLightMode()}))}getCustomConfig(){return{folderPattern:"danbooru/{artist}",filenamePattern:"{id}_{artist}_{character}"}}getFilenameTemplate(){return["{artist}","{character}","{id}","{date}"]}async downloadArtwork(t){T.dirHandleCheck();const e=t.dataset.id,r=await Zi.parse(e,{type:"api"}),a=new ts(r).getDownloadConfig(t);this.config.get("addBookmark")&&rs(e),await T.download(a);const{tags:n,artist:o,title:i,comment:s,source:l,rating:c}=r;M.add({pid:Number(e),user:o,title:i,comment:s,tags:n,source:l,rating:c})}}var ns=(t=>(t[t.illusts=0]="illusts",t[t.manga=1]="manga",t[t.ugoira=2]="ugoira",t))(ns||{}),os=(t=>(t[t.public=0]="public",t[t.private=1]="private",t))(os||{});const is=new class extends D{async getJSON(t,e){const r=await super.getJSON(t,e);if(r.error)throw new y(r.message);return r.body}async getArtworkHtml(t,e){const r=await fetch(`/artworks/${t}?lang=${e}`);if(!r.ok)throw new b(r.url,r.status);return await r.text()}getArtworkDetail(t,e){return this.getJSON(`/ajax/illust/${t}?lang=${e}`)}getUnlistedArtworkDetail(t,e){return this.getJSON(`/ajax/illust/unlisted/${t}?lang=${e}`)}addBookmark(t,e,r=[],a=os.public){return this.getJSON("/ajax/illusts/bookmarks/add",{method:"POST",headers:{accept:"application/json","content-type":"application/json; charset=utf-8","x-csrf-token":e},body:JSON.stringify({illust_id:t,restrict:a,comment:"",tags:r})})}likeIllust(t,e){return this.getJSON("/ajax/illusts/like",{method:"POST",headers:{accept:"application/json","content-type":"application/json; charset=utf-8","x-csrf-token":e},body:JSON.stringify({illust_id:t})})}getFollowLatestWorks(t,e="all"){return this.getJSON(`/ajax/follow_latest/illust?p=${t}&mode=${e}&lang=jp`)}getUserAllProfile(t){return this.getJSON("/ajax/user/"+t+"/profile/all")}getUgoiraMeta(t){return this.getJSON("/ajax/illust/"+t+"/ugoira_meta")}getUserData(t){return this.getJSON("/ajax/user/"+t)}getSeriesData(t,e){return this.getJSON(`/ajax/series/${t}?p=${e}`)}},ss={preloadData:/"meta-preload-data" content='(.*?)'>/,globalData:/"meta-global-data" content='(.*?)'>/,artworksPage:/artworks\/(\d+)$/,userPage:/\/users\/(\d+)$|\/users\/(\d+)\/(?!following|mypixiv|followers)/,bookmarkPage:/users\/(\d+)\/bookmarks\/artworks/,userPageTags:new RegExp("(?<=users\\/)([0-9]+)\\/(artworks|illustrations|manga|bookmarks(?=\\/artworks))(?:\\/artworks)?\\/?([^?]*)"),searchPage:/\/tags\/.*\/(artworks|illustrations|manga)/,activityHref:/illust_id=(\d+)/,originSrcPageNum:new RegExp("(?<=_p)\\d+"),followLatest:/\/bookmark_new_illust(?:_r18)?\.php/,historyPage:/\/history\.php/,historyThumbnailsId:/\d+(?=_)/,series:/\/user\/([0-9]+)\/series\/([0-9]+)/,unlisted:new RegExp("(?<=artworks\\/unlisted\\/)[A-Za-z0-9]+")},ls={async parse(t,e){let r,a;const{tagLang:n,type:o}=e;if("api"===o)r=await is.getArtworkDetail(t,n),a="";else if("unlisted"===o)r=await is.getUnlistedArtworkDetail(t,n),a="";else{const e=await is.getArtworkHtml(t,n),o=e.match(ss.preloadData);if(!o)throw new Error("Fail to parse preload data: "+t);const i=e.match(ss.globalData);if(!i)throw new Error("Fail to parse global data: "+t);const s=JSON.parse(o[1]),l=JSON.parse(i[1]);r=s.illust[t],a=l.token}const{id:i,illustType:s,userName:l,userId:c,illustTitle:d,illustComment:u,tags:p,pageCount:h,createDate:f,urls:g,bookmarkData:w,likeData:b}=r,v=[],y=[];p.tags.forEach((t=>{var e;v.push(t.tag),y.push((null==(e=t.translation)?void 0:e.en)||t.tag)}));const x=u.replaceAll(/&lt;|&amp;lt;/g,"<").replaceAll(/&gt;|&amp;gt;/g,">"),k=document.createElement("p");k.innerHTML=x;const $=m(k),C={id:i,src:g.original,extendName:g.original.slice(-3),artist:l,title:d,tags:v,tagsTranslated:y,userId:c,pageCount:h,comment:$,bookmarkData:w,createDate:f,likeData:b,token:a};return s===ns.ugoira?{...C,illustType:s,ugoiraMeta:await is.getUgoiraMeta(t)}:{...C,illustType:s}},async*illustMangaGenerator(t,e,r){const a=await is.getUserAllProfile(r);let n,o,i=[];if("object"==typeof a.illusts&&i.push(...Object.keys(a.illusts)),"object"==typeof a.manga&&i.push(...Object.keys(a.manga)),!i.length)throw new Error(`User ${r} has no illusts or mangas.`);i=i.sort(((t,e)=>Number(e)-Number(t)));const[s=null,l=null]=t??[];let c=s??1;n=null===s?0:48*(s-1),o=null===l?i.length:48*l;const d=i.slice(n,o);if(!d.length)throw new RangeError(`Page ${c} exceeds the limit.`);const u=`https://www.pixiv.net/ajax/user/${r}/profile/illusts?`,p=d.length;do{const t=d.splice(0,48).map((t=>"ids[]="+t)).join("&")+"&work_category=illustManga&is_first_page=0&lang=ja",r=await is.getJSON(u+t),a=Object.values(r.works).sort(((t,e)=>Number(e.id)-Number(t.id))),n=[],o=[],i=[];for(let t=0;t<a.length;t++){const r=a[t],{id:s,isMasked:l}=r;if(l){i.push(String(s));continue}await e(r)?n.push(s):o.push(s)}yield{total:p,page:c,avaliable:n,invalid:o,unavaliable:i},c++}while(d.length>0)},async*chunkGenerator(t,e,r,a,n,o="show"){const i=48,[s=null,l=null]=t??[];if(!r)throw new Error('Require argument "userId".');let c,d,u,p=s??1;c=null===s?0:(s-1)*i;do{let t;t="bookmarks"===a?`/ajax/user/${r}/illusts/bookmarks?tag=${n}&offset=${c}&limit=48&rest=${o}&lang=ja`:`/ajax/user/${r}/${a}/tag?tag=${n}&offset=${c}&limit=48&lang=ja`;const s=await is.getJSON(t),{works:h,total:f}=s;if(0===f)throw new Error(`User ${r} has no ${a} tagged with ${n}.`);if(!d){if(d=null===l||l*i>f?f:l*i,d<=c)throw new RangeError(`Page ${p} exceeds the limit.`);u=d-c}const g=[],m=[],w=[];for(let t=0;t<h.length;t++){const r=h[t],{id:a,isMasked:n}=r;if(n){w.push(String(a));continue}await e(r)?g.push(a):m.push(a)}yield{total:u,page:p,avaliable:g,invalid:m,unavaliable:w},p++}while((c+=i)<d)},async*bookmarkGenerator(t,e,r,a="show",n=""){yield*this.chunkGenerator(t,e,r,"bookmarks",n,a)},async*taggedArtworkGenerator(t,e,r,a,n,o="show"){"bookmarks"===a?yield*this.bookmarkGenerator(t,e,r,o,n):yield*this.chunkGenerator(t,e,r,a,n)},async*followLatestGenerator(t,e,r="all"){let a,n,o,[i=null,s=null]=t??[];if(null===i&&(i=1),(null===s||s>34)&&(s=34),i>34)throw new RangeError(`Page ${i} exceeds the limit.`);let l=i;function c(t){return Math.min(...t)}async function*d(t,r){const a=[],o=[],i=[],{illust:s}=t.thumbnails;for(let t=0;t<s.length;t++){const r=s[t],{id:n,isMasked:l}=r;if(l){i.push(String(n));continue}await e(r)?a.push(n):o.push(n)}const{ids:l}=t.page;if(l.length!==s.length){const t=l.filter((t=>!s.some((e=>+e.id===t))));i.push(...t.map((t=>String(t))))}yield{total:n,page:r,avaliable:a,invalid:o,unavaliable:i}}const p=await is.getFollowLatestWorks(l,r),h=p.page.ids;if(n=h.length,a=c(h),s!==i){if(60===n){const t=await is.getFollowLatestWorks(++l,r),e=t.page.ids,i=c(e);i<a&&(a=i,o=t,n+=e.length)}if(yield*d(p,i),60!==n)if(n<120||s-i==1)yield*d(o,l);else{for(;++l<=s;){const t=await is.getFollowLatestWorks(l,r),e=t.page.ids,i=c(e);if(i>=a){u.info("getFollowLatestGenerator: got duplicate works"),yield*d(o,l-1);break}a=i,n+=e.length,yield*d(o,l-1),o=t}yield*d(o,l-1)}}else yield*d(p,i)},async*seriesGenerator(t,e,r){const[a=1,n=0]=t??[];let o=0,i=0,s=a;do{const t=await is.getSeriesData(r,s),{series:l}=t.page;if(!l.length)throw new Error(`Invalid page: ${s}`);const{illust:c}=t.thumbnails;if(!i){const e=l.some((({order:t})=>1===t)),r=t.page.total;if(e)i=l.length;else if(0===n)i=r;else{const t=l.length,e=Math.ceil(r/t);if(n>=e){i=(e-a)*t+(r%t||t)}else i=(n-a+1)*t}}const d=[],u=[],p=[];for(let t=0;t<l.length;t++){const{workId:r}=l[t],a=c.find((t=>t.id===r));if(!a||a.isMasked){p.push(r);continue}await e(a)?d.push(r):u.push(r)}yield{total:i,page:s,avaliable:d,invalid:u,unavaliable:p},o+=l.length,s++}while(o<i)}};const cs=function(){const t=new r;return{add(e,r,a){var n;null==(n=t.folder(e))||n.file(r,a)},bundle(e,r){const a=t.folder(e);if(!a)throw new TypeError("no such folder:"+e);return a.generateAsync({type:"blob",comment:r})},remove(e){if("string"==typeof e)t.remove(e);else{const r=t.filter(((t,e)=>e.dir)).map((t=>t.name));e.filter((t=>r.some((e=>e.includes(t))))).forEach((e=>t.remove(e))),u.info("Compressor: Remove",t)}},fileCount(e){var r;let a=0;return null==(r=t.folder(e))||r.forEach((()=>a++)),a},async unzip(e){const r=Math.random().toString(36);let a=t.folder(r);if(!a)throw TypeError("Can not get new root folder");const n=[];a=await a.loadAsync(e),a.forEach(((t,e)=>{n.push(e.async("blob"))}));const o=await Promise.all(n);return t.remove(r),o}}}(),ds=GM_getResourceText("gif.js/dist/gif.worker?raw"),us=URL.createObjectURL(new Blob([ds],{type:"text/javascript"}));const ps=GM_getResourceText("upng-js?raw"),hs=GM_getResourceText("pako/dist/pako.js?raw"),fs=URL.createObjectURL(new Blob(['async function encodeAPNG(frames, delays, cnum) {\n    const bitmaps = await Promise.all(frames.map((frame) => {\n        if (frame instanceof Blob) {\n            return createImageBitmap(frame);\n        }\n        else {\n            return frame;\n        }\n    }));\n    const width = bitmaps[0].width;\n    const height = bitmaps[0].height;\n    const canvas = new OffscreenCanvas(width, height);\n    const ctx = canvas.getContext("2d", { willReadFrequently: true });\n    const u8arrs = [];\n    for (let i = 0; i < bitmaps.length; i++) {\n        ctx.drawImage(bitmaps[i], 0, 0);\n        bitmaps[i].close();\n        u8arrs.push(ctx.getImageData(0, 0, width, height).data);\n    }\n    const png = UPNG.encode(u8arrs, width, height, cnum, delays, { loop: 0 });\n    if (!png)\n        throw new Error("Failed to encode apng.");\n    return png;\n}\nasync function decodeApng(ab) {\n    const img = UPNG.decode(ab);\n    const rgba = UPNG.toRGBA8(img);\n    const { width, height } = img;\n    const delays = img.frames.map((frame) => frame.delay);\n    return { frames: rgba, delays, width, height };\n}\nasync function appendEffect(illustBlob, effect, delays, width, height) {\n    if (!Array.isArray(effect)) {\n        const apngDatas = await decodeApng(effect);\n        effect = apngDatas.frames;\n        delays = apngDatas.delays;\n        width = apngDatas.width;\n        height = apngDatas.height;\n    }\n    else {\n        if (!delays || width === void 0 || height === void 0)\n            throw new Error("Missing argument.");\n    }\n    const illustBitmap = await createImageBitmap(illustBlob);\n    const effectBitmaps = await Promise.all(effect.map((buf) => createImageBitmap(new ImageData(new Uint8ClampedArray(buf), width, height))));\n    const { width: illustWidth, height: illustHeight } = illustBitmap;\n    const illustAspectRatio = illustWidth / illustHeight;\n    const effectAspectRatio = width / height;\n    let dx;\n    let dy;\n    let dWidth;\n    let dHeight;\n    if (effectAspectRatio > illustAspectRatio) {\n        dWidth = illustHeight * effectAspectRatio;\n        dHeight = illustHeight;\n        dx = (illustWidth - dWidth) / 2;\n        dy = 0;\n    }\n    else {\n        dWidth = illustWidth;\n        dHeight = illustWidth / effectAspectRatio;\n        dx = 0;\n        dy = (illustHeight - dHeight) / 2;\n    }\n    const canvas = new OffscreenCanvas(illustWidth, illustHeight);\n    const ctx = canvas.getContext("2d", { willReadFrequently: true });\n    const finalDatas = [];\n    for (let i = 0; i < effectBitmaps.length; i++) {\n        ctx.drawImage(illustBitmap, 0, 0);\n        ctx.drawImage(effectBitmaps[i], dx, dy, dWidth, dHeight);\n        finalDatas.push(ctx.getImageData(0, 0, illustWidth, illustHeight));\n        effectBitmaps[i].close();\n    }\n    illustBitmap.close();\n    const bitmaps = [];\n    for (let i = 0; i < finalDatas.length; i++) {\n        const bitmap = await createImageBitmap(finalDatas[i]);\n        bitmaps.push(bitmap);\n    }\n    return {\n        bitmaps,\n        frames: effect,\n        width,\n        height,\n        delays\n    };\n}\nself.onmessage = async (evt) => {\n    try {\n        const data = evt.data;\n        if ("effect" in data) {\n            let result;\n            if ("delays" in data) {\n                const { illust, effect, width, height, delays } = data;\n                result = await appendEffect(illust, effect, delays, width, height);\n            }\n            else {\n                const { illust, effect } = data;\n                result = await appendEffect(illust, effect);\n            }\n            self.postMessage(result, [...result.frames, ...result.bitmaps]);\n        }\n        else {\n            const { frames, delays, cnum = 256 } = data;\n            const apng = await encodeAPNG(frames, delays, cnum);\n            self.postMessage(apng, [apng]);\n        }\n    }\n    catch (error) {\n        console.error(error);\n        self.postMessage(void 0);\n    }\n};\n'+hs+ps.replace("window.UPNG","self.UPNG").replace("window.pako","self.pako")],{type:"text/javascript"})),gs=[];function ms(t){u.info("Start convert:",t.id),u.time(t.id);const{illust:e,data:r}=t.source;let a;return a=r instanceof Blob?r.arrayBuffer():Promise.resolve(r),a.then((r=>new Promise(((a,n)=>{let o,i;if(gs.length?(o=gs.shift(),u.info("Reuse apng workers.")):o=new Worker(fs),t.abort=()=>{u.timeEnd(t.id),u.warn("Convert stop manually. "+t.id),n(new v),t.isAborted=!0,o.terminate()},o.onmessage=function(e){if(u.timeEnd(t.id),o.terminate(),!e.data)return n(new Error("Mix Effect convert Failed "+t.id));a(e.data)},r instanceof ArrayBuffer)i={illust:e,effect:r},o.postMessage(i,[r]);else{const{frames:t,delays:a,width:n,height:s}=r;i={illust:e,delays:a,effect:t,width:n,height:s},o.postMessage(i,t)}}))))}const ws=GM_getResourceText("../wasm/toWebpWorker?raw"),bs=URL.createObjectURL(new Blob([ws+'let webpApi = {};\nModule.onRuntimeInitialized = () => {\n    webpApi = {\n        init: Module.cwrap("init", "", ["number", "number", "number"]),\n        createBuffer: Module.cwrap("createBuffer", "number", ["number"]),\n        addFrame: Module.cwrap("addFrame", "number", ["number", "number", "number"]),\n        generate: Module.cwrap("generate", "number", []),\n        freeResult: Module.cwrap("freeResult", "", []),\n        getResultPointer: Module.cwrap("getResultPointer", "number", []),\n        getResultSize: Module.cwrap("getResultSize", "number", [])\n    };\n    postMessage("ok");\n};\nonmessage = async (evt) => {\n    const { frames, delays, lossless = 0, quality = 95, method = 4 } = evt.data;\n    webpApi.init(lossless, quality, method);\n    const bitmaps = await Promise.all(frames.map((frame) => {\n        if (frame instanceof Blob) {\n            return createImageBitmap(frame);\n        }\n        else {\n            return frame;\n        }\n    }));\n    const width = bitmaps[0].width;\n    const height = bitmaps[0].height;\n    const canvas = new OffscreenCanvas(width, height);\n    const ctx = canvas.getContext("2d");\n    for (let i = 0; i < bitmaps.length; i++) {\n        ctx?.drawImage(bitmaps[i], 0, 0);\n        bitmaps[i].close();\n        const webpBlob = await canvas.convertToBlob({\n            type: "image/webp",\n            quality: lossless ? 1 : quality / 100\n        });\n        const buffer = await webpBlob.arrayBuffer();\n        const u8a = new Uint8Array(buffer);\n        const pointer = webpApi.createBuffer(u8a.length);\n        Module.HEAPU8.set(u8a, pointer);\n        webpApi.addFrame(pointer, u8a.length, delays[i]);\n        postMessage((i + 1) / bitmaps.length * 100);\n    }\n    webpApi.generate();\n    const resultPointer = webpApi.getResultPointer();\n    const resultSize = webpApi.getResultSize();\n    const result = new Uint8Array(Module.HEAP8.buffer, resultPointer, resultSize);\n    postMessage(result);\n    webpApi.freeResult();\n};\n'],{type:"text/javascript"})),vs=[];function ys(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var xs,ks={exports:{}};xs=ks,function(){function t(t,e){return function(t){if("string"!=typeof t||!t.match(/^data:image\/webp;base64,/i))throw new Error("Failed to decode WebP Base64 URL");return window.atob(t.substring(23))}("string"==typeof t&&/^data:image\/webp/.test(t)?t:t.toDataURL("image/webp",e))}function e(t){let e=t.indexOf("VP8",12);if(-1===e)throw new Error("Bad image format, does this browser support WebP?");let r=!1;for(;e<t.length-8;){let n,o;switch(o=t.substring(e,e+4),e+=4,n=((a=t.substring(e,e+4)).charCodeAt(0)|a.charCodeAt(1)<<8|a.charCodeAt(2)<<16|a.charCodeAt(3)<<24)>>>0,e+=4,o){case"VP8 ":return{frame:t.substring(e,e+n),hasAlpha:r};case"ALPH":r=!0}e+=n,1&n&&e++}var a;throw new Error("Failed to find VP8 keyframe in WebP image, is this image mistakenly encoded in the Lossless WebP format?")}function r(t){this.value=t}function a(t){this.value=t}function n(t,e,o){if(Array.isArray(o))for(let r=0;r<o.length;r++)n(t,e,o[r]);else if("string"==typeof o)t.writeString(o);else if(o instanceof Uint8Array)t.writeBytes(o);else{if(!o.id)throw new Error("Bad EBML datatype "+typeof o.data);if(o.offset=t.pos+e,t.writeUnsignedIntBE(o.id),Array.isArray(o.data)){let r,a,i;-1===o.size?t.writeByte(255):-2===o.size?(r=t.pos,t.writeBytes([15,255,255,255,255])):(r=t.pos,t.writeBytes([0,0,0,0])),a=t.pos,o.dataOffset=a+e,n(t,e,o.data),-1!==o.size&&-2!==o.size&&(i=t.pos,o.size=i-a,t.seek(r),t.writeEBMLVarIntWidth(o.size,4),t.seek(i))}else if("string"==typeof o.data)t.writeEBMLVarInt(o.data.length),o.dataOffset=t.pos+e,t.writeString(o.data);else if("number"==typeof o.data)o.size||(o.size=t.measureUnsignedInt(o.data)),t.writeEBMLVarInt(o.size),o.dataOffset=t.pos+e,t.writeUnsignedIntBE(o.data,o.size);else if(o.data instanceof a)t.writeEBMLVarInt(8),o.dataOffset=t.pos+e,t.writeDoubleBE(o.data.value);else if(o.data instanceof r)t.writeEBMLVarInt(4),o.dataOffset=t.pos+e,t.writeFloatBE(o.data.value);else{if(!(o.data instanceof Uint8Array))throw new Error("Bad EBML datatype "+typeof o.data);t.writeEBMLVarInt(o.data.byteLength),o.dataOffset=t.pos+e,t.writeBytes(o.data)}}}let o=function(r,o){return function(i){let s,l,c=!1,d=0,u=0,p=null,h=null,f=null,g=[],m=0,w=0,b={Cues:{id:new Uint8Array([28,83,187,107]),positionEBML:null},SegmentInfo:{id:new Uint8Array([21,73,169,102]),positionEBML:null},Tracks:{id:new Uint8Array([22,84,174,107]),positionEBML:null}},v={id:17545,data:new a(0)},y=[],x=new o(i.fileWriter||i.fd);function k(t){return t-s.dataOffset}function $(){l=function(){let t={id:21420,size:5,data:0},e={id:290298740,data:[]};for(let r in b){let a=b[r];a.positionEBML=Object.create(t),e.data.push({id:19899,data:[{id:21419,data:a.id},a.positionEBML]})}return e}();let t={id:357149030,data:[{id:2807729,data:1e6},{id:19840,data:"webm-writer-js"},{id:22337,data:"webm-writer-js"},v]},e=[{id:176,data:d},{id:186,data:u}];i.transparent&&e.push({id:21440,data:1});let a={id:374648427,data:[{id:174,data:[{id:215,data:1},{id:29637,data:1},{id:156,data:0},{id:2274716,data:"und"},{id:134,data:"V_VP8"},{id:2459272,data:"VP8"},{id:131,data:1},{id:224,data:e}]}]};s={id:408125543,size:-2,data:[l,t,a]};let o=new r(256);n(o,x.pos,[{id:440786851,data:[{id:17030,data:1},{id:17143,data:1},{id:17138,data:4},{id:17139,data:8},{id:17026,data:"webm"},{id:17031,data:2},{id:17029,data:2}]},s]),x.write(o.getAsDataArray()),b.SegmentInfo.positionEBML.data=k(t.offset),b.Tracks.positionEBML.data=k(a.offset),c=!0}function C(t){return t.alpha?function(t){let e,a,n=new r(4);if(!(t.trackNumber>0&&t.trackNumber<127))throw new Error("TrackNumber must be > 0 and < 127");return n.writeEBMLVarInt(t.trackNumber),n.writeU16BE(t.timecode),n.writeByte(0),e={id:161,data:[n.getAsDataArray(),t.frame]},a={id:30113,data:[{id:166,data:[{id:238,data:1},{id:165,data:t.alpha}]}]},{id:160,data:[e,a]}}(t):function(t){let e=new r(4);if(!(t.trackNumber>0&&t.trackNumber<127))throw new Error("TrackNumber must be > 0 and < 127");return e.writeEBMLVarInt(t.trackNumber),e.writeU16BE(t.timecode),e.writeByte(128),{id:163,data:[e.getAsDataArray(),t.frame]}}(t)}function A(){if(0===g.length)return;let t=0;for(let e=0;e<g.length;e++)t+=g[e].frame.length+(g[e].alpha?g[e].alpha.length:0);let e=new r(t+64*g.length),a=function(t){return{id:524531317,data:[{id:231,data:Math.round(t.timecode)}]}}({timecode:Math.round(m)});for(let t=0;t<g.length;t++)a.data.push(C(g[t]));var o,i,s;n(e,x.pos,a),x.write(e.getAsDataArray()),o=1,i=Math.round(m),s=a.offset,y.push({id:187,data:[{id:179,data:i},{id:183,data:[{id:247,data:o},{id:241,data:k(s)}]}]}),g=[],m+=w,w=0}this.addFrame=function(r,a,n){c||(d=r.width||0,u=r.height||0,$());let o,s=e(t(r,i.quality)),l=null;o=n||("number"==typeof a?a:i.frameDuration),i.transparent&&(a instanceof HTMLCanvasElement||"string"==typeof a?l=a:s.hasAlpha&&(l=function(t){null!==p&&p.width===t.width&&p.height===t.height||(p=document.createElement("canvas"),p.width=t.width,p.height=t.height,h=p.getContext("2d"),f=h.createImageData(p.width,p.height));let e=t.getContext("2d").getImageData(0,0,t.width,t.height).data,r=f.data,a=0,n=t.width*t.height*4;for(let t=3;t<n;t+=4){let n=e[t];r[a++]=n,r[a++]=n,r[a++]=n,r[a++]=255}return h.putImageData(f,0,0),p}(r))),function(t){t.trackNumber=1,t.timecode=Math.round(w),g.push(t),w+=t.duration,w>=5e3&&A()}({frame:s.frame,duration:o,alpha:l?e(t(l,i.alphaQuality)).frame:null})},this.complete=function(){return c||$(),A(),function(){let t={id:475249515,data:y},e=new r(16+32*y.length);n(e,x.pos,t),x.write(e.getAsDataArray()),b.Cues.positionEBML.data=k(t.offset)}(),function(){let t=new r(l.size),e=x.pos;n(t,l.dataOffset,l.data),x.seek(l.dataOffset),x.write(t.getAsDataArray()),x.seek(e)}(),function(){let t=new r(8),e=x.pos;t.writeDoubleBE(m),x.seek(v.dataOffset),x.write(t.getAsDataArray()),x.seek(e)}(),function(){let t=new r(10),e=x.pos;t.writeUnsignedIntBE(s.id),t.writeEBMLVarIntWidth(x.pos-s.dataOffset,5),x.seek(s.offset),x.write(t.getAsDataArray()),x.seek(e)}(),x.complete("video/webm")},this.getWrittenSize=function(){return x.length},i=function(t,e){let r={};return[t,e].forEach((function(t){for(let e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e])})),r}({quality:.95,transparent:!1,alphaQuality:void 0,fileWriter:null,fd:null,frameDuration:null,frameRate:null},i||{}),function(){if(!i.frameDuration){if(!i.frameRate)throw new Error("Missing required frameDuration or frameRate setting");i.frameDuration=1e3/i.frameRate}i.quality=Math.max(Math.min(i.quality,.99999),0),void 0===i.alphaQuality?i.alphaQuality=i.quality:i.alphaQuality=Math.max(Math.min(i.alphaQuality,.99999),0)}()}};xs.exports=o}();var $s=ks.exports,Cs={exports:{}};!function(t){!function(){let e=function(t){this.data=new Uint8Array(t),this.pos=0};e.prototype.seek=function(t){this.pos=t},e.prototype.writeBytes=function(t){for(let e=0;e<t.length;e++)this.data[this.pos++]=t[e]},e.prototype.writeByte=function(t){this.data[this.pos++]=t},e.prototype.writeU8=e.prototype.writeByte,e.prototype.writeU16BE=function(t){this.data[this.pos++]=t>>8,this.data[this.pos++]=t},e.prototype.writeDoubleBE=function(t){let e=new Uint8Array(new Float64Array([t]).buffer);for(let t=e.length-1;t>=0;t--)this.writeByte(e[t])},e.prototype.writeFloatBE=function(t){let e=new Uint8Array(new Float32Array([t]).buffer);for(let t=e.length-1;t>=0;t--)this.writeByte(e[t])},e.prototype.writeString=function(t){for(let e=0;e<t.length;e++)this.data[this.pos++]=t.charCodeAt(e)},e.prototype.writeEBMLVarIntWidth=function(t,e){switch(e){case 1:this.writeU8(128|t);break;case 2:this.writeU8(64|t>>8),this.writeU8(t);break;case 3:this.writeU8(32|t>>16),this.writeU8(t>>8),this.writeU8(t);break;case 4:this.writeU8(16|t>>24),this.writeU8(t>>16),this.writeU8(t>>8),this.writeU8(t);break;case 5:this.writeU8(8|t/4294967296&7),this.writeU8(t>>24),this.writeU8(t>>16),this.writeU8(t>>8),this.writeU8(t);break;default:throw new Error("Bad EBML VINT size "+e)}},e.prototype.measureEBMLVarInt=function(t){if(t<127)return 1;if(t<16383)return 2;if(t<2097151)return 3;if(t<268435455)return 4;if(t<34359738367)return 5;throw new Error("EBML VINT size not supported "+t)},e.prototype.writeEBMLVarInt=function(t){this.writeEBMLVarIntWidth(t,this.measureEBMLVarInt(t))},e.prototype.writeUnsignedIntBE=function(t,e){switch(void 0===e&&(e=this.measureUnsignedInt(t)),e){case 5:this.writeU8(Math.floor(t/4294967296));case 4:this.writeU8(t>>24);case 3:this.writeU8(t>>16);case 2:this.writeU8(t>>8);case 1:this.writeU8(t);break;default:throw new Error("Bad UINT size "+e)}},e.prototype.measureUnsignedInt=function(t){return t<256?1:t<65536?2:t<1<<24?3:t<4294967296?4:5},e.prototype.getAsDataArray=function(){if(this.pos<this.data.byteLength)return this.data.subarray(0,this.pos);if(this.pos==this.data.byteLength)return this.data;throw new Error("ArrayBufferDataStream's pos lies beyond end of buffer")},t.exports=e}()}(Cs);var As=Cs.exports,Es={exports:{}};!function(t){!function(){let e=function(t){return function(e){let r=[],a=Promise.resolve(),n=null,o=null;function i(t){return new Promise((function(e,r){let a=new FileReader;a.addEventListener("loadend",(function(){e(a.result)})),a.readAsArrayBuffer(t)}))}function s(t){return new Promise((function(e,r){t instanceof Uint8Array?e(t):t instanceof ArrayBuffer||ArrayBuffer.isView(t)?e(new Uint8Array(t)):t instanceof Blob?e(i(t).then((function(t){return new Uint8Array(t)}))):e(i(new Blob([t])).then((function(t){return new Uint8Array(t)})))}))}function l(t){let e=t.byteLength||t.length||t.size;if(!Number.isInteger(e))throw new Error("Failed to determine size of element");return e}e&&"FileWriter"===e.constructor.name?n=e:t&&e&&(o=e),this.pos=0,this.length=0,this.seek=function(t){if(t<0)throw new Error("Offset may not be negative");if(isNaN(t))throw new Error("Offset may not be NaN");if(t>this.length)throw new Error("Seeking beyond the end of file is not allowed");this.pos=t},this.write=function(e){let i={offset:this.pos,data:e,length:l(e)},c=i.offset>=this.length;this.pos+=i.length,this.length=Math.max(this.length,this.pos),a=a.then((function(){if(o)return new Promise((function(e,r){s(i.data).then((function(r){let a=0,n=Buffer.from(r.buffer),s=function(r,n,l){a+=n,a>=l.length?e():t.write(o,l,a,l.length-a,i.offset+a,s)};t.write(o,n,0,n.length,i.offset,s)}))}));if(n)return new Promise((function(t,e){n.onwriteend=t,n.seek(i.offset),n.write(new Blob([i.data]))}));if(!c)for(let t=0;t<r.length;t++){let e=r[t];if(!(i.offset+i.length<=e.offset||i.offset>=e.offset+e.length)){if(i.offset<e.offset||i.offset+i.length>e.offset+e.length)throw new Error("Overwrite crosses blob boundaries");return i.offset==e.offset&&i.length==e.length?void(e.data=i.data):s(e.data).then((function(t){return e.data=t,s(i.data)})).then((function(t){i.data=t,e.data.set(i.data,i.offset-e.offset)}))}}r.push(i)}))},this.complete=function(t){return a=o||n?a.then((function(){return null})):a.then((function(){let e=[];for(let t=0;t<r.length;t++)e.push(r[t].data);return new Blob(e,{type:t})})),a}}};t.exports=e}()}(Es);const _s=ys($s(As,(0,Es.exports)(null)));var Ss,Ps,Is,Ts,Bs,Ls,Ms,Ds,zs=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},Fs=(t,e,r)=>(zs(t,e,"read from private field"),r?r.call(t):e.get(t)),Os=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},Ns=(t,e,r,a)=>(zs(t,e,"write to private field"),e.set(t,r),r),js=(t,e,r)=>(zs(t,e,"access private method"),r),Rs=new Uint8Array(8),Hs=new DataView(Rs.buffer),Us=t=>[(t%256+256)%256],Ws=t=>(Hs.setUint16(0,t,!1),[Rs[0],Rs[1]]),qs=t=>(Hs.setUint32(0,t,!1),[Rs[1],Rs[2],Rs[3]]),Gs=t=>(Hs.setUint32(0,t,!1),[Rs[0],Rs[1],Rs[2],Rs[3]]),Ys=t=>(Hs.setUint32(0,Math.floor(t/2**32),!1),Hs.setUint32(4,t,!1),[Rs[0],Rs[1],Rs[2],Rs[3],Rs[4],Rs[5],Rs[6],Rs[7]]),Vs=t=>(Hs.setInt16(0,256*t,!1),[Rs[0],Rs[1]]),Qs=t=>(Hs.setInt32(0,65536*t,!1),[Rs[0],Rs[1],Rs[2],Rs[3]]),Js=t=>(Hs.setInt32(0,2**30*t,!1),[Rs[0],Rs[1],Rs[2],Rs[3]]),Xs=(t,e=!1)=>{let r=Array(t.length).fill(null).map(((e,r)=>t.charCodeAt(r)));return e&&r.push(0),r},Zs=t=>t&&t[t.length-1],Ks=t=>{let e;for(let r of t)(!e||r.presentationTimestamp>e.presentationTimestamp)&&(e=r);return e},tl=(t,e,r=!0)=>{let a=t*e;return r?Math.round(a):a},el=t=>{let e=t*(Math.PI/180),r=Math.cos(e),a=Math.sin(e);return[r,a,0,-a,r,0,0,0,1]},rl=el(0),al=t=>[Qs(t[0]),Qs(t[1]),Js(t[2]),Qs(t[3]),Qs(t[4]),Js(t[5]),Qs(t[6]),Qs(t[7]),Js(t[8])],nl=t=>t?"object"!=typeof t?t:Array.isArray(t)?t.map(nl):Object.fromEntries(Object.entries(t).map((([t,e])=>[t,nl(e)]))):t,ol=t=>t>=0&&t<2**32,il=(t,e,r)=>({type:t,contents:e&&new Uint8Array(e.flat(10)),children:r}),sl=(t,e,r,a,n)=>il(t,[Us(e),qs(r),a??[]],n),ll=t=>({type:"mdat",largeSize:t}),cl=(t,e,r=!1)=>il("moov",null,[dl(e,t),...t.map((t=>ul(t,e))),r?Bl(t):null]),dl=(t,e)=>{let r=tl(Math.max(0,...e.filter((t=>t.samples.length>0)).map((t=>{const e=Ks(t.samples);return e.presentationTimestamp+e.duration}))),Jc),a=Math.max(...e.map((t=>t.id)))+1,n=!ol(t)||!ol(r),o=n?Ys:Gs;return sl("mvhd",+n,0,[o(t),o(t),Gs(Jc),o(r),Qs(1),Vs(1),Array(10).fill(0),al(rl),Array(24).fill(0),Gs(a)])},ul=(t,e)=>il("trak",null,[pl(t,e),hl(t,e)]),pl=(t,e)=>{let r,a=Ks(t.samples),n=tl(a?a.presentationTimestamp+a.duration:0,Jc),o=!ol(e)||!ol(n),i=o?Ys:Gs;return r="video"===t.info.type?"number"==typeof t.info.rotation?el(t.info.rotation):t.info.rotation:rl,sl("tkhd",+o,3,[i(e),i(e),Gs(t.id),Gs(0),i(n),Array(8).fill(0),Ws(0),Ws(0),Vs("audio"===t.info.type?1:0),Ws(0),al(r),Qs("video"===t.info.type?t.info.width:0),Qs("video"===t.info.type?t.info.height:0)])},hl=(t,e)=>il("mdia",null,[fl(t,e),gl("video"===t.info.type?"vide":"soun"),ml(t)]),fl=(t,e)=>{let r=Ks(t.samples),a=tl(r?r.presentationTimestamp+r.duration:0,t.timescale),n=!ol(e)||!ol(a),o=n?Ys:Gs;return sl("mdhd",+n,0,[o(e),o(e),Gs(t.timescale),o(a),Ws(21956),Ws(0)])},gl=t=>sl("hdlr",0,0,[Xs("mhlr"),Xs(t),Gs(0),Gs(0),Gs(0),Xs("mp4-muxer-hdlr",!0)]),ml=t=>il("minf",null,["video"===t.info.type?wl():bl(),vl(),kl(t)]),wl=()=>sl("vmhd",0,1,[Ws(0),Ws(0),Ws(0),Ws(0)]),bl=()=>sl("smhd",0,0,[Ws(0),Ws(0)]),vl=()=>il("dinf",null,[yl()]),yl=()=>sl("dref",0,0,[Gs(1)],[xl()]),xl=()=>sl("url ",0,1),kl=t=>{const e=t.compositionTimeOffsetTable.length>1||t.compositionTimeOffsetTable.some((t=>0!==t.sampleCompositionTimeOffset));return il("stbl",null,[$l(t),El(t),_l(t),Sl(t),Pl(t),Il(t),e?Tl(t):null])},$l=t=>sl("stsd",0,0,[Gs(1)],["video"===t.info.type?Cl(Ul[t.info.codec],t):Al(ql[t.info.codec],t)]),Cl=(t,e)=>{return il(t,[Array(6).fill(0),Ws(1),Ws(0),Ws(0),Array(12).fill(0),Ws(e.info.width),Ws(e.info.height),Gs(4718592),Gs(4718592),Gs(0),Ws(1),Array(32).fill(0),Ws(24),(r=65535,Hs.setInt16(0,r,!1),[Rs[0],Rs[1]])],[Wl[e.info.codec](e)]);var r},Al=(t,e)=>il(t,[Array(6).fill(0),Ws(1),Ws(0),Ws(0),Gs(0),Ws(e.info.numberOfChannels),Ws(16),Ws(0),Ws(0),Qs(e.info.sampleRate)],[Gl[e.info.codec](e)]),El=t=>sl("stts",0,0,[Gs(t.timeToSampleTable.length),t.timeToSampleTable.map((t=>[Gs(t.sampleCount),Gs(t.sampleDelta)]))]),_l=t=>{if(t.samples.every((t=>"key"===t.type)))return null;let e=[...t.samples.entries()].filter((([,t])=>"key"===t.type));return sl("stss",0,0,[Gs(e.length),e.map((([t])=>Gs(t+1)))])},Sl=t=>sl("stsc",0,0,[Gs(t.compactlyCodedChunkTable.length),t.compactlyCodedChunkTable.map((t=>[Gs(t.firstChunk),Gs(t.samplesPerChunk),Gs(1)]))]),Pl=t=>sl("stsz",0,0,[Gs(0),Gs(t.samples.length),t.samples.map((t=>Gs(t.size)))]),Il=t=>t.finalizedChunks.length>0&&Zs(t.finalizedChunks).offset>=2**32?sl("co64",0,0,[Gs(t.finalizedChunks.length),t.finalizedChunks.map((t=>Ys(t.offset)))]):sl("stco",0,0,[Gs(t.finalizedChunks.length),t.finalizedChunks.map((t=>Gs(t.offset)))]),Tl=t=>sl("ctts",0,0,[Gs(t.compositionTimeOffsetTable.length),t.compositionTimeOffsetTable.map((t=>[Gs(t.sampleCount),Gs(t.sampleCompositionTimeOffset)]))]),Bl=t=>il("mvex",null,t.map(Ll)),Ll=t=>sl("trex",0,0,[Gs(t.id),Gs(1),Gs(0),Gs(0),Gs(0)]),Ml=(t,e)=>il("moof",null,[Dl(t),...e.map(Fl)]),Dl=t=>sl("mfhd",0,0,[Gs(t)]),zl=t=>{let e=0,r=0,a="delta"===t.type;return r|=+a,e|=a?1:2,e<<24|r<<16},Fl=t=>il("traf",null,[Ol(t),Nl(t),jl(t)]),Ol=t=>{let e=0;e|=8,e|=16,e|=32,e|=131072;let r=t.currentChunk.samples[1]??t.currentChunk.samples[0],a={duration:r.timescaleUnitsToNextSample,size:r.size,flags:zl(r)};return sl("tfhd",0,131128,[Gs(t.id),Gs(a.duration),Gs(a.size),Gs(a.flags)])},Nl=t=>sl("tfdt",1,0,[Ys(tl(t.currentChunk.startTimestamp,t.timescale))]),jl=t=>{let e=t.currentChunk.samples.map((t=>t.timescaleUnitsToNextSample)),r=t.currentChunk.samples.map((t=>t.size)),a=t.currentChunk.samples.map(zl),n=t.currentChunk.samples.map((e=>tl(e.presentationTimestamp-e.decodeTimestamp,t.timescale))),o=new Set(e),i=new Set(r),s=new Set(a),l=new Set(n),c=2===s.size&&a[0]!==a[1],d=o.size>1,u=i.size>1,p=!c&&s.size>1,h=l.size>1||[...l].some((t=>0!==t)),f=0;return f|=1,f|=4*+c,f|=256*+d,f|=512*+u,f|=1024*+p,f|=2048*+h,sl("trun",1,f,[Gs(t.currentChunk.samples.length),Gs(t.currentChunk.offset-t.currentChunk.moofOffset||0),c?Gs(a[0]):[],t.currentChunk.samples.map(((t,o)=>{return[d?Gs(e[o]):[],u?Gs(r[o]):[],p?Gs(a[o]):[],h?(i=n[o],Hs.setInt32(0,i,!1),[Rs[0],Rs[1],Rs[2],Rs[3]]):[]];var i}))])},Rl=(t,e)=>sl("tfra",1,0,[Gs(t.id),Gs(63),Gs(t.finalizedChunks.length),t.finalizedChunks.map((r=>[Ys(tl(r.startTimestamp,t.timescale)),Ys(r.moofOffset),Gs(e+1),Gs(1),Gs(1)]))]),Hl=()=>sl("mfro",0,0,[Gs(0)]),Ul={avc:"avc1",hevc:"hvc1",vp9:"vp09",av1:"av01"},Wl={avc:t=>t.info.decoderConfig&&il("avcC",[...new Uint8Array(t.info.decoderConfig.description)]),hevc:t=>t.info.decoderConfig&&il("hvcC",[...new Uint8Array(t.info.decoderConfig.description)]),vp9:t=>{if(!t.info.decoderConfig)return null;let e=t.info.decoderConfig;if(!e.colorSpace)throw new Error("'colorSpace' is required in the decoder config for VP9.");let r=e.codec.split("."),a=Number(r[1]),n=Number(r[2]),o=0+(Number(r[3])<<4)+Number(e.colorSpace.fullRange);return sl("vpcC",1,0,[Us(a),Us(n),Us(o),Us(2),Us(2),Us(2),Ws(0)])},av1:()=>il("av1C",[129,0,0,0])},ql={aac:"mp4a",opus:"Opus"},Gl={aac:t=>{let e=new Uint8Array(t.info.decoderConfig.description);return sl("esds",0,0,[Gs(58753152),Us(32+e.byteLength),Ws(1),Us(0),Gs(75530368),Us(18+e.byteLength),Us(64),Us(21),qs(0),Gs(130071),Gs(130071),Gs(92307584),Us(e.byteLength),...e,Gs(109084800),Us(1),Us(2)])},opus:t=>il("dOps",[Us(0),Us(t.info.numberOfChannels),Ws(3840),Gs(t.info.sampleRate),Vs(0),Us(0)])},Yl=class{constructor(){this.buffer=null}},Vl=class{constructor(t){this.options=t}},Ql=class{constructor(t,e){this.stream=t,this.options=e}},Jl=class{constructor(){this.pos=0,Os(this,Ss,new Uint8Array(8)),Os(this,Ps,new DataView(Fs(this,Ss).buffer)),this.offsets=new WeakMap}seek(t){this.pos=t}writeU32(t){Fs(this,Ps).setUint32(0,t,!1),this.write(Fs(this,Ss).subarray(0,4))}writeU64(t){Fs(this,Ps).setUint32(0,Math.floor(t/2**32),!1),Fs(this,Ps).setUint32(4,t,!1),this.write(Fs(this,Ss).subarray(0,8))}writeAscii(t){for(let e=0;e<t.length;e++)Fs(this,Ps).setUint8(e%8,t.charCodeAt(e)),e%8==7&&this.write(Fs(this,Ss));t.length%8!=0&&this.write(Fs(this,Ss).subarray(0,t.length%8))}writeBox(t){if(this.offsets.set(t,this.pos),t.contents&&!t.children)this.writeBoxHeader(t,t.size??t.contents.byteLength+8),this.write(t.contents);else{let e=this.pos;if(this.writeBoxHeader(t,0),t.contents&&this.write(t.contents),t.children)for(let e of t.children)e&&this.writeBox(e);let r=this.pos,a=t.size??r-e;this.seek(e),this.writeBoxHeader(t,a),this.seek(r)}}writeBoxHeader(t,e){this.writeU32(t.largeSize?1:e),this.writeAscii(t.type),t.largeSize&&this.writeU64(e)}measureBoxHeader(t){return 8+(t.largeSize?8:0)}patchBox(t){let e=this.pos;this.seek(this.offsets.get(t)),this.writeBox(t),this.seek(e)}measureBox(t){if(t.contents&&!t.children){return this.measureBoxHeader(t)+t.contents.byteLength}{let e=this.measureBoxHeader(t);if(t.contents&&(e+=t.contents.byteLength),t.children)for(let r of t.children)r&&(e+=this.measureBox(r));return e}}};Ss=new WeakMap,Ps=new WeakMap;var Xl,Zl,Kl=class extends Jl{constructor(t){super(),Os(this,Ms),Os(this,Is,void 0),Os(this,Ts,new ArrayBuffer(65536)),Os(this,Bs,new Uint8Array(Fs(this,Ts))),Os(this,Ls,0),Ns(this,Is,t)}write(t){js(this,Ms,Ds).call(this,this.pos+t.byteLength),Fs(this,Bs).set(t,this.pos),this.pos+=t.byteLength,Ns(this,Ls,Math.max(Fs(this,Ls),this.pos))}finalize(){js(this,Ms,Ds).call(this,this.pos),Fs(this,Is).buffer=Fs(this,Ts).slice(0,Math.max(Fs(this,Ls),this.pos))}};Is=new WeakMap,Ts=new WeakMap,Bs=new WeakMap,Ls=new WeakMap,Ms=new WeakSet,Ds=function(t){let e=Fs(this,Ts).byteLength;for(;e<t;)e*=2;if(e===Fs(this,Ts).byteLength)return;let r=new ArrayBuffer(e),a=new Uint8Array(r);a.set(Fs(this,Bs),0),Ns(this,Ts,r),Ns(this,Bs,a)};var tc=class extends Jl{constructor(t){super(),Os(this,Xl,void 0),Os(this,Zl,[]),Ns(this,Xl,t)}write(t){Fs(this,Zl).push({data:t.slice(),start:this.pos}),this.pos+=t.byteLength}flush(){var t,e;if(0===Fs(this,Zl).length)return;let r=[],a=[...Fs(this,Zl)].sort(((t,e)=>t.start-e.start));r.push({start:a[0].start,size:a[0].data.byteLength});for(let t=1;t<a.length;t++){let e=r[r.length-1],n=a[t];n.start<=e.start+e.size?e.size=Math.max(e.size,n.start+n.data.byteLength-e.start):r.push({start:n.start,size:n.data.byteLength})}for(let a of r){a.data=new Uint8Array(a.size);for(let t of Fs(this,Zl))a.start<=t.start&&t.start<a.start+a.size&&a.data.set(t.data,t.start-a.start);null==(e=(t=Fs(this,Xl).options).onData)||e.call(t,a.data,a.start)}Fs(this,Zl).length=0}finalize(){}};Xl=new WeakMap,Zl=new WeakMap;var ec,rc,ac,nc,oc,ic,sc,lc,cc,dc,uc,pc=class extends Jl{constructor(t){var e;if(super(),Os(this,nc),Os(this,ic),Os(this,lc),Os(this,dc),Os(this,ec,void 0),Os(this,rc,void 0),Os(this,ac,[]),Ns(this,ec,t),Ns(this,rc,(null==(e=t.options)?void 0:e.chunkSize)??16777216),!Number.isInteger(Fs(this,rc))||Fs(this,rc)<1024)throw new Error("Invalid StreamTarget options: chunkSize must be an integer not smaller than 1024.")}write(t){js(this,nc,oc).call(this,t,this.pos),js(this,dc,uc).call(this),this.pos+=t.byteLength}finalize(){js(this,dc,uc).call(this,!0)}};ec=new WeakMap,rc=new WeakMap,ac=new WeakMap,nc=new WeakSet,oc=function(t,e){let r=Fs(this,ac).findIndex((t=>t.start<=e&&e<t.start+Fs(this,rc)));-1===r&&(r=js(this,lc,cc).call(this,e));let a=Fs(this,ac)[r],n=e-a.start,o=t.subarray(0,Math.min(Fs(this,rc)-n,t.byteLength));a.data.set(o,n);let i={start:n,end:n+o.byteLength};if(js(this,ic,sc).call(this,a,i),0===a.written[0].start&&a.written[0].end===Fs(this,rc)&&(a.shouldFlush=!0),Fs(this,ac).length>2){for(let t=0;t<Fs(this,ac).length-1;t++)Fs(this,ac)[t].shouldFlush=!0;js(this,dc,uc).call(this)}o.byteLength<t.byteLength&&js(this,nc,oc).call(this,t.subarray(o.byteLength),e+o.byteLength)},ic=new WeakSet,sc=function(t,e){let r=0,a=t.written.length-1,n=-1;for(;r<=a;){let o=Math.floor(r+(a-r+1)/2);t.written[o].start<=e.start?(r=o+1,n=o):a=o-1}for(t.written.splice(n+1,0,e),(-1===n||t.written[n].end<e.start)&&n++;n<t.written.length-1&&t.written[n].end>=t.written[n+1].start;)t.written[n].end=Math.max(t.written[n].end,t.written[n+1].end),t.written.splice(n+1,1)},lc=new WeakSet,cc=function(t){let e={start:Math.floor(t/Fs(this,rc))*Fs(this,rc),data:new Uint8Array(Fs(this,rc)),written:[],shouldFlush:!1};return Fs(this,ac).push(e),Fs(this,ac).sort(((t,e)=>t.start-e.start)),Fs(this,ac).indexOf(e)},dc=new WeakSet,uc=function(t=!1){var e,r;for(let a=0;a<Fs(this,ac).length;a++){let n=Fs(this,ac)[a];if(n.shouldFlush||t){for(let t of n.written)null==(r=(e=Fs(this,ec).options).onData)||r.call(e,n.data.subarray(t.start,t.end),n.start+t.start);Fs(this,ac).splice(a--,1)}}};var hc,fc,gc,mc,wc,bc,vc,yc,xc,kc,$c,Cc,Ac,Ec,_c,Sc,Pc,Ic,Tc,Bc,Lc,Mc,Dc,zc,Fc,Oc,Nc,jc,Rc,Hc,Uc,Wc,qc,Gc,Yc,Vc,Qc=class extends pc{constructor(t){var e;super(new Vl({onData:(e,r)=>t.stream.write({type:"write",data:e,position:r}),chunkSize:null==(e=t.options)?void 0:e.chunkSize}))}},Jc=1e3,Xc=["avc","hevc","vp9","av1"],Zc=["aac","opus"],Kc=["strict","offset","cross-track-offset"],td=class{constructor(t){var e;if(Os(this,Ac),Os(this,_c),Os(this,Pc),Os(this,Tc),Os(this,Lc),Os(this,Dc),Os(this,Fc),Os(this,Nc),Os(this,Rc),Os(this,Uc),Os(this,qc),Os(this,Yc),Os(this,hc,void 0),Os(this,fc,void 0),Os(this,gc,void 0),Os(this,mc,void 0),Os(this,wc,null),Os(this,bc,null),Os(this,vc,Math.floor(Date.now()/1e3)+2082844800),Os(this,yc,[]),Os(this,xc,1),Os(this,kc,[]),Os(this,$c,[]),Os(this,Cc,!1),js(this,Ac,Ec).call(this,t),t.video=nl(t.video),t.audio=nl(t.audio),t.fastStart=nl(t.fastStart),this.target=t.target,Ns(this,hc,{firstTimestampBehavior:"strict",...t}),t.target instanceof Yl)Ns(this,fc,new Kl(t.target));else if(t.target instanceof Vl)Ns(this,fc,(null==(e=t.target.options)?void 0:e.chunked)?new pc(t.target):new tc(t.target));else{if(!(t.target instanceof Ql))throw new Error(`Invalid target: ${t.target}`);Ns(this,fc,new Qc(t.target))}js(this,Tc,Bc).call(this),js(this,_c,Sc).call(this)}addVideoChunk(t,e,r,a){let n=new Uint8Array(t.byteLength);t.copyTo(n),this.addVideoChunkRaw(n,t.type,r??t.timestamp,t.duration,e,a)}addVideoChunkRaw(t,e,r,a,n,o){if(js(this,Yc,Vc).call(this),!Fs(this,hc).video)throw new Error("No video track declared.");if("object"==typeof Fs(this,hc).fastStart&&Fs(this,wc).samples.length===Fs(this,hc).fastStart.expectedVideoChunks)throw new Error(`Cannot add more video chunks than specified in 'fastStart' (${Fs(this,hc).fastStart.expectedVideoChunks}).`);let i=js(this,Dc,zc).call(this,Fs(this,wc),t,e,r,a,n,o);if("fragmented"===Fs(this,hc).fastStart&&Fs(this,bc)){for(;Fs(this,$c).length>0&&Fs(this,$c)[0].decodeTimestamp<=i.decodeTimestamp;){let t=Fs(this,$c).shift();js(this,Fc,Oc).call(this,Fs(this,bc),t)}i.decodeTimestamp<=Fs(this,bc).lastDecodeTimestamp?js(this,Fc,Oc).call(this,Fs(this,wc),i):Fs(this,kc).push(i)}else js(this,Fc,Oc).call(this,Fs(this,wc),i)}addAudioChunk(t,e,r){let a=new Uint8Array(t.byteLength);t.copyTo(a),this.addAudioChunkRaw(a,t.type,r??t.timestamp,t.duration,e)}addAudioChunkRaw(t,e,r,a,n){if(js(this,Yc,Vc).call(this),!Fs(this,hc).audio)throw new Error("No audio track declared.");if("object"==typeof Fs(this,hc).fastStart&&Fs(this,bc).samples.length===Fs(this,hc).fastStart.expectedAudioChunks)throw new Error(`Cannot add more audio chunks than specified in 'fastStart' (${Fs(this,hc).fastStart.expectedAudioChunks}).`);let o=js(this,Dc,zc).call(this,Fs(this,bc),t,e,r,a,n);if("fragmented"===Fs(this,hc).fastStart&&Fs(this,wc)){for(;Fs(this,kc).length>0&&Fs(this,kc)[0].decodeTimestamp<=o.decodeTimestamp;){let t=Fs(this,kc).shift();js(this,Fc,Oc).call(this,Fs(this,wc),t)}o.decodeTimestamp<=Fs(this,wc).lastDecodeTimestamp?js(this,Fc,Oc).call(this,Fs(this,bc),o):Fs(this,$c).push(o)}else js(this,Fc,Oc).call(this,Fs(this,bc),o)}finalize(){if(Fs(this,Cc))throw new Error("Cannot finalize a muxer more than once.");if("fragmented"===Fs(this,hc).fastStart){for(let t of Fs(this,kc))js(this,Fc,Oc).call(this,Fs(this,wc),t);for(let t of Fs(this,$c))js(this,Fc,Oc).call(this,Fs(this,bc),t);js(this,Uc,Wc).call(this,!1)}else Fs(this,wc)&&js(this,Rc,Hc).call(this,Fs(this,wc)),Fs(this,bc)&&js(this,Rc,Hc).call(this,Fs(this,bc));let t=[Fs(this,wc),Fs(this,bc)].filter(Boolean);if("in-memory"===Fs(this,hc).fastStart){let e;for(let r=0;r<2;r++){let r=cl(t,Fs(this,vc)),a=Fs(this,fc).measureBox(r);e=Fs(this,fc).measureBox(Fs(this,mc));let n=Fs(this,fc).pos+a+e;for(let t of Fs(this,yc)){t.offset=n;for(let{data:r}of t.samples)n+=r.byteLength,e+=r.byteLength}if(n<2**32)break;e>=2**32&&(Fs(this,mc).largeSize=!0)}let r=cl(t,Fs(this,vc));Fs(this,fc).writeBox(r),Fs(this,mc).size=e,Fs(this,fc).writeBox(Fs(this,mc));for(let t of Fs(this,yc))for(let e of t.samples)Fs(this,fc).write(e.data),e.data=null}else if("fragmented"===Fs(this,hc).fastStart){let e=Fs(this,fc).pos,r=(t=>il("mfra",null,[...t.map(Rl),Hl()]))(t);Fs(this,fc).writeBox(r);let a=Fs(this,fc).pos-e;Fs(this,fc).seek(Fs(this,fc).pos-4),Fs(this,fc).writeU32(a)}else{let e=Fs(this,fc).offsets.get(Fs(this,mc)),r=Fs(this,fc).pos-e;Fs(this,mc).size=r,Fs(this,mc).largeSize=r>=2**32,Fs(this,fc).patchBox(Fs(this,mc));let a=cl(t,Fs(this,vc));if("object"==typeof Fs(this,hc).fastStart){Fs(this,fc).seek(Fs(this,gc)),Fs(this,fc).writeBox(a);let t=e-Fs(this,fc).pos;Fs(this,fc).writeBox({type:"free",size:t})}else Fs(this,fc).writeBox(a)}js(this,qc,Gc).call(this),Fs(this,fc).finalize(),Ns(this,Cc,!0)}};hc=new WeakMap,fc=new WeakMap,gc=new WeakMap,mc=new WeakMap,wc=new WeakMap,bc=new WeakMap,vc=new WeakMap,yc=new WeakMap,xc=new WeakMap,kc=new WeakMap,$c=new WeakMap,Cc=new WeakMap,Ac=new WeakSet,Ec=function(t){if(t.video){if(!Xc.includes(t.video.codec))throw new Error(`Unsupported video codec: ${t.video.codec}`);const e=t.video.rotation;if("number"==typeof e&&![0,90,180,270].includes(e))throw new Error(`Invalid video rotation: ${e}. Has to be 0, 90, 180 or 270.`);if(Array.isArray(e)&&(9!==e.length||e.some((t=>"number"!=typeof t))))throw new Error(`Invalid video transformation matrix: ${e.join()}`)}if(t.audio&&!Zc.includes(t.audio.codec))throw new Error(`Unsupported audio codec: ${t.audio.codec}`);if(t.firstTimestampBehavior&&!Kc.includes(t.firstTimestampBehavior))throw new Error(`Invalid first timestamp behavior: ${t.firstTimestampBehavior}`);if("object"==typeof t.fastStart){if(t.video&&void 0===t.fastStart.expectedVideoChunks)throw new Error("'fastStart' is an object but is missing property 'expectedVideoChunks'.");if(t.audio&&void 0===t.fastStart.expectedAudioChunks)throw new Error("'fastStart' is an object but is missing property 'expectedAudioChunks'.")}else if(![!1,"in-memory","fragmented"].includes(t.fastStart))throw new Error("'fastStart' option must be false, 'in-memory', 'fragmented' or an object.")},_c=new WeakSet,Sc=function(){var t,e;if(Fs(this,fc).writeBox((e={holdsAvc:"avc"===(null==(t=Fs(this,hc).video)?void 0:t.codec),fragmented:"fragmented"===Fs(this,hc).fastStart}).fragmented?il("ftyp",[Xs("iso5"),Gs(512),Xs("iso5"),Xs("iso6"),Xs("mp41")]):il("ftyp",[Xs("isom"),Gs(512),Xs("isom"),e.holdsAvc?Xs("avc1"):[],Xs("mp41")])),Ns(this,gc,Fs(this,fc).pos),"in-memory"===Fs(this,hc).fastStart)Ns(this,mc,ll(!1));else if("fragmented"===Fs(this,hc).fastStart);else{if("object"==typeof Fs(this,hc).fastStart){let t=js(this,Pc,Ic).call(this);Fs(this,fc).seek(Fs(this,fc).pos+t)}Ns(this,mc,ll(!0)),Fs(this,fc).writeBox(Fs(this,mc))}js(this,qc,Gc).call(this)},Pc=new WeakSet,Ic=function(){if("object"!=typeof Fs(this,hc).fastStart)return;let t=0,e=[Fs(this,hc).fastStart.expectedVideoChunks,Fs(this,hc).fastStart.expectedAudioChunks];for(let r of e)r&&(t+=8*Math.ceil(2/3*r),t+=4*r,t+=12*Math.ceil(2/3*r),t+=4*r,t+=8*r);return t+=4096,t},Tc=new WeakSet,Bc=function(){if(Fs(this,hc).video&&Ns(this,wc,{id:1,info:{type:"video",codec:Fs(this,hc).video.codec,width:Fs(this,hc).video.width,height:Fs(this,hc).video.height,rotation:Fs(this,hc).video.rotation??0,decoderConfig:null},timescale:11520,samples:[],finalizedChunks:[],currentChunk:null,firstDecodeTimestamp:void 0,lastDecodeTimestamp:-1,timeToSampleTable:[],compositionTimeOffsetTable:[],lastTimescaleUnits:null,lastSample:null,compactlyCodedChunkTable:[]}),Fs(this,hc).audio){let t=js(this,Lc,Mc).call(this,2,Fs(this,hc).audio.sampleRate,Fs(this,hc).audio.numberOfChannels);Ns(this,bc,{id:Fs(this,hc).video?2:1,info:{type:"audio",codec:Fs(this,hc).audio.codec,numberOfChannels:Fs(this,hc).audio.numberOfChannels,sampleRate:Fs(this,hc).audio.sampleRate,decoderConfig:{codec:Fs(this,hc).audio.codec,description:t,numberOfChannels:Fs(this,hc).audio.numberOfChannels,sampleRate:Fs(this,hc).audio.sampleRate}},timescale:Fs(this,hc).audio.sampleRate,samples:[],finalizedChunks:[],currentChunk:null,firstDecodeTimestamp:void 0,lastDecodeTimestamp:-1,timeToSampleTable:[],compositionTimeOffsetTable:[],lastTimescaleUnits:null,lastSample:null,compactlyCodedChunkTable:[]})}},Lc=new WeakSet,Mc=function(t,e,r){let a=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350].indexOf(e),n=r,o="";o+=t.toString(2).padStart(5,"0"),o+=a.toString(2).padStart(4,"0"),15===a&&(o+=e.toString(2).padStart(24,"0")),o+=n.toString(2).padStart(4,"0");let i=8*Math.ceil(o.length/8);o=o.padEnd(i,"0");let s=new Uint8Array(o.length/8);for(let t=0;t<o.length;t+=8)s[t/8]=parseInt(o.slice(t,t+8),2);return s},Dc=new WeakSet,zc=function(t,e,r,a,n,o,i){let s=a/1e6,l=(a-(i??0))/1e6,c=n/1e6,d=js(this,Nc,jc).call(this,s,l,t);return s=d.presentationTimestamp,l=d.decodeTimestamp,(null==o?void 0:o.decoderConfig)&&(null===t.info.decoderConfig?t.info.decoderConfig=o.decoderConfig:Object.assign(t.info.decoderConfig,o.decoderConfig)),{presentationTimestamp:s,decodeTimestamp:l,duration:c,data:e,size:e.byteLength,type:r,timescaleUnitsToNextSample:tl(c,t.timescale)}},Fc=new WeakSet,Oc=function(t,e){"fragmented"!==Fs(this,hc).fastStart&&t.samples.push(e);const r=tl(e.presentationTimestamp-e.decodeTimestamp,t.timescale);if(null!==t.lastTimescaleUnits){let a=tl(e.decodeTimestamp,t.timescale,!1),n=Math.round(a-t.lastTimescaleUnits);if(t.lastTimescaleUnits+=n,t.lastSample.timescaleUnitsToNextSample=n,"fragmented"!==Fs(this,hc).fastStart){let e=Zs(t.timeToSampleTable);1===e.sampleCount?(e.sampleDelta=n,e.sampleCount++):e.sampleDelta===n?e.sampleCount++:(e.sampleCount--,t.timeToSampleTable.push({sampleCount:2,sampleDelta:n}));const a=Zs(t.compositionTimeOffsetTable);a.sampleCompositionTimeOffset===r?a.sampleCount++:t.compositionTimeOffsetTable.push({sampleCount:1,sampleCompositionTimeOffset:r})}}else t.lastTimescaleUnits=0,"fragmented"!==Fs(this,hc).fastStart&&(t.timeToSampleTable.push({sampleCount:1,sampleDelta:tl(e.duration,t.timescale)}),t.compositionTimeOffsetTable.push({sampleCount:1,sampleCompositionTimeOffset:r}));t.lastSample=e;let a=!1;if(t.currentChunk){let r=e.presentationTimestamp-t.currentChunk.startTimestamp;if("fragmented"===Fs(this,hc).fastStart){t===(Fs(this,wc)??Fs(this,bc))&&"key"===e.type&&r>=1&&(a=!0,js(this,Uc,Wc).call(this))}else a=r>=.5}else a=!0;a&&(t.currentChunk&&js(this,Rc,Hc).call(this,t),t.currentChunk={startTimestamp:e.presentationTimestamp,samples:[]}),t.currentChunk.samples.push(e)},Nc=new WeakSet,jc=function(t,e,r){var a,n;const o="strict"===Fs(this,hc).firstTimestampBehavior,i=-1===r.lastDecodeTimestamp;if(o&&i&&0!==e)throw new Error(`The first chunk for your media track must have a timestamp of 0 (received DTS=${e}).Non-zero first timestamps are often caused by directly piping frames or audio data from a MediaStreamTrack into the encoder. Their timestamps are typically relative to the age of thedocument, which is probably what you want.\n\nIf you want to offset all timestamps of a track such that the first one is zero, set firstTimestampBehavior: 'offset' in the options.\n`);if("offset"===Fs(this,hc).firstTimestampBehavior||"cross-track-offset"===Fs(this,hc).firstTimestampBehavior){let o;void 0===r.firstDecodeTimestamp&&(r.firstDecodeTimestamp=e),o="offset"===Fs(this,hc).firstTimestampBehavior?r.firstDecodeTimestamp:Math.min((null==(a=Fs(this,wc))?void 0:a.firstDecodeTimestamp)??1/0,(null==(n=Fs(this,bc))?void 0:n.firstDecodeTimestamp)??1/0),e-=o,t-=o}if(e<r.lastDecodeTimestamp)throw new Error(`Timestamps must be monotonically increasing (DTS went from ${1e6*r.lastDecodeTimestamp} to ${1e6*e}).`);return r.lastDecodeTimestamp=e,{presentationTimestamp:t,decodeTimestamp:e}},Rc=new WeakSet,Hc=function(t){if("fragmented"===Fs(this,hc).fastStart)throw new Error("Can't finalize individual chunks 'fastStart' is set to 'fragmented'.");if(t.currentChunk)if(t.finalizedChunks.push(t.currentChunk),Fs(this,yc).push(t.currentChunk),0!==t.compactlyCodedChunkTable.length&&Zs(t.compactlyCodedChunkTable).samplesPerChunk===t.currentChunk.samples.length||t.compactlyCodedChunkTable.push({firstChunk:t.finalizedChunks.length,samplesPerChunk:t.currentChunk.samples.length}),"in-memory"!==Fs(this,hc).fastStart){t.currentChunk.offset=Fs(this,fc).pos;for(let e of t.currentChunk.samples)Fs(this,fc).write(e.data),e.data=null;js(this,qc,Gc).call(this)}else t.currentChunk.offset=0},Uc=new WeakSet,Wc=function(t=!0){if("fragmented"!==Fs(this,hc).fastStart)throw new Error("Can't finalize a fragment unless 'fastStart' is set to 'fragmented'.");let e=[Fs(this,wc),Fs(this,bc)].filter((t=>t&&t.currentChunk));if(0===e.length)return;let r=(a=this,n=xc,{set _(t){Ns(a,n,t)},get _(){return Fs(a,n,o)}})._++;var a,n,o;if(1===r){let t=cl(e,Fs(this,vc),!0);Fs(this,fc).writeBox(t)}let i=Fs(this,fc).pos,s=Ml(r,e);Fs(this,fc).writeBox(s);{let t=ll(!1),r=0;for(let t of e)for(let e of t.currentChunk.samples)r+=e.size;let a=Fs(this,fc).measureBox(t)+r;a>=2**32&&(t.largeSize=!0,a=Fs(this,fc).measureBox(t)+r),t.size=a,Fs(this,fc).writeBox(t)}for(let t of e){t.currentChunk.offset=Fs(this,fc).pos,t.currentChunk.moofOffset=i;for(let e of t.currentChunk.samples)Fs(this,fc).write(e.data),e.data=null}let l=Fs(this,fc).pos;Fs(this,fc).seek(Fs(this,fc).offsets.get(s));let c=Ml(r,e);Fs(this,fc).writeBox(c),Fs(this,fc).seek(l);for(let t of e)t.finalizedChunks.push(t.currentChunk),Fs(this,yc).push(t.currentChunk),t.currentChunk=null;t&&js(this,qc,Gc).call(this)},qc=new WeakSet,Gc=function(){Fs(this,fc)instanceof tc&&Fs(this,fc).flush()},Yc=new WeakSet,Vc=function(){if(Fs(this,Cc))throw new Error("Cannot add new video or audio chunks after the file has been finalized.")};const ed={gif:function(t,e){return Promise.all(t.map((t=>t instanceof Blob?createImageBitmap(t):t))).then((t=>new Promise(((r,n)=>{u.info("Start convert:",e.id),u.time(e.id);const o=document.createElement("canvas"),i=o.width=t[0].width,s=o.height=t[0].height,l=o.getContext("2d",{willReadFrequently:!0}),c=new a({workers:2,quality:_.get("gifQuality"),width:i,height:s,workerScript:us});e.abort=()=>{c.abort()},t.forEach(((t,r)=>{l.drawImage(t,0,0),c.addFrame(l,{copy:!0,delay:e.source.delays[r]}),t.close()})),c.on("progress",(t=>{var r;null==(r=e.onProgress)||r.call(e,100*t)})),c.on("finished",(t=>{u.timeEnd(e.id),r(t)})),c.on("abort",(()=>{u.timeEnd(e.id),u.warn("Convert stop manually. "+e.id),e.isAborted=!0,n(new v)})),c.render()}))))},png:function(t,e){return new Promise(((r,a)=>{let n;u.info("Start convert:",e.id),u.time(e.id),gs.length?(n=gs.shift(),u.info("Reuse apng workers.")):n=new Worker(fs),e.abort=()=>{u.timeEnd(e.id),u.warn("Convert stop manually. "+e.id),a(new v),e.isAborted=!0,n.terminate()},n.onmessage=function(t){if(gs.push(n),u.timeEnd(e.id),!t.data)return a(new TypeError("Failed to get png data. "+e.id));const o=new Blob([t.data],{type:"image/png"});r(o)};const o=e.source.delays,i={frames:t,delays:o,cnum:_.get("pngColor")};n.postMessage(i,i.frames[0]instanceof ImageBitmap?i.frames:[])}))},webp:function(t,e){return new Promise(((t,r)=>{let a;u.time(e.id),vs.length?(u.info("Reuse webp workers."),a=vs.shift(),t(a)):(a=new Worker(bs),a.onmessage=e=>{"ok"===e.data?(u.info("Webp worker loaded."),t(a)):r(e.data)})})).then((r=>{if(e.isAborted)throw vs.push(r),u.timeEnd(e.id),u.warn("Convert stop manually."+e.id),new v;return new Promise(((a,n)=>{r.onmessage=t=>{var o;if(e.isAborted)r.terminate(),u.timeEnd(e.id),u.warn("Convert stop manually."+e.id),n(new v);else{"object"!=typeof t.data?null==(o=e.onProgress)||o.call(e,t.data):(u.timeEnd(e.id),vs.push(r),a(new Blob([t.data],{type:"image/webp"})))}};const o=e.source.delays;r.postMessage({frames:t,delays:o,lossless:Number(_.get("losslessWebp")),quality:_.get("webpQuality"),method:_.get("webpMehtod")},t[0]instanceof ImageBitmap?t:[])}))}))},webm:function(t,e){const r=_.get("webmQuality")/100;return Promise.all(t.map((t=>t instanceof Blob?createImageBitmap(t):t))).then((a=>{if(e.isAborted)throw new v;const n=a[0].width,o=a[0].height,i=new OffscreenCanvas(n,o),s=i.getContext("2d"),l=[];for(let e=0;e<t.length;e++){s.drawImage(a[e],0,0),a[e].close();const t=i.convertToBlob({type:"image/webp",quality:r}).then(f);l.push(t)}return Promise.all(l)})).then((t=>{if(e.isAborted)throw new v;const a=new _s({quality:r,frameRate:30,transparent:!1}),n=e.source.delays;for(let e=0;e<t.length;e++)a.addFrame(t[e],n[e]);return a.complete()})).then((t=>{if(e.isAborted)throw new v;return t}))},mp4:async function(t,e){const r=t.map((t=>t instanceof Blob?createImageBitmap(t):t)),a=await Promise.all(r);if(e.isAborted)throw new v;let n=a[0].width,o=a[0].height;n%2!=0&&(n+=1),o%2!=0&&(o+=1);const i=new td({target:new Yl,video:{codec:"avc",width:n,height:o},fastStart:"in-memory"}),s=new VideoEncoder({output:(t,e)=>i.addVideoChunk(t,e),error:t=>u.error(t)});s.configure({codec:"avc1.420034",width:n,height:o,bitrate:1e6*_.get("mp4Bitrate")});const l=e.source.delays.map((t=>1e3*t));let c=0;const d=[];for(let t=0;t<a.length;t++){const e=new VideoFrame(a[t],{duration:l[t],timestamp:c});d.push(e),a[t].close(),s.encode(e),c+=l[t]}if(await s.flush(),e.isAborted)throw d.forEach((t=>t.close())),new v;i.finalize();const{buffer:p}=i.target;return d.forEach((t=>t.close())),new Blob([p],{type:"video/mp4"})}},rd={getAdapter:t=>ed[t],getMixEffectFn:()=>ms};const ad=function(){const t={};let e=!1,r=[],a=[];const n=e=>{var o;const{id:i,format:s,resolve:l,reject:c}=e;a.push(e),null==(o=e.onProgress)||o.call(e,0);const d=rd.getAdapter(s);if(u=e,Array.isArray(u.source.data)&&u.source.data[0]instanceof Blob)delete t[i],d(e.source.data,e).then(l,c).finally((()=>{a.splice(a.indexOf(e),1),r.length&&n(r.shift())}));else{rd.getMixEffectFn()(e).then((({bitmaps:t,frames:r,delays:a,width:n,height:o})=>{const s={...e,source:{id:i,data:t,delays:a}};return Promise.all([d(s.source.data,s),r,a,n,o])})).then((([t,e,r,a,n])=>{l({blob:t,frames:e,delays:r,width:a,height:n})}),c).finally((()=>{a.splice(a.indexOf(e),1),r.length&&n(r.shift())}))}var u};return{del:o=>{if("string"==typeof o&&(o=[o]),o.length)for((u.info("Converter del, active:",a.map((t=>t.id)),"queue:",r.map((t=>t.id))),e=!0,o.forEach((e=>{e in t&&delete t[e]})),a=a.filter((t=>{if(!o.includes(t.id))return!0;t.abort()})),r=r.filter((t=>!o.includes(t.id))),e=!1);a.length<2&&r.length;)n(r.shift())},addFrame(e,r,a,n){if(e in t||(t[e]={id:e,data:[],delays:[]}),void 0===n){const n=t[e].data.length;t[e].data[n]=r,t[e].delays[n]=a}else t[e].data[n]=r,t[e].delays[n]=a},framesCount:e=>e in t?t[e].delays.filter((t=>void 0!==t)).length:0,convert:(o,i,s)=>new Promise(((l,c)=>{const d={id:o,format:i,source:t[o],isAborted:!1,onProgress:s,resolve:l,reject:c,abort(){this.isAborted=!0}};for(u.info("Converter add",o),r.push(d);a.length<2&&r.length&&!e;)n(r.shift())})),appendPixivEffect:async(t,o,i,s,l)=>new Promise(((c,d)=>{const p={id:t,format:o,source:{id:t,illust:i,data:s},isAborted:!1,onProgress:l,resolve:c,reject:d,abort(){this.isAborted=!0}};for(u.info("Converter add",t),r.push(p);a.length<2&&r.length&&!e;)n(r.shift())}))}}(),nd={download:{singleArtworkProgressFactory(t,e){if(t&&e)return function(r){1===e&&t.setProgress(r)}},mulityArtworksProgressFactory(t,e){if(!t||!e)return;let r=0;return function(){if(e<2)return;const a=Math.floor(++r/e*100);t.setProgress(a)}}},bundle:{async beforeFileSave(t,e){const{taskId:r,source:a}=e;if(cs.add(r,a.filename,t),cs.fileCount(r)===a.pageCount){let t;if("ugoiraMeta"in e.source){const r=e.source.ugoiraMeta.frames.map((t=>t.delay));t=JSON.stringify(r)}const a=await cs.bundle(r,t);return cs.remove(r),a}},onError(t,e){cs.remove(e.taskId)},onAbort(t){cs.remove(t.taskId)}},convert:{convertProgressFactory:t=>function(e){e>0?t.setProgress(e,!1):t.setStatus(N.Loading)},beforeFileSaveFactory(t){const e=t?this.convertProgressFactory(t):void 0;return async function(t,r){const{taskId:a,source:n}=r;if(n.illustType===ns.ugoira&&(ad.addFrame(a,t,n.ugoiraMeta.frames[n.order].delay,n.order),ad.framesCount(a)===n.pageCount))return await ad.convert(a,n.extendName,e)}},mixGlowEffect(t){const e=t?this.convertProgressFactory(t):void 0;return async function(t,r){const a="pixivGlow2024",{taskId:n}=r,o=await M.getImageEffect(a);if(o&&o.data[0]instanceof ArrayBuffer){const{data:a,delays:i,width:s,height:l}=o,{blob:c}=await ad.appendPixivEffect(n,r.source.extendName,t,{frames:a,delays:i,width:s,height:l},e);return c}{const o=await new Promise(((t,e)=>{c({url:"https://source.pixiv.net/special/seasonal-effect-tag/pixiv-glow-2024/effect.png",headers:{referer:"https://www.pixiv.net"},responseType:"blob",onload(e){t(e.response)},onerror:e,ontimeout:()=>e(new Error("Timeout"))})})),{blob:i,frames:s,delays:l,width:d,height:u}=await ad.appendPixivEffect(n,r.source.extendName,t,o,e);return M.addImageEffect({id:a,data:s,delays:l,width:d,height:u}),i}}},onError(t,e){ad.del(e.taskId)},onAbort(t){ad.del(t.taskId)}}},od={getHooks(t,e,r){switch(e){case"download":return{onProgress:nd.download.singleArtworkProgressFactory(r,t.pageCount),onFileSaved:nd.download.mulityArtworksProgressFactory(r,t.pageCount)};case"bundle":return{onXhrLoaded:nd.download.mulityArtworksProgressFactory(r,t.pageCount),beforeFileSave:nd.bundle.beforeFileSave,onError:nd.bundle.onError};case"convert":return{onXhrLoaded:nd.download.mulityArtworksProgressFactory(r,t.pageCount),beforeFileSave:nd.convert.beforeFileSaveFactory(r),onError:nd.convert.onError};case"mixEffect":return{onProgress:nd.download.singleArtworkProgressFactory(r,t.pageCount),beforeFileSave:nd.convert.mixGlowEffect(r),onError:nd.convert.onError}}}};class id extends H{constructor(t){super(t),o(this,"downloadAll",!0),o(this,"headers",{referer:"https://www.pixiv.net"}),o(this,"timeout",6e4),o(this,"getImgSrc",(()=>"")),this.meta=t,this.getImgSrc=this.meta.illustType===ns.ugoira?t=>this.meta.src.replace("ugoira0","ugoira"+t):t=>this.meta.src.replace("_p0","_p"+t)}getConvertFormat(){return _.get("ugoiraFormat")}getMixEffectFormat(){const t=this.getConvertFormat();return"zip"===t?$.WEBM:t}needConvert(){return this.meta.illustType===ns.ugoira&&"zip"!==_.get("ugoiraFormat")}needBundle(){const{pageCount:t,illustType:e}=this.meta;return this.downloadAll&&(e===ns.ugoira&&"zip"===this.getConvertFormat()||t>1&&(e===ns.manga&&_.get("bundleManga")||e===ns.illusts&&_.get("bundleIllusts")))}useTranslatedTags(){return"ja"!==_.get("tagLang")}supportSubpath(){return this.isBrowserApi()||this.isFsaEnable()}buildPattern(t,r){const{id:a,userId:n,artist:o,title:i,tags:s,tagsTranslated:l,createDate:c,pageCount:d}=this.meta,u=void 0===r?d:r,p=this.useTranslatedTags()?l:s,h=this.normalizeString(o)||n,f=this.normalizeString(i)||a,g=this.normalizeString(p.join("_"));return t.replaceAll(/\{date\((.*?)\)\}|\{date\}/g,((t,r)=>{const a=r||"YYYY-MM-DD";return e(c).format(a)})).replaceAll("{artist}",h).replaceAll("{artistID}",n).replaceAll("{title}",f).replaceAll("{tags}",g).replaceAll("{page}",String(u)).replaceAll("{id}",a)}getDownloadConfig(t){const{illustType:e,src:r,pageCount:a,extendName:n}=this.meta,o=null==t?void 0:t.dataset.page,i=o?Number(o):void 0;if(i&&(i>a-1||i<0))throw new Error("Invalid downloadPage.");void 0!==i&&(this.downloadAll=!1);const s=this.generateTaskId(),l=this.headers,c=this.supportSubpath(),d=[];if(1!==a&&void 0===i||e===ns.ugoira){const r=c?this.getFullpathPattern().slice(0,-4):this.getFilenamePattern();if(this.needBundle()){const o=r+".zip",i=this.getFilenamePattern().includes("{page}")?this.getFilenamePattern()+"."+n:this.getFilenamePattern()+"_{page}."+n;let c,u;e===ns.ugoira?(c=this.buildPattern(o,0),u=this.meta.ugoiraMeta.frames.length):(c=this.buildPattern(o),u=a);const p=od.getHooks({...this.meta,pageCount:u},"bundle",t);for(let t=0;t<u;t++){const e=this.buildPattern(i,t),r={taskId:s,src:this.getImgSrc(t),path:c,source:{...this.meta,pageCount:u,extendName:"zip",filename:e,order:t},headers:l,timeout:this.timeout,...p};d.push(r)}}else if(this.needConvert()){const e=this.getConvertFormat(),a=r+"."+e,n=this.buildPattern(a,0),o=n.slice(n.lastIndexOf("/")+1),i=this.meta.ugoiraMeta.frames.length,c=od.getHooks({...this.meta,pageCount:i},"convert",t);for(let t=0;t<i;t++){const r={taskId:s,src:this.getImgSrc(t),path:n,source:{...this.meta,pageCount:i,extendName:e,filename:o,order:t},headers:l,timeout:this.timeout,...c};d.push(r)}}else{const e=r+"."+n,o=od.getHooks(this.meta,"download",t);for(let t=0;t<a;t++){const r=this.buildPattern(e,t),a=r.slice(r.lastIndexOf("/")+1),n={taskId:s,src:this.getImgSrc(t),path:r,source:{...this.meta,filename:a,order:t},headers:l,timeout:this.timeout,...o};d.push(n)}}}else{const e=i?this.getImgSrc(i):r;let a,o,u;if(_.get("mixEffect")&&t){const e=this.getMixEffectFormat(),r=(c?this.getFullpathPattern().slice(0,-4):this.getFilenamePattern())+"."+e;a=this.buildPattern(r,i||0);const n=a.slice(a.lastIndexOf("/")+1);o=od.getHooks({...this.meta,pageCount:1},"mixEffect",t),u={...this.meta,pageCount:1,extendName:e,filename:n,order:i??0}}else{const e=c?this.getFullpathPattern():this.getFilenamePattern()+"."+n;a=this.buildPattern(e,i||0);const r=a.slice(a.lastIndexOf("/")+1);o=od.getHooks({...this.meta,pageCount:1},"download",t),u={...this.meta,pageCount:1,filename:r,order:i??0}}const p={taskId:s,src:e,path:a,source:u,headers:l,timeout:this.timeout,...o};d.push(p)}return!this.downloadAll&&(this.downloadAll=!0),d}}function sd(){var t,e;return(null==(e=null==(t=d.dataLayer)?void 0:t[0])?void 0:e.user_id)??""}async function ld(t,e,r){const{btn:a,tags:n,restrict:o}=r??{};try{if(await is.addBookmark(t,e,n,o),!a)return;const r=function(t){var e,r,a,n,o;const i={};if(t.dataset.type){if(t.dataset.type!==j.PixivToolbar)return u.warn(new Error("Can not find bookmark button."));{const e=null==(o=null==(n=t.parentElement)?void 0:n.parentElement)?void 0:o.querySelector("button.gtm-main-bookmark");e&&(i.kind="main",i.button=e)}}else{const n=null==(r=null==(e=t.parentElement)?void 0:e.nextElementSibling)?void 0:r.querySelector('button[type="button"]');if(n)i.kind="sub",i.button=n;else{const e=null==(a=t.parentElement)?void 0:a.querySelector("div._one-click-bookmark");e&&(i.kind="rank",i.button=e)}}return i}(a);if(!r)return;switch(r.kind){case"main":{const t=r.button.querySelector("svg g path");t&&(t.style.color="rgb(255, 64, 96)");break}case"sub":{const t=r.button.querySelector("path");t&&(t.style.color="rgb(255, 64, 96)");break}case"rank":r.button.style.backgroundColor="rgb(255, 64, 96)"}}catch(t){u.error(t)}}async function cd(t,e){var r,a,n;if(await is.likeIllust(t,e),!function(t){return location.pathname.includes(`/artworks/${t}`)}(t))return;const o=null==(n=null==(a=null==(r=document.querySelector(`${R.tagNameLowerCase}[data-type="pixiv-toolbar"]`))?void 0:r.parentElement)?void 0:a.previousElementSibling)?void 0:n.firstElementChild;o&&(o.disabled=!0,o.style.color="#0096fa",o.style.cursor="default")}async function dd(t){T.dirHandleCheck();const{id:e,page:r,unlistedId:a}=t.dataset,n=_.get("tagLang");let o;if(a)o=await ls.parse(a,{tagLang:n,type:"unlisted"});else{const r=_.get("addBookmark"),a=_.get("likeIllust");if(r||a){o=await ls.parse(e,{tagLang:n,type:"html"});const{bookmarkData:i,token:s,tags:l,likeData:c}=o;if(!i&&r){ld(e,s,{btn:t,tags:_.get("addBookmarkWithTags")?l:void 0,restrict:_.get("privateR18")&&l.includes("R-18")?os.private:os.public})}!c&&a&&cd(e,s)}else o=await ls.parse(e,{tagLang:n,type:"api"})}const i=new id(o).getDownloadConfig(t);await T.download(i);const{comment:s,tags:l,artist:c,userId:d,title:u}=o,p={pid:Number(e),user:c,userId:Number(d),title:u,comment:s,tags:l};void 0!==r&&(p.page=Number(r)),a&&(p.unlistedId=a),M.add(p)}function ud(t){let e=!1;const r=ss.bookmarkPage.exec(location.pathname);r&&r[1]===sd()&&(e=!0),t.forEach((t=>{let r,a;if((0!==t.childElementCount||t.className.includes("_history-item")||t.className.includes("_history-related-item"))&&!t.querySelector(R.tagNameLowerCase)&&(r=function(t){const e=ss.artworksPage.exec(t.getAttribute("href")||"");if(e){if(t.getAttribute("data-gtm-value")||["gtm-illust-recommend-node-node","gtm-discover-user-recommend-node","work","_history-item","_history-related-item"].some((e=>t.classList.contains(e))))return e[1]}else if(t instanceof HTMLSpanElement&&t.className.includes("_history-item")){const e=t.querySelector("img");if(!e)return"";const r=ss.historyThumbnailsId.exec(e.src);if(r)return r[0]}else{const e=ss.activityHref.exec(t.getAttribute("href")||"");if(e&&t.classList.contains("work"))return e[1]}return""}(t))){e?a=j.PixivMyBookmark:t.className.includes("_history-related-item")?(t.style.position="relative",a=j.PixivHistory):t.className.includes("_history-item")&&(a=j.PixivHistory);const n=new R({id:r,type:a,onClick:dd});t.appendChild(n)}}))}function pd(t,e){const r=document.querySelectorAll("figure a.gtm-expand-full-size-illust");r.length<2||r.forEach(((r,a)=>{var n;const o=null==(n=r.parentElement)?void 0:n.parentElement;o&&!o.querySelector(Qi.tagNameLowerCase)&&o.appendChild(new Qi({id:t,page:a,extraData:e?{unlistedId:e}:void 0,onClick:dd}))}))}let hd,fd;function gd(t,e){const r=document.querySelector("body > [role='presentation'] > div");if(!r)return void(hd&&(hd.disconnect(),hd=null,fd=null));if(r.querySelector(R.tagNameLowerCase))return;const a=r.querySelector("div > img");if(!a)return;const n=ss.originSrcPageNum.exec(a.src);if(!n)return;const[o]=n;fd=new R({id:t,type:j.PixivPresentation,page:Number(o),extraData:e?{unlistedId:e}:void 0,onClick:dd}),r.appendChild(fd),hd=new MutationObserver((a=>{const n=a[1].addedNodes[0],[o]=ss.originSrcPageNum.exec(n.src)??[];if(!o)return u.throw("Invalid image element.");null==fd||fd.remove(),fd=new R({id:t,type:j.PixivPresentation,page:Number(o),extraData:e?{unlistedId:e}:void 0,onClick:dd}),r.appendChild(fd)})),hd.observe(a.parentElement,{childList:!0,subtree:!0})}function md(t,e){var r;const a=document.querySelector(".gtm-manga-viewer-preview-modal-open:not(.pdl-listened)"),n=document.querySelector(".gtm-manga-viewer-open-preview:not(.pdl-listened)"),o=null==(r=document.querySelectorAll(".gtm-manga-viewer-close-icon:not(.pdl-listened)"))?void 0:r[1];(a||n||o)&&[a,n,o].forEach((r=>{r&&(r.classList.add("pdl-listened"),r.addEventListener("click",(()=>{!function(t,e){const r=setInterval((()=>{u.info("Start to find modal.");const a=document.querySelectorAll("ul"),n=a[a.length-1];"grid"===getComputedStyle(n).display&&(clearInterval(r),n.childNodes.forEach(((r,a)=>{r.style.position="relative",r.appendChild(new R({id:t,page:a,extraData:e?{unlistedId:e}:void 0,onClick:dd}))})))}),300)}(t,e)})))}))}function wd(t,e){const r=document.querySelector(".gtm-manga-viewer-close-icon");if(!r)return;const a=r.parentElement;a&&!a.querySelector(R.tagNameLowerCase)&&a.appendChild(new R({id:t,type:j.PixivMangaViewer,extraData:e?{unlistedId:e}:void 0,onClick:dd}))}class bd extends HTMLElement{constructor(t){super(),o(this,"props"),this.props=t}static get tagNameLowerCase(){return"pdl-unlisted-artwork-toolbar"}render(){if(this.shadowRoot)return;const t=this.attachShadow({mode:"open"});t.innerHTML='<style>.button-wrapper{display:flex;justify-content:flex-end;align-items:center;height:32px;padding:8px 12px}</style><div class="button-wrapper"></div>';const e=new R({...this.props,type:j.PixivToolbar});t.querySelector(".button-wrapper").appendChild(e)}connectedCallback(){this.render()}}customElements.define(bd.tagNameLowerCase,bd);class vd extends HTMLElement{constructor(t,e,r){super(),o(this,"btn"),o(this,"unsubscriber"),this.tagUrl=t,this.downloading=e,this.handleDownload=r,this.dispatchDownload=this.dispatchDownload.bind(this)}static get tagNameLowerCase(){return"pdl-tag-list-button"}async render(){if(this.shadowRoot)return;const t=this.attachShadow({mode:"open"});g(t),t.innerHTML=` \n  <div class=" flex items-center">    \n    <hr class="!border-t-0 border-l h-6 ml-4 mr-2" />\n    <button class=" h-[38px] w-[38px] btn-icon [&:not([disabled])]:hover:bg-slate-400/30 disabled:cursor-wait disabled:opacity-70">\n      <i class="text-sm w-6 fill-current mx-2">\n      ${oi}\n      </i>\n    </button>\n  </div>\n  `}getTagProps(){const t=new URL(this.tagUrl),{searchParams:e,pathname:r}=t,a=ss.userPageTags.exec(r);if(!a)throw new Error(`Could not extract tag props from: ${r}`);const[,n,o,i]=a;if(!i)throw new Error(`Could not extract tag from: ${r}`);let s;return s="illustrations"===o||"artworks"===o?"illusts":o,{userId:n,category:s,tag:i,rest:"hide"===e.get("rest")?"hide":"show"}}dispatchDownload(t){null==t||t.preventDefault(),this.handleDownload(this.getTagProps()).catch(u.error)}connectedCallback(){this.render(),this.btn??(this.btn=this.shadowRoot.querySelector("button")),this.btn.addEventListener("click",this.dispatchDownload),this.unsubscriber=this.downloading.subscribe((t=>{t?this.setAttribute("disabled",""):this.removeAttribute("disabled")}))}disconnectedCallback(){var t,e;null==(t=this.unsubscriber)||t.call(this),null==(e=this.btn)||e.removeEventListener("click",this.dispatchDownload)}static get observedAttributes(){return["disabled"]}attributeChangedCallback(t,e,r){var a,n;"string"==typeof r?null==(a=this.btn)||a.setAttribute("disabled",""):null==(n=this.btn)||n.removeAttribute("disabled")}}customElements.define(vd.tagNameLowerCase,vd);class yd extends HTMLElement{constructor(t,e,r){super(),o(this,"btn"),o(this,"ob"),o(this,"unsubscriber"),this.tagElement=t,this.downloading=e,this.handleDownload=r,this.dispatchDownload=this.dispatchDownload.bind(this),this.ob=new MutationObserver((()=>{this.changeBtnColor()}))}static get tagNameLowerCase(){return"pdl-artwork-tag"}resetTagStyle(){this.tagElement.style.borderTopRightRadius="0px",this.tagElement.style.borderBottomRightRadius="0px"}changeBtnColor(){if(!this.btn)return;const{color:t,backgroundColor:e}=getComputedStyle(this.tagElement);this.btn.style.color=t,this.btn.style.backgroundColor=e}async render(){if(this.shadowRoot)return;const t=this.attachShadow({mode:"open"});g(t),t.innerHTML=`  <button class="flex h-full items-center pr-2 rounded-e-[4px] disabled:cursor-wait disabled:opacity-70">\n    <hr class="!border-t-0 border-l h-6 pr-2" />\n    <i class="text-sm w-6 fill-current">\n      ${oi}\n    </i>\n  </button>`,this.resetTagStyle()}getTagProps(){const t=this.tagElement.querySelectorAll("div[title]"),e=t[t.length-1].getAttribute("title"),r=e.startsWith("#")?e.slice(1):"未分類",a=new URL(this.tagElement.href),{searchParams:n,pathname:o}=a,i=ss.userPageTags.exec(o);if(!i)throw new Error(`Could not extract tag props from: ${o}`);const[,s,l]=i;let c;return c="illustrations"===l||"artworks"===l?"illusts":l,{userId:s,category:c,tag:r,rest:"hide"===n.get("rest")?"hide":"show"}}dispatchDownload(){this.handleDownload(this.getTagProps()).catch(u.error)}connectedCallback(){this.render(),this.btn??(this.btn=this.shadowRoot.querySelector("button")),this.changeBtnColor(),this.btn.addEventListener("click",this.dispatchDownload),this.unsubscriber=this.downloading.subscribe((t=>{t?this.setAttribute("disabled",""):this.removeAttribute("disabled")})),this.ob.observe(this.tagElement,{attributes:!0,attributeFilter:["class"]})}disconnectedCallback(){var t,e;null==(t=this.unsubscriber)||t.call(this),null==(e=this.btn)||e.removeEventListener("click",this.dispatchDownload),this.ob.disconnect()}static get observedAttributes(){return["disabled"]}attributeChangedCallback(t,e,r){var a,n;"string"==typeof r?null==(a=this.btn)||a.setAttribute("disabled",""):null==(n=this.btn)||n.removeAttribute("disabled")}}customElements.define(yd.tagNameLowerCase,yd);class xd extends Vi{constructor(){super(...arguments),o(this,"firstObserverCbRunFlag",!0),o(this,"useBatchDownload",this.app.initBatchDownloader({metaType:{},async avatar(t){let e,r;if(e=(r=ss.series.exec(t))?r[1]:(r=ss.userPage.exec(t))?r[1]||r[2]:sd()??"",!e)return"";try{return(await is.getUserData(e)).imageBig}catch(t){return u.error(t),""}},filterOption:{filters:[{id:"exclude_downloaded",type:"exclude",name:J("downloader.category.filter.exclude_downloaded"),checked:!1,fn:t=>!!t.id&&M.has(t.id)},{id:"illust",type:"include",name:J("downloader.category.filter.pixiv_illust"),checked:!0,fn:t=>t.illustType===ns.illusts},{id:"manga",type:"include",name:J("downloader.category.filter.pixiv_manga"),checked:!0,fn:t=>t.illustType===ns.manga},{id:"ugoira",type:"include",name:J("downloader.category.filter.pixiv_ugoira"),checked:!0,fn:t=>t.illustType===ns.ugoira}],enableTagFilter:!0},pageOption:{self_bookmark_public:{name:J("downloader.download_type.pixiv_bookmark_public"),match(t){const e=ss.userPage.exec(t);if(!e)return!1;return(e[1]||e[2])===sd()},filterInGenerator:!0,fn:(t,e)=>ls.bookmarkGenerator(t,e,sd())},self_bookmark_private:{name:J("downloader.download_type.pixiv_bookmark_private"),match(t){const e=ss.userPage.exec(t);if(!e)return!1;return(e[1]||e[2])===sd()},filterInGenerator:!0,fn:(t,e)=>ls.bookmarkGenerator(t,e,sd(),"hide")},user_page_works:{name:J("downloader.download_type.pixiv_works"),match:ss.userPage,filterInGenerator:!0,fn:(t,e)=>{const r=ss.userPage.exec(location.href),a=r[1]||r[2];return ls.illustMangaGenerator(t,e,a)}},user_page_bookmark:{name:J("downloader.download_type.pixiv_bookmark"),match:ss.userPage,filterInGenerator:!0,fn:(t,e)=>{const r=ss.userPage.exec(location.href),a=r[1]||r[2];return ls.bookmarkGenerator(t,e,a)}},follow_latest_all:{name:J("downloader.download_type.pixiv_follow_latest_all"),match:ss.followLatest,filterInGenerator:!0,fn:(t,e)=>ls.followLatestGenerator(t,e,"all")},follow_latest_r18:{name:J("downloader.download_type.pixiv_follow_latest_r18"),match:ss.followLatest,filterInGenerator:!0,fn:(t,e)=>ls.followLatestGenerator(t,e,"r18")},series:{name:J("downloader.download_type.pixiv_series"),match:ss.series,filterInGenerator:!0,fn:(t,e)=>{const r=ss.series.exec(location.pathname);return ls.seriesGenerator(t,e,r[2])}},tagged_artwork:{name:"tagged_artwork",match:()=>!1,filterInGenerator:!0,fn:(t,e,r,a,n,o="show")=>"bookmarks"===a?ls.taggedArtworkGenerator(t,e,r,a,n,o):ls.taggedArtworkGenerator(t,e,r,a,n)}},parseMetaByArtworkId:t=>ls.parse(t,{tagLang:this.config.get("tagLang"),type:"api"}),async downloadByArtworkId(t,e){T.dirHandleCheck();const r=new id(t).getDownloadConfig();r.forEach((t=>{t.taskId=e})),await T.download(r);const{comment:a,id:n,tags:o,artist:i,userId:s,title:l}=t,c={pid:Number(n),user:i,userId:Number(s),title:l,comment:a,tags:o};M.add(c)},onDownloadAbort(t){T.abort(t)}}))}static get hostname(){return"www.pixiv.net"}inject(){super.inject(),new MutationObserver((t=>{this.injectThumbnailButtons(t),this.pageActions()})).observe(document.body,{childList:!0,subtree:!0})}getCustomConfig(){return{folderPattern:"pixiv/{artist}",filenamePattern:"{artist}_{title}_{id}_p{page}"}}getFilenameTemplate(){return["{artist}","{artistID}","{title}","{id}","{page}","{tags}","{date}"]}observeColorScheme(){const t=()=>{"dark"===document.documentElement.getAttribute("data-theme")?this.setAppDarkMode():this.setAppLightMode()};new MutationObserver(t).observe(document.documentElement,{attributes:!0,childList:!1,subtree:!1}),t()}injectThumbnailButtons(t){const e=[];var r;if(t.forEach((t=>{t.addedNodes.length&&t.addedNodes.forEach((t=>{t.nodeType===Node.ELEMENT_NODE&&t.tagName.toLowerCase()!==R.tagNameLowerCase&&"IMG"!==t.tagName&&e.push(t)}))})),e.length)if(this.firstObserverCbRunFlag)ud(document.querySelectorAll("a")),this.firstObserverCbRunFlag=!1;else{r=e,ss.searchPage.test(location.pathname)&&r.forEach((t=>{var e;null==(e=t.querySelector(R.tagNameLowerCase))||e.remove()}));ud(e.reduce(((t,e)=>t.concat(e instanceof HTMLAnchorElement?[e]:Array.from(e.querySelectorAll("a")))),[]))}}pageActions(){var t,e;const r=location.pathname;let a;switch(!0){case!!(a=ss.artworksPage.exec(r)):{const t=a[1];!function(t){const e=document.querySelector("main section section");if(!e||e.querySelector(R.tagNameLowerCase))return;const r=new R({id:t,type:j.PixivToolbar,onClick:dd}),a=e.lastElementChild.cloneNode();a.appendChild(r),e.appendChild(a)}(t),pd(t),gd(t),md(t),wd(t);break}case ss.userPageTags.test(r):{const{downloading:t,batchDownload:e}=this.useBatchDownload(),r=t=>{const{userId:r,category:a,tag:n,rest:o}=t;return e("tagged_artwork",r,a,n,o)};!function(t,e){const r=Array.from(document.querySelectorAll("a[status]"));r.length&&r.forEach((r=>{var a;if((null==(a=r.nextElementSibling)?void 0:a.tagName.toLowerCase())===yd.tagNameLowerCase)return;const n=new yd(r,t,e);r.parentElement.appendChild(n)}))}(t,r),function(t,e){var r;const a=document.querySelector('div[style*="position: relative"]');if(!a)return;const n=null==a?void 0:a.closest('div[role="presentation"], div[class="charcoal-token"]'),o=null==(r=null==n?void 0:n.querySelector("svg"))?void 0:r.parentElement;a.querySelectorAll('div[style*="position: absolute"] a').forEach((r=>{if(r.querySelector(vd.tagNameLowerCase))return;const a=new vd(r.href,t,(t=>(null==o||o.click(),e(t))));r.appendChild(a)}))}(t,r);break}case ss.historyPage.test(r):ud(document.querySelectorAll("span[style]._history-item"));break;case!!(a=ss.unlisted.exec(r)):{const r=a[0],n=null==(t=document.querySelector('link[rel="canonical"]'))?void 0:t.getAttribute("href");if(!n)return;const o=null==(e=ss.artworksPage.exec(n))?void 0:e[1];if(!o)return;!function(t,e){if(document.querySelector(bd.tagNameLowerCase))return;const r=document.querySelector('div[style^="transform: translateY"]');if(!r)return;const a=new bd({id:t,onClick:dd,extraData:{unlistedId:e}});r.appendChild(a);const n=r.querySelector('button[type="button"]:not([style])');n&&(n.style.bottom="48px")}(o,r),pd(o,r),gd(o,r),md(o,r),wd(o,r);break}}}}const kd=new class extends D{isBadResponse(t){return"success"in t&&!t.success}async getJSON(t,e){const r=await super.getJSON(t,e);if(this.isBadResponse(r))throw new y(r.reason);return r}async getPosts(t){let e="/post.json?";return Object.entries(t).forEach((([t,r])=>{"number"==typeof r?r=String(r):Array.isArray(r)&&(r=r.join("+")),e+=`&${t}=${r}`})),this.getJSON(e)}async getPool(t,e=1){return this.getJSON(`/pool/show.json?id=${t}&page=${e}`)}},$d={async parse(t){const{posts:e,tags:r}=await this.parseArtwork(t);return this._buildMeta(e[0],r)},_parsePostListData:t=>t.match(new RegExp("(?<=Post\\.register\\().+(?=\\))","g")).map((t=>JSON.parse(t))),_parseTagListData(t){const[e]=t.match(new RegExp("(?<=Post\\.register_tags\\().+(?=\\))"));return JSON.parse(e)},async parsePostList(t,e){Array.isArray(t)&&t.join("+");const r=await kd.getHtml(`/post?page=${e}&tags=${t}`);return{posts:this._parsePostListData(r),tags:this._parseTagListData(r)}},async parsePopular(t){const e=await kd.getHtml(`/post/popular_recent?period=${t}`);return{posts:this._parsePostListData(e),tags:this._parseTagListData(e)}},async parseArtwork(t){const e=await kd.getHtml(`/post/show/${t}`),[r]=new RegExp("(?<=Post\\.register_resp\\().+(?=\\);)").exec(e);return JSON.parse(r)},async parsePool(t){const e=await kd.getHtml(`/pool/show/${t}`),[r]=new RegExp("(?<=Post\\.register_resp\\().+(?=\\);)").exec(e);return JSON.parse(r)},async parseBlacklist(){const t=(await kd.getDoc("/static/more")).querySelector("script#user-blacklisted-tags");if(!t)throw new Error("Can not get blacklist.");return JSON.parse(t.textContent??"[]").map((t=>{const e=t.replace(/(rating:[qes])\w+/,"$1").split(" "),r=[],a=[];return e.forEach((t=>{"-"===t.charAt(0)?a.push(t.slice(1)):r.push(t)})),{tags:e,original_tag_string:t,require:r,exclude:a}}))},isBlacklisted:(t,e)=>e.some((e=>{const{require:r,exclude:a}=e,n=e=>t.includes(e);return r.every(n)&&!a.some(n)})),_buildMeta(t,e){const{id:r,file_url:a,file_ext:n,md5:o,created_at:i,source:s,rating:l}=t,c=[],d=[],u=t.tags.split(" ").map((t=>{const r=e[t]??"unknown";return"artist"===r?c.push(t):"character"===r&&d.push(t),r+":"+t}));return{id:String(r),src:a,extendName:n,artist:c.join(",")||"UnknownArtist",character:d.join(",")||"UnknownCharacter",title:o,tags:u,createDate:new Date(1e3*i).toISOString(),rating:l,source:s}},_isValidCallbackFactory:t=>async e=>{const r=e.tags.split(" ");return r.push("rating:"+e.rating.charAt(0)),r.push("status:"+e.status),await t({id:String(e.id),tags:r})},async*_paginationGenerator(t,e,r,a,n){const[o=1,i=0]=t??[];let s=o,l=await r(s),c=l.length,d=null;if(0===c)throw new Error(`There is no post in page ${s}.`);do{let t=null;if(s!==i&&l.length>=e)try{t=await r(s+1),t.length?c+=t.length:t=null}catch(e){d=e,t=null}const o=[],u=[],p=[];for(let t=0;t<l.length;t++){const e=l[t],r=await a(e),i=n(e);r?o.push(i):u.push(i)}yield{total:c,page:s,avaliable:o,invalid:u,unavaliable:p},s++,l=t}while(l);if(d)throw d},async*postGenerator(t,e,r){yield*this._paginationGenerator(t,40,(async t=>{const{posts:e,tags:a}=await this.parsePostList(r,t);return e.map((t=>({...t,tagType:a})))}),this._isValidCallbackFactory(e),(t=>this._buildMeta(t,t.tagType)))},async*popularGenerator(t,e,r){yield*this._paginationGenerator([1,1],1/0,(async()=>{const{posts:t,tags:e}=await this.parsePopular(r);return t.map((t=>({...t,tagType:e})))}),this._isValidCallbackFactory(e),(t=>this._buildMeta(t,t.tagType)))},async*poolGenerator(t,e,r){yield*this._paginationGenerator([1,1],1/0,(async()=>{const{posts:t,tags:e}=await this.parsePool(r);return t.map((t=>({...t,tagType:e})))}),this._isValidCallbackFactory(e),(t=>this._buildMeta(t,t.tagType)))}};function Cd(t){if(t)return function(e){t.setProgress(e)}}class Ad extends H{constructor(t){super(t),this.meta=t}getDownloadConfig(t){return{taskId:this.generateTaskId(),src:this.meta.src,path:this.buildFilePath(),source:this.meta,timeout:6e4,onProgress:Cd(t)}}buildFilePath(){return super.buildFilePath().replaceAll("{character}",this.normalizeString(this.meta.character))}}async function Ed(t){T.dirHandleCheck();const e=t.dataset.id,r=await $d.parse(e),{tags:a,artist:n,title:o,rating:i,source:s}=r,l=new Ad(r).getDownloadConfig(t);await T.download(l),M.add({pid:Number(e),user:n,title:o,tags:a,rating:i,source:s})}class _d extends Vi{constructor(){super(...arguments),o(this,"blacklist",null),o(this,"useBatchDownload",this.app.initBatchDownloader({metaType:{},avatar:"/favicon.ico",filterOption:{filters:[{id:"exclude_downloaded",type:"exclude",name:J("downloader.category.filter.exclude_downloaded"),checked:!1,fn:t=>!!t.id&&M.has(t.id)},{id:"exclude_blacklist",type:"exclude",name:J("downloader.category.filter.exclude_blacklist"),checked:!0,fn:async t=>!!t.tags&&(this.blacklist??(this.blacklist=await $d.parseBlacklist()),$d.isBlacklisted(t.tags,this.blacklist))},{id:"allow_image",type:"include",name:J("downloader.category.filter.image"),checked:!0,fn:()=>!0}],enableTagFilter:!0},pageOption:{posts:{name:J("downloader.download_type.yande_posts"),match:()=>"/post"===location.pathname,filterInGenerator:!0,fn:(t,e,r)=>(r??(r=new URLSearchParams(location.search).get("tags")??""),$d.postGenerator(t,e,r))},popular_1d:{name:J("downloader.download_type.yande_popular_1d"),match:()=>"/post/popular_recent"===location.pathname,filterInGenerator:!0,fn:(t,e)=>$d.popularGenerator(t,e,"1d")},popular_1w:{name:J("downloader.download_type.yande_popular_1w"),match:()=>"/post/popular_recent"===location.pathname,filterInGenerator:!0,fn:(t,e)=>$d.popularGenerator(t,e,"1w")},popular_1m:{name:J("downloader.download_type.yande_popular_1m"),match:()=>"/post/popular_recent"===location.pathname,filterInGenerator:!0,fn:(t,e)=>$d.popularGenerator(t,e,"1m")},popular_1y:{name:J("downloader.download_type.yande_popular_1y"),match:()=>"/post/popular_recent"===location.pathname,filterInGenerator:!0,fn:(t,e)=>$d.popularGenerator(t,e,"1y")},pool:{name:J("downloader.download_type.yande_pool"),match:/\/pool\/show\//,filterInGenerator:!0,fn:(t,e,r)=>(r??(r=new RegExp("(?<=show\\/)[0-9]+").exec(location.pathname)[0]),$d.poolGenerator(t,e,r))}},parseMetaByArtworkId:t=>$d.parse(t),async downloadByArtworkId(t,e){T.dirHandleCheck();const{id:r,tags:a,artist:n,title:o,rating:i,source:s}=t,l=new Ad(t).getDownloadConfig();l.taskId=e,await T.download(l),M.add({pid:Number(r),user:n,title:o,tags:a,rating:i,source:s})},onDownloadAbort(t){T.abort(t)},afterDownload:()=>{this.blacklist&&(this.blacklist=null)}}))}inject(){this.resetArrayFrom(),super.inject();const t=location.pathname,e=t.match(new RegExp("(?<=\\/post\\/show\\/)\\d+"));if(e)this.createArtworkBtn(e[0]);else if("/post/browse"===t)this.createScrollerBtn(),this.createImageBrowseBtn();else{const t=document.querySelectorAll("a.thumb, div.post div.col1 a");this.createThumbnailBtn(Array.from(t))}}resetArrayFrom(){const t=document.createElement("iframe");document.body.append(t),Array.from=t.contentWindow.Array.from,t.remove()}createThumbnailBtn(t){t.length&&t.forEach((t=>{const e=new RegExp("(?<=\\/post\\/show\\/)\\d+|(?<=\\/post\\/browse#)\\d+").exec(t.href);if(!e)return;const r=e[0],a=t.querySelector(R.tagNameLowerCase);if(a){if(a.dataset.id===r)return;a.remove()}else{if(t.href.includes("/post/show")&&(t.style.height="fit-content",!t.classList.contains("thumb"))){const e=t.querySelector("img");if(e.src.includes("blacklisted-preview.png"))return;e.onload=()=>{e.src.includes("blacklisted-preview.png")&&e.nextElementSibling&&e.nextElementSibling.remove()},t.style.marginBottom="1em",e.style.marginBottom="0px"}t.parentElement.style.display="flex",t.style.position="relative"}t.appendChild(new R({id:r,onClick:Ed}))}))}createArtworkBtn(t){const e=document.querySelector("#image").closest("div");e.style.position="relative",e.style.width="max-content",e.appendChild(new Qi({id:t,site:"yande",onClick:Ed}))}createScrollerBtn(){const t=document.querySelector("ul.post-browser-posts");if(!t)return;new MutationObserver((t=>{const e=[];t.forEach((t=>{t.addedNodes.length&&t.addedNodes.forEach((t=>{if(!(t instanceof HTMLElement))return;const r=t.querySelectorAll("a.thumb");r.length&&e.push(...r)}))})),this.createThumbnailBtn(e)})).observe(t,{subtree:!0,childList:!0})}createImageBrowseBtn(){const t=document.querySelector("span.post-id");function e(){var e;null==(e=document.querySelector(`${R.tagNameLowerCase}[data-type="${j.YandeBrowse}"]`))||e.remove();const r=t.textContent;r&&document.body.appendChild(new R({id:r,type:j.YandeBrowse,onClick:Ed}))}t&&(e(),new MutationObserver(e).observe(t,{childList:!0}))}getCustomConfig(){return{folderPattern:"yande/{artist}",filenamePattern:"{id}_{artist}_{character}"}}getFilenameTemplate(){return["{artist}","{character}","{id}","{date}"]}static get hostname(){return"yande.re"}}class Sd extends as{constructor(){super(),o(this,"commentaryAccessible"),this.useBatchDownload=this.useBatchDownload().overwrite({avatar:"/favicon.svg",parseMetaByArtworkId:async t=>await Zi.parse(t,{type:await(this.commentaryAccessible??(this.commentaryAccessible=this.isCommentaryAccessible()))?"api":"html"})})}static get hostname(){return"booru.allthefallen.moe"}getCustomConfig(){return{folderPattern:"ATFbooru/{artist}",filenamePattern:"{id}_{artist}_{character}"}}async isCommentaryAccessible(){try{await Xi.getArtistCommentary("703816")}catch(t){if(!(t instanceof b))return!1}return!0}async downloadArtwork(t){T.dirHandleCheck();const e=t.dataset.id,r=await Zi.parse(e,{type:await(this.commentaryAccessible??(this.commentaryAccessible=this.isCommentaryAccessible()))?"api":"html"}),a=new ts(r).getDownloadConfig(t);this.config.get("addBookmark")&&rs(e),await T.download(a);const{tags:n,artist:o,title:i,comment:s,source:l,rating:c}=r;M.add({pid:Number(e),user:o,title:i,comment:s,tags:n,source:l,rating:c})}}const Pd=function(){const t=[xd,as,Ji,_d,Sd];for(let e=0;e<t.length;e++)if(location.hostname===t[e].hostname)return t[e]}();Pd&&(new Pd).inject()}(Dexie,dayjs,JSZip,GIF);